<?xml version="1.0" encoding="UTF-8"?>
<BES xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="BES.xsd">
	<Baseline>
		<Title>Updates for Windows Applications- Critical (For Testing)</Title>
		<Description>Need to deploy these patches on Test Machines.</Description>
		<Relevance>true</Relevance>
		<Category></Category>
		<Source>Critical Patches- Updates</Source>
		<SourceID></SourceID>
		<SourceSeverity>High</SourceSeverity>
		<CVENames></CVENames>
		<SANSID></SANSID>
		<MIMEField>
			<Name>x-fixlet-modification-time</Name>
			<Value>Tue, 10 Jan 2017 07:42:05 +0000</Value>
		</MIMEField>
		<Domain>PTCH</Domain>
		<BaselineComponentCollection>
			<BaselineComponentGroup>
				<BaselineComponent Name="Flash Player 24.0.0.186 Available - Plugin-based" IncludeInRelevance="true" SourceSiteURL="http://sync.bigfix.com/cgi-bin/bfgather/updateswindowsapps" SourceID="1091312" ActionName="Action1">
					<ActionScript MIMEType="application/x-Fixlet-Windows-Shell">prefetch install_flash_player_24_plugin.exe sha1:f1264ca55b998cb726968c117eedb889abcce4ab size:20364888 http://fpdownload.macromedia.com/get/flashplayer/current/licensing/win/install_flash_player_24_plugin.exe sha256:2e0493f6c3c569e57de44ac103d16c67eefbe0a037d6ffbaa5d222a09a74cb38

wait __Download\install_flash_player_24_plugin.exe /install

action may require restart "f1264ca55b998cb726968c117eedb889abcce4ab"</ActionScript>
					<SuccessCriteria Option="OriginalRelevance"></SuccessCriteria>
					<Relevance><![CDATA[((((((if( name of operating system starts with "Win" ) then platform id of operating system != 3 else false) AND (if exists property "in proxy agent context" then ( not in proxy agent context ) else true )) AND (name of operating system as lowercase starts with "win")) AND ((exists folder "macromed\flash" of system folder AND (exists file whose ((it starts with "flash" and it ends with ".ocx") of (name of it as lowercase)) of folder "macromed\flash" of system folder OR exists file whose ((it starts with "swflash" and it ends with ".ocx") of (name of it as lowercase)) of folder "macromed\flash" of system folder OR exists file whose ((it starts with "npswf32" and it ends with ".dll") of (name of it as lowercase)) of folder "macromed\flash" of system folder))  OR (exists key "HKLM\Software\Mozilla" whose (exists key whose (name of it does not contain "Netscape" AND exists key "Extensions" whose (exists file whose ((it starts with "npswf32" and it ends with ".dll") of (name of it as lowercase)) of folder (value "Plugins" of it as string)) of it) of it) of registry))) AND (not exists values "PROCESSOR_ARCHITECTURE" whose (it as string as lowercase = "ia64") of keys "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment" of registry)) AND ((exists folder "Macromed\Flash" whose (exists file whose (version of it < "24.0.0.186" AND name of it as string contains "NPSWF32" AND name of it as string contains ".dll") of it) of system folder) OR (exists key "HKLM\Software\Mozilla" whose (exists key whose (name of it does not contain "Netscape" AND exists key "Extensions" whose (exists file "NPSWF32.dll" whose (version of it < "24.0.0.186") of folder (value "Plugins" of it as string)) of it) of it) of registry))) AND ((it != "WinNT" AND it != "Win95" AND it != "Win2000") of name of operating system)]]></Relevance>
				</BaselineComponent>
				<BaselineComponent Name="Flash Player 24.0.0.186 Available - Internet Explorer" IncludeInRelevance="true" SourceSiteURL="http://sync.bigfix.com/cgi-bin/bfgather/updateswindowsapps" SourceID="1091333" ActionName="Action1">
					<ActionScript MIMEType="application/x-Fixlet-Windows-Shell">prefetch install_flash_player_24_active_x.exe sha1:a413899322d8fab02f06092e7df0acd9d5fbde24 size:19828824 http://fpdownload.macromedia.com/get/flashplayer/current/licensing/win/install_flash_player_24_active_x.exe  sha256:0374b90c98244527b275df1f4f8b88b9c74e4d0465cfc04b27263c2cbf469bf8

wait __Download\install_flash_player_24_active_x.exe /install

action may require restart "a413899322d8fab02f06092e7df0acd9d5fbde24"</ActionScript>
					<SuccessCriteria Option="OriginalRelevance"></SuccessCriteria>
					<Relevance><![CDATA[(((((((if( name of operating system starts with "Win" ) then platform id of operating system != 3 else false) AND (if exists property "in proxy agent context" then ( not in proxy agent context ) else true )) AND (name of operating system as lowercase starts with "win")) AND ((exists folder "macromed\flash" of system folder AND (exists file whose ((it starts with "flash" and it ends with ".ocx") of (name of it as lowercase)) of folder "macromed\flash" of system folder OR exists file whose ((it starts with "swflash" and it ends with ".ocx") of (name of it as lowercase)) of folder "macromed\flash" of system folder OR exists file whose ((it starts with "npswf32" and it ends with ".dll") of (name of it as lowercase)) of folder "macromed\flash" of system folder))  OR (exists key "HKLM\Software\Mozilla" whose (exists key whose (name of it does not contain "Netscape" AND exists key "Extensions" whose (exists file whose ((it starts with "npswf32" and it ends with ".dll") of (name of it as lowercase)) of folder (value "Plugins" of it as string)) of it) of it) of registry))) AND (not exists values "PROCESSOR_ARCHITECTURE" whose (it as string as lowercase = "ia64") of keys "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment" of registry)) AND ((exists folder "macromed\flash" of system folder) AND ((exists file whose (((it starts with "flash" and it ends with ".ocx") OR (it = "swflash.ocx")) of (name of it as lowercase) and version of it < "24.0.0.186") of it and not exists file whose ((it starts with "flash" and it ends with ".ocx") of (name of it as lowercase) and version of it >= "24.0.0.186") of it) of folder "macromed\flash" of system folder))) AND ((it != "WinNT" AND it != "Win95" AND it != "Win2000" AND it!= "Win8" AND it != "Win2012" AND it != "Win8.1" AND it != "Win2012R2" AND it != "Win10") of name of operating system)) AND (exists file "msiexec.exe" whose (version of it >= "2.0") of system folder)]]></Relevance>
				</BaselineComponent>
				<BaselineComponent Name="Apple iTunes 12.5.4 Available - Win7/Win8/Win8.1/Win10" IncludeInRelevance="true" SourceSiteURL="http://sync.bigfix.com/cgi-bin/bfgather/updateswindowsapps" SourceID="2061111" ActionName="Action1">
					<ActionScript MIMEType="application/x-Fixlet-Windows-Shell">// check for x64

if {x64 of operating system}

prefetch iTunes64Setup.exe sha1:e24e12bf876d1cb683081ef4bd2427d1d2d377cd size:177044296 https://secure-appldnld.apple.com/itunes12/031-86055-20161212-CC2643BA-BE1D-11E6-BD92-B2E982FDB0CC/iTunes6464Setup.exe sha256:1875473f2df42c5561cd3d5c12cf7150cb0c0bf7d4aff5348c38fee4484f216f

wait __Download\iTunes64Setup.exe /extract

wait msiexec /i AppleApplicationSupport64.msi /qn {(if exists file "msiexec.exe" whose (version of it = "2") of system folder then "/q REBOOT=ReallySuppress" else "/norestart" )} DESKTOP_SHORTCUTS=0 ALLUSERS=1

wait msiexec /i AppleMobileDeviceSupport6464.msi /qn {(if exists file "msiexec.exe" whose (version of it = "2") of system folder then "/q REBOOT=ReallySuppress" else "/norestart" )} DESKTOP_SHORTCUTS=0 ALLUSERS=1

wait msiexec /i iTunes6464.msi /qn {(if exists file "msiexec.exe" whose (version of it = "2") of system folder then "/q REBOOT=ReallySuppress" else "/norestart")} REGSRCH_DESKTOP_SHORTCUTS=0 ALLUSERS=1 DESKTOP_SHORTCUTS=0 REENABLEAUTORUN=0

action may require restart "e24e12bf876d1cb683081ef4bd2427d1d2d377cd"

// otherwise it should be x86

else

prefetch iTunesSetup.exe sha1:3a70cb1f8215efab5ae3723ab5ddde21f8394108 size:123526472 https://secure-appldnld.apple.com/itunes12/031-86054-20161212-CC264356-BE1D-11E6-BD92-B3E982FDB0CC/iTunesSetup.exe sha256:328d536c96200954375f2e8a3cfed3f40576f4c1c8482427cfb6ee444ed3501a

wait __Download\iTunesSetup.exe /extract

wait msiexec /i AppleApplicationSupport.msi /qn {(if exists file "msiexec.exe" whose (version of it = "2") of system folder then "/q REBOOT=ReallySuppress" else "/norestart" )} DESKTOP_SHORTCUTS=0 ALLUSERS=1

wait msiexec /i AppleMobileDeviceSupport.msi /qn {(if exists file "msiexec.exe" whose (version of it = "2") of system folder then "/q REBOOT=ReallySuppress" else "/norestart" )} DESKTOP_SHORTCUTS=0 ALLUSERS=1

wait msiexec /i iTunes.msi /qn {(if exists file "msiexec.exe" whose (version of it = "2") of system folder then "/q REBOOT=ReallySuppress" else "/norestart")} REGSRCH_DESKTOP_SHORTCUTS=0 ALLUSERS=1 DESKTOP_SHORTCUTS=0 REENABLEAUTORUN=0

action may require restart "3a70cb1f8215efab5ae3723ab5ddde21f8394108"

endif</ActionScript>
					<SuccessCriteria Option="OriginalRelevance"></SuccessCriteria>
					<Relevance><![CDATA[((((((if( name of operating system starts with "Win" ) then platform id of operating system != 3 else false) AND (if exists property "in proxy agent context" then ( not in proxy agent context ) else true )) AND (name of operating system as lowercase starts with "win")) AND (not exists values "PROCESSOR_ARCHITECTURE" whose (it as string as lowercase = "ia64") of keys "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment" of registry)) AND ((name of it = "Win7" OR name of it = "Win8" OR name of it ="Win8.1" OR name of it ="Win10") of operating system OR (it starts with "Win" AND it does not start with "Win20") of name of operating system AND (exists value "CurrentMajorVersionNumber" of it AND value "CurrentMajorVersionNumber" of it as integer = 10) of key "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion" of native registry)) AND (exists regapp "iTunes.exe" whose (version of it < "12.5.4"))) AND (exists file "msiexec.exe" whose (version of it >= "2") of system folder)]]></Relevance>
				</BaselineComponent>
				<BaselineComponent Name="Apple QuickTime 7.7.9 Stand-Alone Player Available" IncludeInRelevance="true" SourceSiteURL="http://sync.bigfix.com/cgi-bin/bfgather/updateswindowsapps" SourceID="2072030" ActionName="Action1">
					<ActionScript MIMEType="application/x-Fixlet-Windows-Shell"><![CDATA[prefetch QuickTimeInstaller.exe sha1:e906b9b585a02c08270316fd21f8f5ce0081526a size:41896256 https://secure-appldnld.apple.com/quicktime/031-43075-20160107-c0844134-b3cd-11e5-b1c0-43ca8d551951/quicktimeinstaller.exe sha256:56eff77b029b5f56c47d11fe58878627065dbeacbc3108d50d98a83420152c2b

// Extract MSI's from executable
wait __Download\QuickTimeInstaller.exe /extract

// Install

wait msiexec /i AppleApplicationSupport.msi /qn {(if exists file "msiexec.exe" whose (version of it = "2") of system folder then "/q REBOOT=ReallySuppress" else "/norestart" )} DESKTOP_SHORTCUTS=0 ALLUSERS=1

wait msiexec /i QuickTime.msi /qn {(if exists file "msiexec.exe" whose (version of it = "2") of system folder then "/q REBOOT=ReallySuppress" else "/norestart" )} ISSETUPDRIVEN=0 ALLUSERS=1 DESKTOP_SHORTCUTS=0 QTTaskRunFlags=0 QTINFO.BISQTPRO=1 SCHEDULE_ASUW=0 REBOOT_REQUIRED=No

// Set starting time
parameter "startTime" = "{apparent registration server time}"

// Pause until setup terminates or 10 minutes has passed.
pause while {(exists running application "QuickTimeInstaller.exe") AND (apparent registration server time - time (parameter "startTime")) < 10*minute}

action may require restart "e906b9b585a02c08270316fd21f8f5ce0081526a"]]></ActionScript>
					<SuccessCriteria Option="OriginalRelevance"></SuccessCriteria>
					<Relevance><![CDATA[((((((if( name of operating system starts with "Win" ) then platform id of operating system != 3 else false) AND (if exists property "in proxy agent context" then ( not in proxy agent context ) else true )) AND (name of operating system as lowercase starts with "win")) AND (not exists values "PROCESSOR_ARCHITECTURE" whose (it as string as lowercase = "ia64") of keys "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment" of registry)) AND ((name of it = "WinXP" OR name of it = "Win2003" OR name of it = "WinXP-2003" OR name of it = "WinVista" OR name of it = "Win2008" OR name of it = "Win2008r2" OR name of it = "Win7") of operating system)) AND (exists regapp "QuickTimePlayer.exe" whose (version of it < "7.79.80.95"))) AND (not exists running application "QuickTimeUpdater.exe")]]></Relevance>
				</BaselineComponent>
				<BaselineComponent Name="Mozilla Firefox 50.1.0 Available" IncludeInRelevance="true" SourceSiteURL="http://sync.bigfix.com/cgi-bin/bfgather/updateswindowsapps" SourceID="6081350" ActionName="Action1">
					<ActionScript MIMEType="application/x-Fixlet-Windows-Shell"><![CDATA[if {exists key whose (name of it as string contains "en-US") of (keys "HKEY_LOCAL_MACHINE\Software\Mozilla\Mozilla Firefox ESR" of it; keys "HKEY_LOCAL_MACHINE\Software\Mozilla\Mozilla Firefox" of it) of registry}

prefetch Firefox_Setup_50.1.0.exe sha1:014ef924a71d2dadc5f27a06627779be0529dff8 size:44594784 http://download-installer.cdn.mozilla.net/pub/firefox/releases/50.1.0/win32/en-US/Firefox%20Setup%2050.1.0.exe sha256:aac430f772ea65bd1fae37cf6bfd306923cd54d820e5b0f44ebca51be2842070

regset "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\FilesToDelete]" "MozillaFirefoxDesktopIcon"="{if (exists file ((value "Common Desktop" of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders" of registry as string)&"\Mozilla Firefox.lnk")) then "" else escape of (value "Common Desktop" of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders" of registry as string & "\Mozilla Firefox.lnk")}"

wait __Download\Firefox_Setup_50.1.0.exe -ms -ira -hideBanner -cleanUpOnUpgrade 

delete {value "MozillaFirefoxDesktopIcon" of key "HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\FilesToDelete" of registry as string} 

regdelete "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\FilesToDelete]" "MozillaFirefoxDesktopIcon"

action may require restart "014ef924a71d2dadc5f27a06627779be0529dff8"

elseif {exists key whose (name of it as string contains "fr") of (keys "HKEY_LOCAL_MACHINE\Software\Mozilla\Mozilla Firefox ESR" of it; keys "HKEY_LOCAL_MACHINE\Software\Mozilla\Mozilla Firefox" of it) of registry}

prefetch Firefox_Setup_50.1.0.exe sha1:4f324e71799f50ffc225c75d1af141a3616c2adc size:44765640 http://download-installer.cdn.mozilla.net/pub/firefox/releases/50.1.0/win32/fr/Firefox%20Setup%2050.1.0.exe sha256:eadee55c8d63f135d8e8674cee63db7c0575a712cf06deee4974996ebf19570c

regset "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\FilesToDelete]" "MozillaFirefoxDesktopIcon"="{if (exists file ((value "Common Desktop" of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders" of registry as string)&"\Mozilla Firefox.lnk")) then "" else escape of (value "Common Desktop" of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders" of registry as string & "\Mozilla Firefox.lnk")}"

wait __Download\Firefox_Setup_50.1.0.exe -ms -ira -hideBanner -cleanUpOnUpgrade 

delete {value "MozillaFirefoxDesktopIcon" of key "HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\FilesToDelete" of registry as string} 

regdelete "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\FilesToDelete]" "MozillaFirefoxDesktopIcon"

action may require restart "4f324e71799f50ffc225c75d1af141a3616c2adc"

elseif {exists key whose (name of it as string contains "de") of (keys "HKEY_LOCAL_MACHINE\Software\Mozilla\Mozilla Firefox ESR" of it; keys "HKEY_LOCAL_MACHINE\Software\Mozilla\Mozilla Firefox" of it) of registry}

prefetch Firefox_Setup_50.1.0.exe sha1:c2b00b06d24ed67624705b18da507728a70b8f36 size:44454488 http://download-installer.cdn.mozilla.net/pub/firefox/releases/50.1.0/win32/de/Firefox%20Setup%2050.1.0.exe sha256:7e30c74117b9b6830c40f1e8e00eb6728cf2b900e88ef3ceb398e7737676dc76

regset "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\FilesToDelete]" "MozillaFirefoxDesktopIcon"="{if (exists file ((value "Common Desktop" of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders" of registry as string)&"\Mozilla Firefox.lnk")) then "" else escape of (value "Common Desktop" of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders" of registry as string & "\Mozilla Firefox.lnk")}"

wait __Download\Firefox_Setup_50.1.0.exe -ms -ira -hideBanner -cleanUpOnUpgrade 

delete {value "MozillaFirefoxDesktopIcon" of key "HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\FilesToDelete" of registry as string} 

regdelete "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\FilesToDelete]" "MozillaFirefoxDesktopIcon"

action may require restart "c2b00b06d24ed67624705b18da507728a70b8f36"

elseif {exists key whose (name of it as string contains "it") of (keys "HKEY_LOCAL_MACHINE\Software\Mozilla\Mozilla Firefox ESR" of it; keys "HKEY_LOCAL_MACHINE\Software\Mozilla\Mozilla Firefox" of it) of registry}

prefetch Firefox_Setup_50.1.0.exe sha1:14540454443b2054396622125b7d22113bdf68f7 size:44349400 http://download-installer.cdn.mozilla.net/pub/firefox/releases/50.1.0/win32/it/Firefox%20Setup%2050.1.0.exe sha256:4f2705514aafac8efcf681d0f9907c23b0e42f370674caeab9e56d27723535a4

regset "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\FilesToDelete]" "MozillaFirefoxDesktopIcon"="{if (exists file ((value "Common Desktop" of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders" of registry as string)&"\Mozilla Firefox.lnk")) then "" else escape of (value "Common Desktop" of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders" of registry as string & "\Mozilla Firefox.lnk")}"

wait __Download\Firefox_Setup_50.1.0.exe -ms -ira -hideBanner -cleanUpOnUpgrade 

delete {value "MozillaFirefoxDesktopIcon" of key "HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\FilesToDelete" of registry as string} 

regdelete "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\FilesToDelete]" "MozillaFirefoxDesktopIcon"

action may require restart "14540454443b2054396622125b7d22113bdf68f7"

elseif {exists key whose (name of it as string contains "es-ES") of (keys "HKEY_LOCAL_MACHINE\Software\Mozilla\Mozilla Firefox ESR" of it; keys "HKEY_LOCAL_MACHINE\Software\Mozilla\Mozilla Firefox" of it) of registry}

prefetch Firefox_Setup_50.1.0.exe sha1:d2828f2e05301acde793724732223e4923b8376a size:44350912 http://download-installer.cdn.mozilla.net/pub/firefox/releases/50.1.0/win32/es-ES/Firefox%20Setup%2050.1.0.exe sha256:c98edf1fc92f09124e82fa75adb58b8ac9459264c87db4f7b32fd12b0727f38e

regset "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\FilesToDelete]" "MozillaFirefoxDesktopIcon"="{if (exists file ((value "Common Desktop" of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders" of registry as string)&"\Mozilla Firefox.lnk")) then "" else escape of (value "Common Desktop" of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders" of registry as string & "\Mozilla Firefox.lnk")}"

wait __Download\Firefox_Setup_50.1.0.exe -ms -ira -hideBanner -cleanUpOnUpgrade 

delete {value "MozillaFirefoxDesktopIcon" of key "HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\FilesToDelete" of registry as string} 

regdelete "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\FilesToDelete]" "MozillaFirefoxDesktopIcon"

action may require restart "d2828f2e05301acde793724732223e4923b8376a"

elseif {exists key whose (name of it as string contains "zh-CN") of (keys "HKEY_LOCAL_MACHINE\Software\Mozilla\Mozilla Firefox ESR" of it; keys "HKEY_LOCAL_MACHINE\Software\Mozilla\Mozilla Firefox" of it) of registry}

prefetch Firefox_Setup_50.1.0.exe sha1:0d5ab1b19bbcee8554db83d5715c560b57350651 size:44468232 http://download-installer.cdn.mozilla.net/pub/firefox/releases/50.1.0/win32/zh-CN/Firefox%20Setup%2050.1.0.exe sha256:4a2797ccc08eb6064013984bca13be0432398f1d0f1cb65cd4521a9eb90abf40

regset "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\FilesToDelete]" "MozillaFirefoxDesktopIcon"="{if (exists file ((value "Common Desktop" of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders" of registry as string)&"\Mozilla Firefox.lnk")) then "" else escape of (value "Common Desktop" of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders" of registry as string & "\Mozilla Firefox.lnk")}"

wait __Download\Firefox_Setup_50.1.0.exe -ms -ira -hideBanner -cleanUpOnUpgrade 

delete {value "MozillaFirefoxDesktopIcon" of key "HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\FilesToDelete" of registry as string} 

regdelete "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\FilesToDelete]" "MozillaFirefoxDesktopIcon"

action may require restart "0d5ab1b19bbcee8554db83d5715c560b57350651"

elseif {exists key whose (name of it as string contains "ja") of (keys "HKEY_LOCAL_MACHINE\Software\Mozilla\Mozilla Firefox ESR" of it; keys "HKEY_LOCAL_MACHINE\Software\Mozilla\Mozilla Firefox" of it) of registry}

prefetch Firefox_Setup_50.1.0.exe sha1:e90214d7210a3d6a7ec8826cb7fefad3eb751efb size:44675672 http://download-installer.cdn.mozilla.net/pub/firefox/releases/50.1.0/win32/ja/Firefox%20Setup%2050.1.0.exe sha256:7cfedc51b59b23d5e2707d02dd06d3d067444bf10eb8c5b9fe4179575d637bd8

regset "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\FilesToDelete]" "MozillaFirefoxDesktopIcon"="{if (exists file ((value "Common Desktop" of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders" of registry as string)&"\Mozilla Firefox.lnk")) then "" else escape of (value "Common Desktop" of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders" of registry as string & "\Mozilla Firefox.lnk")}"

wait __Download\Firefox_Setup_50.1.0.exe -ms -ira -hideBanner -cleanUpOnUpgrade 

delete {value "MozillaFirefoxDesktopIcon" of key "HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\FilesToDelete" of registry as string} 

regdelete "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\FilesToDelete]" "MozillaFirefoxDesktopIcon"

action may require restart "e90214d7210a3d6a7ec8826cb7fefad3eb751efb"


elseif {exists key whose (name of it as string contains "zh-TW") of (keys "HKEY_LOCAL_MACHINE\Software\Mozilla\Mozilla Firefox ESR" of it; keys "HKEY_LOCAL_MACHINE\Software\Mozilla\Mozilla Firefox" of it) of registry}

prefetch Firefox_Setup_50.1.0.exe sha1:3a06778264831dc61c836263adf476cafc2eb414 size:44656280 http://download-installer.cdn.mozilla.net/pub/firefox/releases/50.1.0/win32/zh-TW/Firefox%20Setup%2050.1.0.exe sha256:5881addbdb36427b6585d4a31f10e3f98901c13cddcefc87bfd5e034a2dc73a1

regset "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\FilesToDelete]" "MozillaFirefoxDesktopIcon"="{if (exists file ((value "Common Desktop" of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders" of registry as string)&"\Mozilla Firefox.lnk")) then "" else escape of (value "Common Desktop" of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders" of registry as string & "\Mozilla Firefox.lnk")}"

wait __Download\Firefox_Setup_50.1.0.exe -ms -ira -hideBanner -cleanUpOnUpgrade 

delete {value "MozillaFirefoxDesktopIcon" of key "HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\FilesToDelete" of registry as string} 

regdelete "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\FilesToDelete]" "MozillaFirefoxDesktopIcon"

action may require restart "3a06778264831dc61c836263adf476cafc2eb414"


elseif {exists key whose (name of it as string contains "ko") of (keys "HKEY_LOCAL_MACHINE\Software\Mozilla\Mozilla Firefox ESR" of it; keys "HKEY_LOCAL_MACHINE\Software\Mozilla\Mozilla Firefox" of it) of registry}

prefetch Firefox_Setup_50.1.0.exe sha1:38bd1faba7f8253804983138d4b3917cce711aa3 size:44471880 http://download-installer.cdn.mozilla.net/pub/firefox/releases/50.1.0/win32/ko/Firefox%20Setup%2050.1.0.exe sha256:08d75a25346401c194ebdbdd46a1afdd8675f719c5a9cc12ca86089d9266196f

regset "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\FilesToDelete]" "MozillaFirefoxDesktopIcon"="{if (exists file ((value "Common Desktop" of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders" of registry as string)&"\Mozilla Firefox.lnk")) then "" else escape of (value "Common Desktop" of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders" of registry as string & "\Mozilla Firefox.lnk")}"

wait __Download\Firefox_Setup_50.1.0.exe -ms -ira -hideBanner -cleanUpOnUpgrade 

delete {value "MozillaFirefoxDesktopIcon" of key "HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\FilesToDelete" of registry as string} 

regdelete "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\FilesToDelete]" "MozillaFirefoxDesktopIcon"

action may require restart "38bd1faba7f8253804983138d4b3917cce711aa3"

elseif {exists key whose (name of it as string contains "pt-BR") of (keys "HKEY_LOCAL_MACHINE\Software\Mozilla\Mozilla Firefox ESR" of it; keys "HKEY_LOCAL_MACHINE\Software\Mozilla\Mozilla Firefox" of it) of registry}

prefetch Firefox_Setup_50.1.0.exe sha1:b4e6a82bead75aee2be33e7efa8f8075a990c1bd size:44599584 http://download-installer.cdn.mozilla.net/pub/firefox/releases/50.1.0/win32/pt-BR/Firefox%20Setup%2050.1.0.exe sha256:1dce6875419dc0f23d00f16985d7d8238f5235cab6049c765fd79040d007a693

regset "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\FilesToDelete]" "MozillaFirefoxDesktopIcon"="{if (exists file ((value "Common Desktop" of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders" of registry as string)&"\Mozilla Firefox.lnk")) then "" else escape of (value "Common Desktop" of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders" of registry as string & "\Mozilla Firefox.lnk")}"

wait __Download\Firefox_Setup_50.1.0.exe -ms -ira -hideBanner -cleanUpOnUpgrade 

delete {value "MozillaFirefoxDesktopIcon" of key "HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\FilesToDelete" of registry as string} 

regdelete "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\FilesToDelete]" "MozillaFirefoxDesktopIcon"

action may require restart "b4e6a82bead75aee2be33e7efa8f8075a990c1bd"

elseif {exists key whose (name of it as string contains "ru") of (keys "HKEY_LOCAL_MACHINE\Software\Mozilla\Mozilla Firefox ESR" of it; keys "HKEY_LOCAL_MACHINE\Software\Mozilla\Mozilla Firefox" of it) of registry}

prefetch Firefox_Setup_50.1.0.exe sha1:5e4ba7da2a47f027a46e20233c0619f0cac91734 size:44823680 http://download-installer.cdn.mozilla.net/pub/firefox/releases/50.1.0/win32/ru/Firefox%20Setup%2050.1.0.exe sha256:7617acc250e9d9cd0e7ba4e8c67d295ec203ddecba135d210c50173668f872c9

regset "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\FilesToDelete]" "MozillaFirefoxDesktopIcon"="{if (exists file ((value "Common Desktop" of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders" of registry as string)&"\Mozilla Firefox.lnk")) then "" else escape of (value "Common Desktop" of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders" of registry as string & "\Mozilla Firefox.lnk")}"

wait __Download\Firefox_Setup_50.1.0.exe -ms -ira -hideBanner -cleanUpOnUpgrade 

delete {value "MozillaFirefoxDesktopIcon" of key "HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\FilesToDelete" of registry as string} 

regdelete "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\FilesToDelete]" "MozillaFirefoxDesktopIcon"

action may require restart "5e4ba7da2a47f027a46e20233c0619f0cac91734"

elseif {exists key whose (name of it as string contains "pl") of (keys "HKEY_LOCAL_MACHINE\Software\Mozilla\Mozilla Firefox ESR" of it; keys "HKEY_LOCAL_MACHINE\Software\Mozilla\Mozilla Firefox" of it) of registry}

prefetch Firefox_Setup_50.1.0.exe sha1:0a99315b2e71cbc8f1f38da98cf74ee081069968 size:45297456 http://download-installer.cdn.mozilla.net/pub/firefox/releases/50.1.0/win32/pl/Firefox%20Setup%2050.1.0.exe sha256:a7587fe9ac1168f1c0ec6a8ff38903efb1236001ec0ca3b5c66c620e3bc4d44e

regset "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\FilesToDelete]" "MozillaFirefoxDesktopIcon"="{if (exists file ((value "Common Desktop" of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders" of registry as string)&"\Mozilla Firefox.lnk")) then "" else escape of (value "Common Desktop" of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders" of registry as string & "\Mozilla Firefox.lnk")}"

wait __Download\Firefox_Setup_50.1.0.exe -ms -ira -hideBanner -cleanUpOnUpgrade 

delete {value "MozillaFirefoxDesktopIcon" of key "HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\FilesToDelete" of registry as string} 

regdelete "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\FilesToDelete]" "MozillaFirefoxDesktopIcon"

action may require restart "0a99315b2e71cbc8f1f38da98cf74ee081069968"

elseif {exists key whose (name of it as string contains "hu") of (keys "HKEY_LOCAL_MACHINE\Software\Mozilla\Mozilla Firefox ESR" of it; keys "HKEY_LOCAL_MACHINE\Software\Mozilla\Mozilla Firefox" of it) of registry}

prefetch Firefox_Setup_50.1.0.exe sha1:8810cede2c1cb745257f2059e0220abf5fedc5a7 size:45000600 http://download-installer.cdn.mozilla.net/pub/firefox/releases/50.1.0/win32/hu/Firefox%20Setup%2050.1.0.exe sha256:403ec0befaa67964f060f86d43aff3d704747558c2a96c4ab26f46058a2db317

regset "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\FilesToDelete]" "MozillaFirefoxDesktopIcon"="{if (exists file ((value "Common Desktop" of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders" of registry as string)&"\Mozilla Firefox.lnk")) then "" else escape of (value "Common Desktop" of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders" of registry as string & "\Mozilla Firefox.lnk")}"

wait __Download\Firefox_Setup_50.1.0.exe -ms -ira -hideBanner -cleanUpOnUpgrade 

delete {value "MozillaFirefoxDesktopIcon" of key "HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\FilesToDelete" of registry as string} 

regdelete "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\FilesToDelete]" "MozillaFirefoxDesktopIcon"

action may require restart "8810cede2c1cb745257f2059e0220abf5fedc5a7"

elseif {exists key whose (name of it as string contains "cs") of (keys "HKEY_LOCAL_MACHINE\Software\Mozilla\Mozilla Firefox ESR" of it; keys "HKEY_LOCAL_MACHINE\Software\Mozilla\Mozilla Firefox" of it) of registry}

prefetch Firefox_Setup_50.1.0.exe sha1:bdfa2e4d7f962980cd69198f75837ddbe0b1b467 size:44453536 http://download-installer.cdn.mozilla.net/pub/firefox/releases/50.1.0/win32/cs/Firefox%20Setup%2050.1.0.exe sha256:a38e8c0888788607e614daa1a9b71b623656a6bf4f57b7c03cfadd6d7a3a630f

regset "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\FilesToDelete]" "MozillaFirefoxDesktopIcon"="{if (exists file ((value "Common Desktop" of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders" of registry as string)&"\Mozilla Firefox.lnk")) then "" else escape of (value "Common Desktop" of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders" of registry as string & "\Mozilla Firefox.lnk")}"

wait __Download\Firefox_Setup_50.1.0.exe -ms -ira -hideBanner -cleanUpOnUpgrade 

delete {value "MozillaFirefoxDesktopIcon" of key "HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\FilesToDelete" of registry as string} 

regdelete "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\FilesToDelete]" "MozillaFirefoxDesktopIcon"

action may require restart "bdfa2e4d7f962980cd69198f75837ddbe0b1b467"

elseif {exists key whose (name of it as string contains "en-GB") of (keys "HKEY_LOCAL_MACHINE\Software\Mozilla\Mozilla Firefox ESR" of it; keys "HKEY_LOCAL_MACHINE\Software\Mozilla\Mozilla Firefox" of it) of registry}

prefetch Firefox_Setup_50.1.0.exe sha1:3fb6aa720cd3875265a27d57c5d44e129620a037 size:44422976 http://download-installer.cdn.mozilla.net/pub/firefox/releases/50.1.0/win32/en-GB/Firefox%20Setup%2050.1.0.exe sha256:a71c51ec1e32933f996544082b8710ea8c7d5018fa5d00a630fd4dd5b7026fb1

regset "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\FilesToDelete]" "MozillaFirefoxDesktopIcon"="{if (exists file ((value "Common Desktop" of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders" of registry as string)&"\Mozilla Firefox.lnk")) then "" else escape of (value "Common Desktop" of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders" of registry as string & "\Mozilla Firefox.lnk")}"

wait __Download\Firefox_Setup_50.1.0.exe -ms -ira -hideBanner -cleanUpOnUpgrade 

delete {value "MozillaFirefoxDesktopIcon" of key "HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\FilesToDelete" of registry as string} 

regdelete "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\FilesToDelete]" "MozillaFirefoxDesktopIcon"

action may require restart "3fb6aa720cd3875265a27d57c5d44e129620a037"

endif]]></ActionScript>
					<SuccessCriteria Option="OriginalRelevance"></SuccessCriteria>
					<Relevance><![CDATA[(((((((if( name of operating system starts with "Win" ) then platform id of operating system != 3 else false) AND (if exists property "in proxy agent context" then ( not in proxy agent context ) else true )) AND (name of operating system as lowercase starts with "win")) AND (exists key whose (name of it as lowercase starts with "mozilla" AND exists key whose (name of it = "Mozilla Firefox") of it) of key "HKLM\SOFTWARE\" of registry)) AND (not exists values "PROCESSOR_ARCHITECTURE" whose (it as string as lowercase = "ia64") of keys "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment" of registry)) AND (exists name whose (it as string contains "en-US" OR it as string contains "fr" OR it as string contains "de" OR it as string contains "it" OR it as string contains "es-ES" OR it as string contains "zh-CN" OR it as string contains "ja" OR it as string contains "zh-TW" OR it as string contains "ko" OR it as string contains "pt-BR" OR it as string contains "ru" OR it as string contains "pl" OR it as string contains "hu" OR it as string contains "cs" OR it as string contains "en-GB") of keys of keys "HKEY_LOCAL_MACHINE\Software\Mozilla\Mozilla Firefox" of registry)) AND ((exists regapp "firefox.exe" whose (product version of it < "50.1.0")) OR ((exists value "CurrentVersion" whose ((preceding text of first " " of (it as string)) as version < "50.1.0") of (keys "HKEY_LOCAL_MACHINE\Software\Mozilla\Mozilla Firefox ESR" of it; keys "HKEY_LOCAL_MACHINE\Software\Mozilla\Mozilla Firefox" of it) of registry) AND (NOT exists value "CurrentVersion" whose ((preceding text of first " " of (it as string)) as version >= "50.1.0") of (keys "HKEY_LOCAL_MACHINE\Software\Mozilla\Mozilla Firefox ESR" of it; keys "HKEY_LOCAL_MACHINE\Software\Mozilla\Mozilla Firefox" of it) of registry)))) AND (NOT (name of it as uppercase contains "ESR") of key of (keys "HKEY_LOCAL_MACHINE\Software\Mozilla\Mozilla Firefox" of it) of registry)]]></Relevance>
				</BaselineComponent>
				<BaselineComponent Name="Java Runtime Environment 6 update 45 Available (JRE 6 Installed)" IncludeInRelevance="true" SourceSiteURL="http://sync.bigfix.com/cgi-bin/bfgather/updateswindowsapps" SourceID="7051100" ActionName="Action1">
					<ActionScript MIMEType="application/x-Fixlet-Windows-Shell"><![CDATA[begin prefetch block	
	add prefetch item name = jre-6u45-windows-i586.exe sha1=5100b8eafaa7ed73ed6dab5469ba3faff38a9ae9 size=17090992 url={value of setting "_BESClient_AllowCustomRepoDownloads" of client   | "http://download.oracle.com/MANUAL_BES_CACHING_REQUIRED/"}jre-6u45-windows-i586.exe sha256=48c2893738109b833b07ecc7129879dc900c272ebefdad41826ff93d543ca4e9
end prefetch block

continue if {not exists running application whose ((it = "java.exe" OR it = "javaw.exe" OR it = "javaws.exe" OR it = "iexplore.exe" OR it = "firefox.exe") of (name of it as lowercase))}

// Note: update .exe will restart service automatically
if{exists running service "JavaQuickStarterService"}
delete __appendfile
delete stop_javaquickstarter.bat
appendfile net stop JavaQuickStarterService
move __appendfile stop_javaquickstarter.bat
waithidden stop_javaquickstarter.bat
endif

regset "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation]" "InstallingJava32"=dword:00000001

waithidden __Download/jre-6u45-windows-i586.exe /s /norestart

action may require restart "5100b8eafaa7ed73ed6dab5469ba3faff38a9ae9"

continue if {((exists value "DisplayVersion" whose ((it >= "6.0.450") of ((if (it as string = "1.5.0") then (it as string & ".00") else (it as string)) as version)) of keys whose ((value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)")) of it) AND (exists key whose (((it contains "java" OR it contains "j2se") AND (it contains "runtime environment" OR it contains "update")) of (value "DisplayName" of it as string as lowercase)) of it)) of key "HKLM\Software\Microsoft\Windows\CurrentVersion\Uninstall" of registry}

regdelete "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation]" "InstallingJava32"]]></ActionScript>
					<SuccessCriteria Option="OriginalRelevance"></SuccessCriteria>
					<Relevance><![CDATA[((((((((if( name of operating system starts with "Win" ) then platform id of operating system != 3 else false) AND (if exists property "in proxy agent context" then ( not in proxy agent context ) else true )) AND (name of operating system as lowercase starts with "win")) AND (not exists key "HKLM\Software\Wow6432Node\Microsoft\Windows\CurrentVersion" whose (exists value "ProductId" of it OR exists value "CommonFilesDir" of it) of registry AND not exists values "PROCESSOR_ARCHITECTURE" whose (it as string as lowercase = "ia64") of keys "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment" of registry)) AND (exists value "DisplayVersion" whose ((it = "6" and it < "6.0.450") of (it as string as version)) of keys whose (value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase contains "runtimeenvironment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase starts with "java 7") of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of registry)) AND (exists key whose (((it contains "java" OR it contains "j2se") AND (it contains "runtime environment" OR it contains "update" or it contains "runtimeenvironment")) of (value "DisplayName" of it as string as lowercase)) of key "HKLM\Software\Microsoft\Windows\CurrentVersion\Uninstall" of registry)) AND (name of operating system != "WinNT")) AND (exists file "msiexec.exe" whose (version of it >= "3.0") of system folder)) AND (if (exists key "HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation" of registry) then (not exists value "InstallingJava32" whose (it = 1) of key "HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation" of registry) else true)]]></Relevance>
				</BaselineComponent>
				<BaselineComponent Name="Java Runtime Environment 7 update 79 Available (JRE 7 Installed)" IncludeInRelevance="true" SourceSiteURL="http://sync.bigfix.com/cgi-bin/bfgather/updateswindowsapps" SourceID="7051195" ActionName="Action1">
					<ActionScript MIMEType="application/x-Fixlet-Windows-Shell"><![CDATA[begin prefetch block	
add prefetch item name = jre-7u79-windows-i586.exe sha1=b062b03a04e0f3ce222282ca1760e4234d3c6f1f size=29490088 url={value of setting "_BESClient_AllowCustomRepoDownloads" of client | "http://download.oracle.com/MANUAL_BES_CACHING_REQUIRED/"}jre-7u79-windows-i586.exe sha256=ffd7ac432c4ee2b7da52c257392127a744ee304a73d554f3f4fc067cebe589ed
end prefetch block

continue if {not exists running application whose ((it = "java.exe" OR it = "javaw.exe" OR it = "javaws.exe" OR it = "iexplore.exe" OR it = "firefox.exe") of (name of it as lowercase))}

// Note: update .exe will restart service automatically
if{exists running service "JavaQuickStarterService"}
delete __appendfile
delete stop_javaquickstarter.bat
appendfile net stop JavaQuickStarterService
move __appendfile stop_javaquickstarter.bat
waithidden stop_javaquickstarter.bat
endif

regset "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation]" "InstallingJava7_32"=dword:00000001

waithidden __Download/jre-7u79-windows-i586.exe /s

action may require restart "b062b03a04e0f3ce222282ca1760e4234d3c6f1f"

continue if {exists value "DisplayVersion" whose ((it = "7" and it >= "7.0.790") of (it as string as version)) of keys whose (value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase contains "runtimeenvironment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase starts with "java 7") of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of registry}

regdelete "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation]" "InstallingJava7_32"]]></ActionScript>
					<SuccessCriteria Option="OriginalRelevance"></SuccessCriteria>
					<Relevance><![CDATA[((((((((if( name of operating system starts with "Win" ) then platform id of operating system != 3 else false) AND (if exists property "in proxy agent context" then ( not in proxy agent context ) else true )) AND (name of operating system as lowercase starts with "win")) AND (not exists key "HKLM\Software\Wow6432Node\Microsoft\Windows\CurrentVersion" whose (exists value "ProductId" of it OR exists value "CommonFilesDir" of it) of registry AND not exists values "PROCESSOR_ARCHITECTURE" whose (it as string as lowercase = "ia64") of keys "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment" of registry)) AND (exists value "DisplayVersion" whose ((it = "7" and it < "7.0.790") of (it as string as version)) of keys whose (value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase contains "runtimeenvironment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase starts with "java 7") of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of registry)) AND (name of operating system != "WinNT")) AND (exists file "msiexec.exe" whose (version of it >= "3.0") of system folder)) AND (if (exists key "HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation" of registry) then (not exists value "InstallingJava7_32" whose (it = 1) of key "HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation" of registry) else true)) AND (NOT exists value "DisplayVersion" whose ((it = "7" and it >= "7.0.790") of (it as string as version)) of keys whose (value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase contains "runtimeenvironment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase starts with "java 7") of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of registry)]]></Relevance>
				</BaselineComponent>
				<BaselineComponent Name="Java Runtime Environment 7 update 79 Available (JRE &lt; 7 Installed)" IncludeInRelevance="true" SourceSiteURL="http://sync.bigfix.com/cgi-bin/bfgather/updateswindowsapps" SourceID="7051197" ActionName="Action1">
					<ActionScript MIMEType="application/x-Fixlet-Windows-Shell"><![CDATA[begin prefetch block	
add prefetch item name = jre-7u79-windows-i586.exe sha1=b062b03a04e0f3ce222282ca1760e4234d3c6f1f size=29490088 url={value of setting "_BESClient_AllowCustomRepoDownloads" of client | "http://download.oracle.com/MANUAL_BES_CACHING_REQUIRED/"}jre-7u79-windows-i586.exe sha256=ffd7ac432c4ee2b7da52c257392127a744ee304a73d554f3f4fc067cebe589ed
end prefetch block

continue if {not exists running application whose ((it = "java.exe" OR it = "javaw.exe" OR it = "javaws.exe" OR it = "iexplore.exe" OR it = "firefox.exe") of (name of it as lowercase))}

// Note: update .exe will restart service automatically
if{exists running service "JavaQuickStarterService"}
delete __appendfile
delete stop_javaquickstarter.bat
appendfile net stop JavaQuickStarterService
move __appendfile stop_javaquickstarter.bat
waithidden stop_javaquickstarter.bat
endif

regset "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation]" "InstallingJava7_32"=dword:00000001

waithidden __Download/jre-7u79-windows-i586.exe /s

action may require restart "b062b03a04e0f3ce222282ca1760e4234d3c6f1f"

continue if {exists value "DisplayVersion" whose ((it = "7" and it >= "7.0.790") of (it as string as version)) of keys whose (value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase contains "runtimeenvironment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase starts with "java 7") of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of registry}

regdelete "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation]" "InstallingJava7_32"]]></ActionScript>
					<SuccessCriteria Option="OriginalRelevance"></SuccessCriteria>
					<Relevance><![CDATA[((((((((if( name of operating system starts with "Win" ) then platform id of operating system != 3 else false) AND (if exists property "in proxy agent context" then ( not in proxy agent context ) else true )) AND (name of operating system as lowercase starts with "win")) AND (not exists key "HKLM\Software\Wow6432Node\Microsoft\Windows\CurrentVersion" whose (exists value "ProductId" of it OR exists value "CommonFilesDir" of it) of registry AND not exists values "PROCESSOR_ARCHITECTURE" whose (it as string as lowercase = "ia64") of keys "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment" of registry)) AND (NOT exists value "DisplayVersion" whose ((it = "7" and it >= "7.0.790") of (it as string as version)) of keys whose (value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase contains "runtimeenvironment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase starts with "java 7") of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of registry)) AND (name of operating system != "WinNT")) AND (exists file "msiexec.exe" whose (version of it >= "3.0") of system folder)) AND (if (exists key "HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation" of registry) then (not exists value "InstallingJava7_32" whose (it = 1) of key "HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation" of registry) else true)) AND (exists value "DisplayVersion" whose ((it < "7") of (it as string as version)) of keys whose ((value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase contains "runtimeenvironment" OR value "DisplayName" of it as string as lowercase starts with "java " & ((7-1) as string)) AND (not (value "DisplayName" of it as string as lowercase contains "development kit" or value "DisplayName" of it as string as lowercase contains "auto updater" or value "DisplayName" of it as string as lowercase contains "javafx"))) of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of registry)]]></Relevance>
				</BaselineComponent>
				<BaselineComponent Name="Java Runtime Environment 7 update 80 Available (JRE &lt; 7 Installed)" IncludeInRelevance="true" SourceSiteURL="http://sync.bigfix.com/cgi-bin/bfgather/updateswindowsapps" SourceID="7051199" ActionName="Action1">
					<ActionScript MIMEType="application/x-Fixlet-Windows-Shell"><![CDATA[begin prefetch block	
add prefetch item name = jre-7u80-windows-i586.exe sha1=305c1493fca53ab63ba1686c9afdfb65142e59d3 size=29509544 url={value of setting "_BESClient_AllowCustomRepoDownloads" of client | "http://download.oracle.com/MANUAL_BES_CACHING_REQUIRED/"}jre-7u80-windows-i586.exe sha256=a87adf22064e2f7fa6ef64b2513533bf02aa0bf5265670e95b301a79d7ca89d9
end prefetch block

continue if {not exists running application whose ((it = "java.exe" OR it = "javaw.exe" OR it = "javaws.exe" OR it = "iexplore.exe" OR it = "firefox.exe") of (name of it as lowercase))}

// Note: update .exe will restart service automatically
if{exists running service "JavaQuickStarterService"}
delete __appendfile
delete stop_javaquickstarter.bat
appendfile net stop JavaQuickStarterService
move __appendfile stop_javaquickstarter.bat
waithidden stop_javaquickstarter.bat
endif

regset "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation]" "InstallingJava7_32"=dword:00000001

waithidden __Download/jre-7u80-windows-i586.exe /s

action may require restart "305c1493fca53ab63ba1686c9afdfb65142e59d3"

continue if {exists value "DisplayVersion" whose ((it = "7" and it >= "7.0.800") of (it as string as version)) of keys whose (value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase contains "runtimeenvironment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase starts with "java 7") of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of registry}

regdelete "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation]" "InstallingJava7_32"]]></ActionScript>
					<SuccessCriteria Option="OriginalRelevance"></SuccessCriteria>
					<Relevance><![CDATA[((((((((if( name of operating system starts with "Win" ) then platform id of operating system != 3 else false) AND (if exists property "in proxy agent context" then ( not in proxy agent context ) else true )) AND (name of operating system as lowercase starts with "win")) AND (not exists key "HKLM\Software\Wow6432Node\Microsoft\Windows\CurrentVersion" whose (exists value "ProductId" of it OR exists value "CommonFilesDir" of it) of registry AND not exists values "PROCESSOR_ARCHITECTURE" whose (it as string as lowercase = "ia64") of keys "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment" of registry)) AND (NOT exists value "DisplayVersion" whose ((it = "7" and it >= "7.0.800") of (it as string as version)) of keys whose (value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase contains "runtimeenvironment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase starts with "java 7") of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of registry)) AND (name of operating system != "WinNT")) AND (exists file "msiexec.exe" whose (version of it >= "3.0") of system folder)) AND (if (exists key "HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation" of registry) then (not exists value "InstallingJava7_32" whose (it = 1) of key "HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation" of registry) else true)) AND (exists value "DisplayVersion" whose ((it < "7") of (it as string as version)) of keys whose ((value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase contains "runtimeenvironment" OR value "DisplayName" of it as string as lowercase starts with "java " & ((7-1) as string)) AND (not (value "DisplayName" of it as string as lowercase contains "development kit" or value "DisplayName" of it as string as lowercase contains "auto updater" or value "DisplayName" of it as string as lowercase contains "javafx"))) of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of registry)]]></Relevance>
				</BaselineComponent>
				<BaselineComponent Name="Java Runtime Environment 7 update 80 Available (JRE 7 Installed)" IncludeInRelevance="true" SourceSiteURL="http://sync.bigfix.com/cgi-bin/bfgather/updateswindowsapps" SourceID="7051247" ActionName="Action1">
					<ActionScript MIMEType="application/x-Fixlet-Windows-Shell"><![CDATA[begin prefetch block	
add prefetch item name = jre-7u80-windows-i586.exe sha1=305c1493fca53ab63ba1686c9afdfb65142e59d3 size=29509544 url={value of setting "_BESClient_AllowCustomRepoDownloads" of client | "http://download.oracle.com/MANUAL_BES_CACHING_REQUIRED/"}jre-7u80-windows-i586.exe sha256=a87adf22064e2f7fa6ef64b2513533bf02aa0bf5265670e95b301a79d7ca89d9
end prefetch block

continue if {not exists running application whose ((it = "java.exe" OR it = "javaw.exe" OR it = "javaws.exe" OR it = "iexplore.exe" OR it = "firefox.exe") of (name of it as lowercase))}

// Note: update .exe will restart service automatically
if{exists running service "JavaQuickStarterService"}
delete __appendfile
delete stop_javaquickstarter.bat
appendfile net stop JavaQuickStarterService
move __appendfile stop_javaquickstarter.bat
waithidden stop_javaquickstarter.bat
endif

regset "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation]" "InstallingJava7_32"=dword:00000001

waithidden __Download/jre-7u80-windows-i586.exe /s

action may require restart "305c1493fca53ab63ba1686c9afdfb65142e59d3"

continue if {exists value "DisplayVersion" whose ((it = "7" and it >= "7.0.800") of (it as string as version)) of keys whose (value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase contains "runtimeenvironment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase starts with "java 7") of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of registry}

regdelete "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation]" "InstallingJava7_32"]]></ActionScript>
					<SuccessCriteria Option="OriginalRelevance"></SuccessCriteria>
					<Relevance><![CDATA[((((((((if( name of operating system starts with "Win" ) then platform id of operating system != 3 else false) AND (if exists property "in proxy agent context" then ( not in proxy agent context ) else true )) AND (name of operating system as lowercase starts with "win")) AND (not exists key "HKLM\Software\Wow6432Node\Microsoft\Windows\CurrentVersion" whose (exists value "ProductId" of it OR exists value "CommonFilesDir" of it) of registry AND not exists values "PROCESSOR_ARCHITECTURE" whose (it as string as lowercase = "ia64") of keys "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment" of registry)) AND (exists value "DisplayVersion" whose ((it = "7" and it < "7.0.800") of (it as string as version)) of keys whose (value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase contains "runtimeenvironment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase starts with "java 7") of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of registry)) AND (name of operating system != "WinNT")) AND (exists file "msiexec.exe" whose (version of it >= "3.0") of system folder)) AND (if (exists key "HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation" of registry) then (not exists value "InstallingJava7_32" whose (it = 1) of key "HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation" of registry) else true)) AND (NOT exists value "DisplayVersion" whose ((it = "7" and it >= "7.0.800") of (it as string as version)) of keys whose (value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase contains "runtimeenvironment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase starts with "java 7") of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of registry)]]></Relevance>
				</BaselineComponent>
				<BaselineComponent Name="Java Runtime Environment 8 update 112 Available (JRE &lt; 8 Installed)" IncludeInRelevance="true" SourceSiteURL="http://sync.bigfix.com/cgi-bin/bfgather/updateswindowsapps" SourceID="7051333" ActionName="Action1">
					<ActionScript MIMEType="application/x-Fixlet-Windows-Shell"><![CDATA[begin prefetch block	
add prefetch item name = jre-8u112-windows-i586.exe sha1=68892986b43312b1956fdc6500b587aaec01bd81 size=56090176 url={value of setting "_BESClient_AllowCustomRepoDownloads" of client | "http://download.oracle.com/MANUAL_BES_CACHING_REQUIRED/"}jre-8u112-windows-i586.exe sha256=69bbbf9ef8a8878547f7002ec472eecec393216529fc376b2c2dbd3984976709
end prefetch block

continue if {not exists running application whose ((it = "java.exe" OR it = "javaw.exe" OR it = "javaws.exe" OR it = "iexplore.exe" OR it = "firefox.exe") of (name of it as lowercase))}

// Note: update .exe will restart service automatically
if{exists running service "JavaQuickStarterService"}
delete __appendfile
delete stop_javaquickstarter.bat
appendfile net stop JavaQuickStarterService
move __appendfile stop_javaquickstarter.bat
waithidden stop_javaquickstarter.bat
endif

regset "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation]" "InstallingJava8_32"=dword:00000001

waithidden __Download/jre-8u112-windows-i586.exe /s

action may require restart "68892986b43312b1956fdc6500b587aaec01bd81"

continue if {exists value "DisplayVersion" whose ((it = "8" and it >= "8.0.1120") of (it as string as version)) of keys whose (value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase contains "runtimeenvironment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase starts with "java 8") of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of registry}

regdelete "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation]" "InstallingJava8_32"]]></ActionScript>
					<SuccessCriteria Option="OriginalRelevance"></SuccessCriteria>
					<Relevance><![CDATA[(((((((((if( name of operating system starts with "Win" ) then platform id of operating system != 3 else false) AND (if exists property "in proxy agent context" then ( not in proxy agent context ) else true )) AND (name of operating system as lowercase starts with "win")) AND (not exists key "HKLM\Software\Wow6432Node\Microsoft\Windows\CurrentVersion" whose (exists value "ProductId" of it OR exists value "CommonFilesDir" of it) of registry AND not exists values "PROCESSOR_ARCHITECTURE" whose (it as string as lowercase = "ia64") of keys "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment" of registry)) AND (NOT exists value "DisplayVersion" whose ((it = "8" and it >= "8.0.1120") of (it as string as version)) of keys whose (value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase contains "runtimeenvironment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase starts with "java 8") of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of registry)) AND (name of operating system != "WinNT")) AND (exists file "msiexec.exe" whose (version of it >= "3.0") of system folder)) AND (if (exists key "HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation" of registry) then (not exists value "InstallingJava8_32" whose (it = 1) of key "HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation" of registry) else true)) AND (exists value "DisplayVersion" whose ((it < "8") of (it as string as version)) of keys whose ((value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase contains "runtimeenvironment" OR value "DisplayName" of it as string as lowercase starts with "java " & ((8-1) as string)) AND (not (value "DisplayName" of it as string as lowercase contains "development kit" or value "DisplayName" of it as string as lowercase contains "auto updater" or value "DisplayName" of it as string as lowercase contains "javafx"))) of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of registry)) AND (NOT (it contains "Win2000" OR it contains "WinXP" OR it contains "Win2003") of name of operating system)]]></Relevance>
				</BaselineComponent>
				<BaselineComponent Name="Java Runtime Environment 8 update 112 Available (JRE 8 Installed)" IncludeInRelevance="true" SourceSiteURL="http://sync.bigfix.com/cgi-bin/bfgather/updateswindowsapps" SourceID="7051335" ActionName="Action1">
					<ActionScript MIMEType="application/x-Fixlet-Windows-Shell"><![CDATA[begin prefetch block	
add prefetch item name = jre-8u112-windows-i586.exe sha1=68892986b43312b1956fdc6500b587aaec01bd81 size=56090176 url={value of setting "_BESClient_AllowCustomRepoDownloads" of client | "http://download.oracle.com/MANUAL_BES_CACHING_REQUIRED/"}jre-8u112-windows-i586.exe sha256=69bbbf9ef8a8878547f7002ec472eecec393216529fc376b2c2dbd3984976709
end prefetch block

continue if {not exists running application whose ((it = "java.exe" OR it = "javaw.exe" OR it = "javaws.exe" OR it = "iexplore.exe" OR it = "firefox.exe") of (name of it as lowercase))}

// Note: update .exe will restart service automatically
if{exists running service "JavaQuickStarterService"}
delete __appendfile
delete stop_javaquickstarter.bat
appendfile net stop JavaQuickStarterService
move __appendfile stop_javaquickstarter.bat
waithidden stop_javaquickstarter.bat
endif

regset "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation]" "InstallingJava8_32"=dword:00000001

waithidden __Download/jre-8u112-windows-i586.exe /s

action may require restart "68892986b43312b1956fdc6500b587aaec01bd81"

continue if {exists value "DisplayVersion" whose ((it = "8" and it >= "8.0.1120") of (it as string as version)) of keys whose (value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase contains "runtimeenvironment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase starts with "java 8") of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of registry}

regdelete "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation]" "InstallingJava8_32"]]></ActionScript>
					<SuccessCriteria Option="OriginalRelevance"></SuccessCriteria>
					<Relevance><![CDATA[(((((((((if( name of operating system starts with "Win" ) then platform id of operating system != 3 else false) AND (if exists property "in proxy agent context" then ( not in proxy agent context ) else true )) AND (name of operating system as lowercase starts with "win")) AND (not exists key "HKLM\Software\Wow6432Node\Microsoft\Windows\CurrentVersion" whose (exists value "ProductId" of it OR exists value "CommonFilesDir" of it) of registry AND not exists values "PROCESSOR_ARCHITECTURE" whose (it as string as lowercase = "ia64") of keys "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment" of registry)) AND (exists value "DisplayVersion" whose ((it = "8" and it < "8.0.1120") of (it as string as version)) of keys whose (value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase contains "runtimeenvironment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase starts with "java 8") of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of registry)) AND (name of operating system != "WinNT")) AND (exists file "msiexec.exe" whose (version of it >= "3.0") of system folder)) AND (if (exists key "HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation" of registry) then (not exists value "InstallingJava8_32" whose (it = 1) of key "HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation" of registry) else true)) AND (NOT exists value "DisplayVersion" whose ((it = "8" and it >= "8.0.1120") of (it as string as version)) of keys whose (value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase contains "runtimeenvironment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase starts with "java 8") of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of registry)) AND (NOT (it contains "Win2000" OR it contains "WinXP" OR it contains "Win2003") of name of operating system)]]></Relevance>
				</BaselineComponent>
				<BaselineComponent Name="Java Runtime Environment 8 update 111 Available (JRE &lt; 8 Installed)" IncludeInRelevance="true" SourceSiteURL="http://sync.bigfix.com/cgi-bin/bfgather/updateswindowsapps" SourceID="7051339" ActionName="Action1">
					<ActionScript MIMEType="application/x-Fixlet-Windows-Shell"><![CDATA[begin prefetch block	
add prefetch item name = jre-8u111-windows-i586.exe sha1=11d6a333a6d1b939a4d40082a4acab737071a7b8 size=56134208 url={value of setting "_BESClient_AllowCustomRepoDownloads" of client | "http://download.oracle.com/MANUAL_BES_CACHING_REQUIRED/"}jre-8u111-windows-i586.exe sha256=03a2463dde28e2db03c64723d75a1a3b55a3454449fc2411a749e16b1d9f80ae
end prefetch block

continue if {not exists running application whose ((it = "java.exe" OR it = "javaw.exe" OR it = "javaws.exe" OR it = "iexplore.exe" OR it = "firefox.exe") of (name of it as lowercase))}

// Note: update .exe will restart service automatically
if{exists running service "JavaQuickStarterService"}
delete __appendfile
delete stop_javaquickstarter.bat
appendfile net stop JavaQuickStarterService
move __appendfile stop_javaquickstarter.bat
waithidden stop_javaquickstarter.bat
endif

regset "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation]" "InstallingJava8_32"=dword:00000001

waithidden __Download/jre-8u111-windows-i586.exe /s

action may require restart "11d6a333a6d1b939a4d40082a4acab737071a7b8"

continue if {exists value "DisplayVersion" whose ((it = "8" and it >= "8.0.1110") of (it as string as version)) of keys whose (value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase contains "runtimeenvironment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase starts with "java 8") of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of registry}

regdelete "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation]" "InstallingJava8_32"]]></ActionScript>
					<SuccessCriteria Option="OriginalRelevance"></SuccessCriteria>
					<Relevance><![CDATA[(((((((((if( name of operating system starts with "Win" ) then platform id of operating system != 3 else false) AND (if exists property "in proxy agent context" then ( not in proxy agent context ) else true )) AND (name of operating system as lowercase starts with "win")) AND (not exists key "HKLM\Software\Wow6432Node\Microsoft\Windows\CurrentVersion" whose (exists value "ProductId" of it OR exists value "CommonFilesDir" of it) of registry AND not exists values "PROCESSOR_ARCHITECTURE" whose (it as string as lowercase = "ia64") of keys "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment" of registry)) AND (NOT exists value "DisplayVersion" whose ((it = "8" and it >= "8.0.1110") of (it as string as version)) of keys whose (value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase contains "runtimeenvironment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase starts with "java 8") of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of registry)) AND (name of operating system != "WinNT")) AND (exists file "msiexec.exe" whose (version of it >= "3.0") of system folder)) AND (if (exists key "HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation" of registry) then (not exists value "InstallingJava8_32" whose (it = 1) of key "HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation" of registry) else true)) AND (exists value "DisplayVersion" whose ((it < "8") of (it as string as version)) of keys whose ((value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase contains "runtimeenvironment" OR value "DisplayName" of it as string as lowercase starts with "java " & ((8-1) as string)) AND (not (value "DisplayName" of it as string as lowercase contains "development kit" or value "DisplayName" of it as string as lowercase contains "auto updater" or value "DisplayName" of it as string as lowercase contains "javafx"))) of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of registry)) AND (NOT (it contains "Win2000" OR it contains "WinXP" OR it contains "Win2003") of name of operating system)]]></Relevance>
				</BaselineComponent>
				<BaselineComponent Name="Java Runtime Environment 8 update 111 Available (JRE 8 Installed)" IncludeInRelevance="true" SourceSiteURL="http://sync.bigfix.com/cgi-bin/bfgather/updateswindowsapps" SourceID="7051341" ActionName="Action1">
					<ActionScript MIMEType="application/x-Fixlet-Windows-Shell"><![CDATA[begin prefetch block	
add prefetch item name = jre-8u111-windows-i586.exe sha1=11d6a333a6d1b939a4d40082a4acab737071a7b8 size=56134208 url={value of setting "_BESClient_AllowCustomRepoDownloads" of client | "http://download.oracle.com/MANUAL_BES_CACHING_REQUIRED/"}jre-8u111-windows-i586.exe sha256=03a2463dde28e2db03c64723d75a1a3b55a3454449fc2411a749e16b1d9f80ae
end prefetch block

continue if {not exists running application whose ((it = "java.exe" OR it = "javaw.exe" OR it = "javaws.exe" OR it = "iexplore.exe" OR it = "firefox.exe") of (name of it as lowercase))}

// Note: update .exe will restart service automatically
if{exists running service "JavaQuickStarterService"}
delete __appendfile
delete stop_javaquickstarter.bat
appendfile net stop JavaQuickStarterService
move __appendfile stop_javaquickstarter.bat
waithidden stop_javaquickstarter.bat
endif

regset "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation]" "InstallingJava8_32"=dword:00000001

waithidden __Download/jre-8u111-windows-i586.exe /s

action may require restart "11d6a333a6d1b939a4d40082a4acab737071a7b8"

continue if {exists value "DisplayVersion" whose ((it = "8" and it >= "8.0.1110") of (it as string as version)) of keys whose (value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase contains "runtimeenvironment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase starts with "java 8") of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of registry}

regdelete "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation]" "InstallingJava8_32"]]></ActionScript>
					<SuccessCriteria Option="OriginalRelevance"></SuccessCriteria>
					<Relevance><![CDATA[(((((((((if( name of operating system starts with "Win" ) then platform id of operating system != 3 else false) AND (if exists property "in proxy agent context" then ( not in proxy agent context ) else true )) AND (name of operating system as lowercase starts with "win")) AND (not exists key "HKLM\Software\Wow6432Node\Microsoft\Windows\CurrentVersion" whose (exists value "ProductId" of it OR exists value "CommonFilesDir" of it) of registry AND not exists values "PROCESSOR_ARCHITECTURE" whose (it as string as lowercase = "ia64") of keys "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment" of registry)) AND (exists value "DisplayVersion" whose ((it = "8" and it < "8.0.1110") of (it as string as version)) of keys whose (value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase contains "runtimeenvironment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase starts with "java 8") of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of registry)) AND (name of operating system != "WinNT")) AND (exists file "msiexec.exe" whose (version of it >= "3.0") of system folder)) AND (if (exists key "HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation" of registry) then (not exists value "InstallingJava8_32" whose (it = 1) of key "HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation" of registry) else true)) AND (NOT exists value "DisplayVersion" whose ((it = "8" and it >= "8.0.1110") of (it as string as version)) of keys whose (value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase contains "runtimeenvironment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase starts with "java 8") of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of registry)) AND (NOT (it contains "Win2000" OR it contains "WinXP" OR it contains "Win2003") of name of operating system)]]></Relevance>
				</BaselineComponent>
				<BaselineComponent Name="Java Runtime Environment 6 update 45 Available (JRE 6 Installed) (x64)" IncludeInRelevance="true" SourceSiteURL="http://sync.bigfix.com/cgi-bin/bfgather/updateswindowsapps" SourceID="7056167" ActionName="Action1">
					<ActionScript MIMEType="application/x-Fixlet-Windows-Shell"><![CDATA[begin prefetch block	
add prefetch item name = jre-6u45-windows-x64.exe sha1=210c9527dcc0122ca90d22c2f5b96c03d5bb7b48 size=17355184 url={value of setting "_BESClient_AllowCustomRepoDownloads" of client | "http://download.oracle.com/MANUAL_BES_CACHING_REQUIRED/"}jre-6u45-windows-x64.exe sha256=16d5c9f0eb4e3fad207416ed1c98926be7a946f044ba8ad8e19de1242dff0c25
end prefetch block

continue if {not exists running application whose ((it = "java.exe" OR it = "javaw.exe" OR it = "javaws.exe" OR it = "iexplore.exe" OR it = "firefox.exe") of (name of it as lowercase))}

// Note: update .exe will restart service automatically
if{exists running service "JavaQuickStarterService"}
delete __appendfile
delete stop_javaquickstarter.bat
appendfile net stop JavaQuickStarterService
move __appendfile stop_javaquickstarter.bat
waithidden stop_javaquickstarter.bat
endif


regset "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation]" "InstallingJava64"=dword:00000001

waithidden __Download\jre-6u45-windows-x64.exe /s /norestart

action may require restart "210c9527dcc0122ca90d22c2f5b96c03d5bb7b48"

continue if {((exists value "DisplayVersion" whose ((it >= "6.0.450" OR it < "1.6.0.0") of ((if (it as string = "1.5.0") then (it as string & ".00") else (it as string)) as version)) of keys whose ((value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)") AND (value "DisplayName" of it as string as lowercase contains "64-bit")) of it) AND (exists key whose (((it contains "java" OR it contains "j2se") AND ((it contains "runtime environment" OR it contains "update")) AND (it contains "64-bit")) of (value "DisplayName" of it as string as lowercase)) of it)) of key "HKLM\Software\Microsoft\Windows\CurrentVersion\Uninstall" of x64 registry}

regdelete "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation]" "InstallingJava64"]]></ActionScript>
					<SuccessCriteria Option="OriginalRelevance"></SuccessCriteria>
					<Relevance><![CDATA[((((((((if( name of operating system starts with "Win" ) then platform id of operating system != 3 else false) AND (if exists property "in proxy agent context" then ( not in proxy agent context ) else true )) AND (name of operating system as lowercase starts with "win")) AND (version of client >= "6.0")) AND (x64 of operating system)) AND (not exists values "PROCESSOR_ARCHITECTURE" whose (it as string as lowercase = "ia64") of keys "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment" of registry)) AND (exists value "DisplayVersion" whose ((it = "6" and it < "6.0.450") of (it as string as version)) of keys whose ((value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase contains "runtimeenvironment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase starts with "java 7") AND (value "DisplayName" of it as string as lowercase contains "64-bit")) of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of x64 registry)) AND (exists key whose (((it contains "java" OR it contains "j2se") AND ((it contains "runtime environment" OR it contains "runtimeenvironment" OR it contains "update")) AND (it contains "64-bit")) of (value "DisplayName" of it as string as lowercase)) of key "HKLM\Software\Microsoft\Windows\CurrentVersion\Uninstall" of x64 registry)) AND (if (exists key "HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation" of registry) then (not exists value "InstallingJava64" whose (it = 1) of key "HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation" of registry) else true)]]></Relevance>
				</BaselineComponent>
				<BaselineComponent Name="Java Runtime Environment 6 update 45 (32-bit) Available (JRE 6 32-bit version Installed) (x64)" IncludeInRelevance="true" SourceSiteURL="http://sync.bigfix.com/cgi-bin/bfgather/updateswindowsapps" SourceID="7056171" ActionName="Action1">
					<ActionScript MIMEType="application/x-Fixlet-Windows-Shell"><![CDATA[begin prefetch block	
add prefetch item name = jre-6u45-windows-i586.exe sha1=5100b8eafaa7ed73ed6dab5469ba3faff38a9ae9 size=17090992 url={value of setting "_BESClient_AllowCustomRepoDownloads" of client | "http://download.oracle.com/MANUAL_BES_CACHING_REQUIRED/"}jre-6u45-windows-i586.exe sha256=48c2893738109b833b07ecc7129879dc900c272ebefdad41826ff93d543ca4e9
end prefetch block

continue if {not exists running application whose ((it = "java.exe" OR it = "javaw.exe" OR it = "javaws.exe" OR it = "iexplore.exe" OR it = "firefox.exe") of (name of it as lowercase))}

// Note: update .exe will restart service automatically
if{exists running service "JavaQuickStarterService"}
delete __appendfile
delete stop_javaquickstarter.bat
appendfile net stop JavaQuickStarterService
move __appendfile stop_javaquickstarter.bat
waithidden stop_javaquickstarter.bat
endif

regset "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation]" "InstallingJava32"=dword:00000001
 
//if it is win2k/2k3/xp system, just invoke the .exe installer
if {(name of it contains "Win2000" or name of it contains "WinXP" or name of it contains "Win2003") of operating system}
waithidden __Download\jre-6u45-windows-i586.exe /s /norestart
 
 
else
// Remove any existing directory junction point
dos %windir%\syswow64\cmd.exe /C fsutil reparsepoint delete "%windir%\syswow64\config\systemprofile\appdata\locallow\sun\java"
// delete java directory in 32bit version of system32, if any
dos rmdir /q /s "%windir%\syswow64\config\systemprofile\appdata\locallow\sun\java"
//create a java folder under system32 folder if not exists
if {not exist folder (system folder as string &"\config\systemprofile\appdata\locallow\sun\java")}
action uses wow64 redirection false
dos mkdir "%windir%\system32\config\systemprofile\appdata\locallow\sun\java"
endif
// create ntfs junction point from 32bit version of system32 java files to sysnative version
// (NOTE: mklink argument seems to be in native path perspective, so system32 is correct here, not sysnative)
action uses wow64 redirection false
dos mklink /J "%windir%\syswow64\config\systemprofile\appdata\locallow\sun\java" "%windir%\system32\config\systemprofile\appdata\locallow\sun\java" 
 
 
// Finally, try to install java...
action uses wow64 redirection false
dos %windir%\syswow64\cmd.exe /C __Download\jre-6u45-windows-i586.exe /norestart /s
 
endif

action may require restart "5100b8eafaa7ed73ed6dab5469ba3faff38a9ae9"

continue if {((exists value "DisplayVersion" whose ((it >= "6.0.450") of ((if (it as string = "1.5.0") then (it as string & ".00") else (it as string)) as version)) of keys whose (value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)") of it) AND (exists key whose (((it contains "java" OR it contains "j2se") AND (it contains "runtime environment" OR it contains "update")) of (value "DisplayName" of it as string as lowercase)) of it)) of key "HKLM\Software\Microsoft\Windows\CurrentVersion\Uninstall" of x32 registry}

regdelete "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation]" "InstallingJava32"]]></ActionScript>
					<SuccessCriteria Option="OriginalRelevance"></SuccessCriteria>
					<Relevance><![CDATA[(((((((((if( name of operating system starts with "Win" ) then platform id of operating system != 3 else false) AND (if exists property "in proxy agent context" then ( not in proxy agent context ) else true )) AND (name of operating system as lowercase starts with "win")) AND (version of client >= "6.0")) AND (x64 of operating system)) AND (not exists values "PROCESSOR_ARCHITECTURE" whose (it as string as lowercase = "ia64") of keys "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment" of registry)) AND (exists value "DisplayVersion" whose ((it = "6" and it < "6.0.450") of (it as string as version)) of keys whose (value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase contains "runtimeenvironment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase starts with "java 7") of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of x32 registry)) AND (exists key whose (((it contains "java" OR it contains "j2se") AND (it contains "runtime environment" OR it contains "runtime environment" OR it contains "update")) of (value "DisplayName" of it as string as lowercase)) of key "HKLM\Software\Microsoft\Windows\CurrentVersion\Uninstall" of x32 registry)) AND (exists file "msiexec.exe" whose (version of it >= "3.0") of system folder)) AND (if (exists key "HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation" of registry) then (not exists value "InstallingJava32" whose (it = 1) of key "HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation" of registry) else true)]]></Relevance>
				</BaselineComponent>
				<BaselineComponent Name="Java Runtime Environment 7 update 79 Available (x64) (JRE 7 Installed)" IncludeInRelevance="true" SourceSiteURL="http://sync.bigfix.com/cgi-bin/bfgather/updateswindowsapps" SourceID="7056221" ActionName="Action1">
					<ActionScript MIMEType="application/x-Fixlet-Windows-Shell"><![CDATA[begin prefetch block	
add prefetch item name = jre-7u79-windows-x64.exe sha1=6e407b926eaf023e4248fdfffa810ded9d4ac7a3 size=31224232 url={value of setting "_BESClient_AllowCustomRepoDownloads" of client | "http://download.oracle.com/MANUAL_BES_CACHING_REQUIRED/"}jre-7u79-windows-x64.exe sha256=b49e45be3966cb251aca3ba675bd56c73e460075fae99711d0d285b39889f494
end prefetch block

continue if {not exists running application whose ((it = "java.exe" OR it = "javaw.exe" OR it = "javaws.exe" OR it = "iexplore.exe" OR it = "firefox.exe") of (name of it as lowercase))}

// Note: update .exe will restart service automatically
if{exists running service "JavaQuickStarterService"}
delete __appendfile
delete stop_javaquickstarter.bat
appendfile net stop JavaQuickStarterService
move __appendfile stop_javaquickstarter.bat
waithidden stop_javaquickstarter.bat
endif

regset "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation]" "InstallingJava7_64"=dword:00000001

waithidden __Download\jre-7u79-windows-x64.exe /s

action may require restart "6e407b926eaf023e4248fdfffa810ded9d4ac7a3"

continue if {((exists value "DisplayVersion" whose ((it = "7" and it >= "7.0.790") of (it as string as version)) of keys whose ((value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase contains "runtimeenvironment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase starts with "java 7") AND (value "DisplayName" of it as string as lowercase contains "64-bit")) of it) AND (exists key whose (((it contains "java" OR it contains "j2se") AND ((it contains "runtime environment" OR it contains "update")) AND (it contains "64-bit")) of (value "DisplayName" of it as string as lowercase)) of it)) of key "HKLM\Software\Microsoft\Windows\CurrentVersion\Uninstall" of x64 registry}

regdelete "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation]" "InstallingJava7_64"]]></ActionScript>
					<SuccessCriteria Option="OriginalRelevance"></SuccessCriteria>
					<Relevance><![CDATA[(((((((((if( name of operating system starts with "Win" ) then platform id of operating system != 3 else false) AND (if exists property "in proxy agent context" then ( not in proxy agent context ) else true )) AND (name of operating system as lowercase starts with "win")) AND (version of client >= "6.0")) AND (x64 of operating system)) AND (not exists values "PROCESSOR_ARCHITECTURE" whose (it as string as lowercase = "ia64") of keys "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment" of registry)) AND (exists value "DisplayVersion" whose ((it = "7" and it < "7.0.790") of (it as string as version)) of keys whose ((value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase contains "runtimeenvironment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase starts with "java 7") AND (value "DisplayName" of it as string as lowercase contains "64-bit")) of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of x64 registry)) AND (exists key whose (((it contains "java" OR it contains "j2se") AND ((it contains "runtime environment" OR it contains "update" OR it starts with "java(tm)" OR it starts with "java 7")) AND (it contains "64-bit")) of (value "DisplayName" of it as string as lowercase)) of key "HKLM\Software\Microsoft\Windows\CurrentVersion\Uninstall" of x64 registry)) AND (if (exists key "HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation" of registry) then (not exists value "InstallingJava7_64" whose (it = 1) of key "HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation" of registry) else true)) AND (not exists value "DisplayVersion" whose ((it = "7" and it >= "7.0.790") of (it as string as version)) of keys whose (value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase contains "runtimeenvironment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase starts with "java 7") of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of x64 registry)]]></Relevance>
				</BaselineComponent>
				<BaselineComponent Name="Java Runtime Environment 7 update 80 Available (x64) (JRE 7 Installed)" IncludeInRelevance="true" SourceSiteURL="http://sync.bigfix.com/cgi-bin/bfgather/updateswindowsapps" SourceID="7056227" ActionName="Action1">
					<ActionScript MIMEType="application/x-Fixlet-Windows-Shell"><![CDATA[begin prefetch block	
add prefetch item name = jre-7u80-windows-x64.exe sha1=63bef6fda793a47223b423b84687ee645c787e08 size=31239592 url={value of setting "_BESClient_AllowCustomRepoDownloads" of client | "http://download.oracle.com/MANUAL_BES_CACHING_REQUIRED/"}jre-7u80-windows-x64.exe sha256=d39b520370fe9d201d402928461e04e7453ebd474878d7fe4df30c5813fdcfbc
end prefetch block

continue if {not exists running application whose ((it = "java.exe" OR it = "javaw.exe" OR it = "javaws.exe" OR it = "iexplore.exe" OR it = "firefox.exe") of (name of it as lowercase))}

// Note: update .exe will restart service automatically
if{exists running service "JavaQuickStarterService"}
delete __appendfile
delete stop_javaquickstarter.bat
appendfile net stop JavaQuickStarterService
move __appendfile stop_javaquickstarter.bat
waithidden stop_javaquickstarter.bat
endif

regset "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation]" "InstallingJava7_64"=dword:00000001

waithidden __Download\jre-7u80-windows-x64.exe /s

action may require restart "63bef6fda793a47223b423b84687ee645c787e08"

continue if {((exists value "DisplayVersion" whose ((it = "7" and it >= "7.0.800") of (it as string as version)) of keys whose ((value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase contains "runtimeenvironment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase starts with "java 7") AND (value "DisplayName" of it as string as lowercase contains "64-bit")) of it) AND (exists key whose (((it contains "java" OR it contains "j2se") AND ((it contains "runtime environment" OR it contains "update")) AND (it contains "64-bit")) of (value "DisplayName" of it as string as lowercase)) of it)) of key "HKLM\Software\Microsoft\Windows\CurrentVersion\Uninstall" of x64 registry}

regdelete "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation]" "InstallingJava7_64"]]></ActionScript>
					<SuccessCriteria Option="OriginalRelevance"></SuccessCriteria>
					<Relevance><![CDATA[(((((((((if( name of operating system starts with "Win" ) then platform id of operating system != 3 else false) AND (if exists property "in proxy agent context" then ( not in proxy agent context ) else true )) AND (name of operating system as lowercase starts with "win")) AND (version of client >= "6.0")) AND (x64 of operating system)) AND (not exists values "PROCESSOR_ARCHITECTURE" whose (it as string as lowercase = "ia64") of keys "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment" of registry)) AND (exists value "DisplayVersion" whose ((it = "7" and it < "7.0.800") of (it as string as version)) of keys whose ((value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase contains "runtimeenvironment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase starts with "java 7") AND (value "DisplayName" of it as string as lowercase contains "64-bit")) of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of x64 registry)) AND (exists key whose (((it contains "java" OR it contains "j2se") AND ((it contains "runtime environment" OR it contains "update" OR it starts with "java(tm)" OR it starts with "java 7")) AND (it contains "64-bit")) of (value "DisplayName" of it as string as lowercase)) of key "HKLM\Software\Microsoft\Windows\CurrentVersion\Uninstall" of x64 registry)) AND (if (exists key "HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation" of registry) then (not exists value "InstallingJava7_64" whose (it = 1) of key "HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation" of registry) else true)) AND (not exists value "DisplayVersion" whose ((it = "7" and it >= "7.0.800") of (it as string as version)) of keys whose (value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase contains "runtimeenvironment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase starts with "java 7") of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of x64 registry)]]></Relevance>
				</BaselineComponent>
				<BaselineComponent Name="Java Runtime Environment 7 update 79 (32-bit) Available (JRE &lt; 7 32-bit version Installed) (x64)" IncludeInRelevance="true" SourceSiteURL="http://sync.bigfix.com/cgi-bin/bfgather/updateswindowsapps" SourceID="7056340" ActionName="Action1">
					<ActionScript MIMEType="application/x-Fixlet-Windows-Shell"><![CDATA[begin prefetch block	
add prefetch item name = jre-7u79-windows-i586.exe sha1=b062b03a04e0f3ce222282ca1760e4234d3c6f1f size=29490088 url={value of setting "_BESClient_AllowCustomRepoDownloads" of client | "http://download.oracle.com/MANUAL_BES_CACHING_REQUIRED/"}jre-7u79-windows-i586.exe sha256=ffd7ac432c4ee2b7da52c257392127a744ee304a73d554f3f4fc067cebe589ed
end prefetch block

continue if {not exists running application whose ((it = "java.exe" OR it = "javaw.exe" OR it = "javaws.exe" OR it = "iexplore.exe" OR it = "firefox.exe") of (name of it as lowercase))}

// Note: update .exe will restart service automatically
if{exists running service "JavaQuickStarterService"}
delete __appendfile
delete stop_javaquickstarter.bat
appendfile net stop JavaQuickStarterService
move __appendfile stop_javaquickstarter.bat
waithidden stop_javaquickstarter.bat
endif

regset "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation]" "InstallingJava7_32"=dword:00000001
 
//if it is win2k/2k3/xp system, just invoke the .exe installer
if {(name of it contains "Win2000" or name of it contains "WinXP" or name of it contains "Win2003") of operating system}
waithidden __Download\jre-7u79-windows-i586.exe /s  
 
else
// Remove any existing directory junction point
dos %windir%\syswow64\cmd.exe /C fsutil reparsepoint delete "%windir%\syswow64\config\systemprofile\appdata\locallow\sun\java"
// delete java directory in 32bit version of system32, if any
dos rmdir /q /s "%windir%\syswow64\config\systemprofile\appdata\locallow\sun\java"
//create a java folder under system32 folder if not exists
if {not exist folder (system folder as string &"\config\systemprofile\appdata\locallow\sun\java")}
action uses wow64 redirection false
dos mkdir "%windir%\system32\config\systemprofile\appdata\locallow\sun\java"
endif
// create ntfs junction point from 32bit version of system32 java files to sysnative version
// (NOTE: mklink argument seems to be in native path perspective, so system32 is correct here, not sysnative)
action uses wow64 redirection false
dos mklink /J "%windir%\syswow64\config\systemprofile\appdata\locallow\sun\java" "%windir%\system32\config\systemprofile\appdata\locallow\sun\java" 
 
 
// Finally, try to install java...
action uses wow64 redirection false
dos %windir%\syswow64\cmd.exe /C __Download\jre-7u79-windows-i586.exe /s
 
endif

action may require restart "b062b03a04e0f3ce222282ca1760e4234d3c6f1f"

continue if {((exists value "DisplayVersion" whose ((it >= "7.0.790") of (it as string as version)) of keys whose (value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase contains "runtimeenvironment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase starts with "java 7") of it) AND (exists key whose (((it contains "java" OR it contains "j2se") AND (it contains "runtime environment" OR it contains "update")) of (value "DisplayName" of it as string as lowercase)) of it)) of key "HKLM\Software\Microsoft\Windows\CurrentVersion\Uninstall" of x32 registry}

regdelete "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation]" "InstallingJava7_32"]]></ActionScript>
					<SuccessCriteria Option="OriginalRelevance"></SuccessCriteria>
					<Relevance><![CDATA[((((((((((if( name of operating system starts with "Win" ) then platform id of operating system != 3 else false) AND (if exists property "in proxy agent context" then ( not in proxy agent context ) else true )) AND (name of operating system as lowercase starts with "win")) AND (version of client >= "6.0")) AND (x64 of operating system)) AND (not exists values "PROCESSOR_ARCHITECTURE" whose (it as string as lowercase = "ia64") of keys "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment" of registry)) AND (exists value "DisplayVersion" whose ((it < "7") of (it as string as version)) of keys whose ((value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase contains "runtimeenvironment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase starts with "java ") AND (not (value "DisplayName" of it as string as lowercase contains "development kit" or value "DisplayName" of it as string as lowercase contains "auto updater" or value "DisplayName" of it as string as lowercase contains "javafx"))) of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of x32 registry)) AND (exists key whose (((it contains "java" OR it contains "j2se") AND (it contains "runtime environment" OR it contains "update" OR it starts with "java(tm)")) of (value "DisplayName" of it as string as lowercase)) of key "HKLM\Software\Microsoft\Windows\CurrentVersion\Uninstall" of x32 registry)) AND (exists file "msiexec.exe" whose (version of it >= "3.0") of system folder)) AND (if (exists key "HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation" of registry) then (not exists value "InstallingJava7_32" whose (it = 1) of key "HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation" of registry) else true)) AND (NOT exists value "DisplayVersion" whose ((it>"7.0."& ((79-1) as string) &"0") of (it as string as version)) of keys whose ((value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase contains "runtimeenvironment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase starts with "java ")) of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of x32 registry)]]></Relevance>
				</BaselineComponent>
				<BaselineComponent Name="Java Runtime Environment 7 update 79 (32-bit) Available (JRE 7 32-bit version Installed) (x64)" IncludeInRelevance="true" SourceSiteURL="http://sync.bigfix.com/cgi-bin/bfgather/updateswindowsapps" SourceID="7056342" ActionName="Action1">
					<ActionScript MIMEType="application/x-Fixlet-Windows-Shell"><![CDATA[begin prefetch block	
add prefetch item name = jre-7u79-windows-i586.exe sha1=b062b03a04e0f3ce222282ca1760e4234d3c6f1f size=29490088 url={value of setting "_BESClient_AllowCustomRepoDownloads" of client | "http://download.oracle.com/MANUAL_BES_CACHING_REQUIRED/"}jre-7u79-windows-i586.exe sha256=ffd7ac432c4ee2b7da52c257392127a744ee304a73d554f3f4fc067cebe589ed
end prefetch block

continue if {not exists running application whose ((it = "java.exe" OR it = "javaw.exe" OR it = "javaws.exe" OR it = "iexplore.exe" OR it = "firefox.exe") of (name of it as lowercase))}

// Note: update .exe will restart service automatically
if{exists running service "JavaQuickStarterService"}
delete __appendfile
delete stop_javaquickstarter.bat
appendfile net stop JavaQuickStarterService
move __appendfile stop_javaquickstarter.bat
waithidden stop_javaquickstarter.bat
endif

regset "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation]" "InstallingJava7_32"=dword:00000001
 
//if it is win2k/2k3/xp system, just invoke the .exe installer
if {(name of it contains "Win2000" or name of it contains "WinXP" or name of it contains "Win2003") of operating system}
waithidden __Download\jre-7u79-windows-i586.exe /s
 
 
else
// Remove any existing directory junction point
dos %windir%\syswow64\cmd.exe /C fsutil reparsepoint delete "%windir%\syswow64\config\systemprofile\appdata\locallow\sun\java"
// delete java directory in 32bit version of system32, if any
dos rmdir /q /s "%windir%\syswow64\config\systemprofile\appdata\locallow\sun\java"
//create a java folder under system32 folder if not exists
if {not exist folder (system folder as string &"\config\systemprofile\appdata\locallow\sun\java")}
action uses wow64 redirection false
dos mkdir "%windir%\system32\config\systemprofile\appdata\locallow\sun\java"
endif
// create ntfs junction point from 32bit version of system32 java files to sysnative version
// (NOTE: mklink argument seems to be in native path perspective, so system32 is correct here, not sysnative)
action uses wow64 redirection false
dos mklink /J "%windir%\syswow64\config\systemprofile\appdata\locallow\sun\java" "%windir%\system32\config\systemprofile\appdata\locallow\sun\java" 
 
 
// Finally, try to install java...
action uses wow64 redirection false
dos %windir%\syswow64\cmd.exe /C __Download\jre-7u79-windows-i586.exe /s
 
endif

action may require restart "b062b03a04e0f3ce222282ca1760e4234d3c6f1f"

continue if {((exists value "DisplayVersion" whose ((it >= "7.0.790") of (it as string as version)) of keys whose (value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase contains "runtimeenvironment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase starts with "java 7") of it) AND (exists key whose (((it contains "java" OR it contains "j2se") AND (it contains "runtime environment" OR it contains "update")) of (value "DisplayName" of it as string as lowercase)) of it)) of key "HKLM\Software\Microsoft\Windows\CurrentVersion\Uninstall" of x32 registry}

regdelete "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation]" "InstallingJava7_32"]]></ActionScript>
					<SuccessCriteria Option="OriginalRelevance"></SuccessCriteria>
					<Relevance><![CDATA[(((((((((if( name of operating system starts with "Win" ) then platform id of operating system != 3 else false) AND (if exists property "in proxy agent context" then ( not in proxy agent context ) else true )) AND (name of operating system as lowercase starts with "win")) AND (version of client >= "6.0")) AND (x64 of operating system)) AND (not exists values "PROCESSOR_ARCHITECTURE" whose (it as string as lowercase = "ia64") of keys "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment" of registry)) AND ((exists value "DisplayVersion" whose ((it = "7" and it < "7.0.790") of (it as string as version)) of keys whose (value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase contains "runtimeenvironment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase starts with "java 7") of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of x32 registry) and (not exists value "DisplayVersion" whose ((it = "7" and it >= "7.0.790") of (it as string as version)) of keys whose (value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase contains "runtimeenvironment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase starts with "java 7") of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of x32 registry))) AND (exists key whose (value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase starts with "java 7") of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of x32 registry)) AND (exists file "msiexec.exe" whose (version of it >= "3.0") of system folder)) AND (if (exists key "HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation" of registry) then (not exists value "InstallingJava7_32" whose (it = 1) of key "HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation" of registry) else true)]]></Relevance>
				</BaselineComponent>
				<BaselineComponent Name="Java Runtime Environment 7 update 79 Available (x64) (JRE &lt; 7 Installed)" IncludeInRelevance="true" SourceSiteURL="http://sync.bigfix.com/cgi-bin/bfgather/updateswindowsapps" SourceID="7056346" ActionName="Action1">
					<ActionScript MIMEType="application/x-Fixlet-Windows-Shell"><![CDATA[begin prefetch block	
add prefetch item name = jre-7u79-windows-x64.exe sha1=6e407b926eaf023e4248fdfffa810ded9d4ac7a3 size=31224232 url={value of setting "_BESClient_AllowCustomRepoDownloads" of client | "http://download.oracle.com/MANUAL_BES_CACHING_REQUIRED/"}jre-7u79-windows-x64.exe sha256=b49e45be3966cb251aca3ba675bd56c73e460075fae99711d0d285b39889f494
end prefetch block

continue if {not exists running application whose ((it = "java.exe" OR it = "javaw.exe" OR it = "javaws.exe" OR it = "iexplore.exe" OR it = "firefox.exe") of (name of it as lowercase))}

// Note: update .exe will restart service automatically
if{exists running service "JavaQuickStarterService"}
delete __appendfile
delete stop_javaquickstarter.bat
appendfile net stop JavaQuickStarterService
move __appendfile stop_javaquickstarter.bat
waithidden stop_javaquickstarter.bat
endif

regset "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation]" "InstallingJava7_64"=dword:00000001

waithidden __Download\jre-7u79-windows-x64.exe /S

action may require restart "6e407b926eaf023e4248fdfffa810ded9d4ac7a3"

continue if {((exists value "DisplayVersion" whose ((it = "7" and it >= "7.0.790") of (it as string as version)) of keys whose ((value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase contains "runtimeenvironment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase starts with "java 7") AND (value "DisplayName" of it as string as lowercase contains "64-bit")) of it) AND (exists key whose (((it contains "java" OR it contains "j2se") AND ((it contains "runtime environment" OR it contains "update")) AND (it contains "64-bit")) of (value "DisplayName" of it as string as lowercase)) of it)) of key "HKLM\Software\Microsoft\Windows\CurrentVersion\Uninstall" of x64 registry}

regdelete "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation]" "InstallingJava7_64"]]></ActionScript>
					<SuccessCriteria Option="OriginalRelevance"></SuccessCriteria>
					<Relevance><![CDATA[(((((((((if( name of operating system starts with "Win" ) then platform id of operating system != 3 else false) AND (if exists property "in proxy agent context" then ( not in proxy agent context ) else true )) AND (name of operating system as lowercase starts with "win")) AND (version of client >= "6.0")) AND (x64 of operating system)) AND (not exists values "PROCESSOR_ARCHITECTURE" whose (it as string as lowercase = "ia64") of keys "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment" of registry)) AND (NOT exists value "DisplayVersion" whose ((it>"7.0."& ((79-1) as string) &"0") of (it as string as version)) of keys whose ((value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase contains "runtimeenvironment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase starts with "java ") AND (value "DisplayName" of it as string as lowercase contains "64-bit")) of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of x64 registry)) AND (exists key whose (((it contains "java" OR it contains "j2se") AND ((it contains "runtime environment" OR it contains "update" OR it starts with "java(tm)")) AND (it contains "64-bit")) of (value "DisplayName" of it as string as lowercase)) of key "HKLM\Software\Microsoft\Windows\CurrentVersion\Uninstall" of x64 registry)) AND (if (exists key "HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation" of registry) then (not exists value "InstallingJava7_64" whose (it = 1) of key "HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation" of registry) else true)) AND (exists value "DisplayVersion" whose ((it < "7") of (it as string as version)) of keys whose ((value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase contains "runtimeenvironment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase starts with "java ") AND (value "DisplayName" of it as string as lowercase contains "64-bit") AND (not (value "DisplayName" of it as string as lowercase contains "development kit" or value "DisplayName" of it as string as lowercase contains "auto updater" or value "DisplayName" of it as string as lowercase contains "javafx"))) of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of x64 registry)]]></Relevance>
				</BaselineComponent>
				<BaselineComponent Name="Java Runtime Environment 7 update 80 (32-bit) Available (JRE &lt; 7 32-bit version Installed) (x64)" IncludeInRelevance="true" SourceSiteURL="http://sync.bigfix.com/cgi-bin/bfgather/updateswindowsapps" SourceID="7056348" ActionName="Action1">
					<ActionScript MIMEType="application/x-Fixlet-Windows-Shell"><![CDATA[begin prefetch block	
add prefetch item name = jre-7u80-windows-i586.exe sha1=305c1493fca53ab63ba1686c9afdfb65142e59d3 size=29509544 url={value of setting "_BESClient_AllowCustomRepoDownloads" of client | "http://download.oracle.com/MANUAL_BES_CACHING_REQUIRED/"}jre-7u80-windows-i586.exe sha256=a87adf22064e2f7fa6ef64b2513533bf02aa0bf5265670e95b301a79d7ca89d9
end prefetch block

continue if {not exists running application whose ((it = "java.exe" OR it = "javaw.exe" OR it = "javaws.exe" OR it = "iexplore.exe" OR it = "firefox.exe") of (name of it as lowercase))}

// Note: update .exe will restart service automatically
if{exists running service "JavaQuickStarterService"}
delete __appendfile
delete stop_javaquickstarter.bat
appendfile net stop JavaQuickStarterService
move __appendfile stop_javaquickstarter.bat
waithidden stop_javaquickstarter.bat
endif

regset "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation]" "InstallingJava7_32"=dword:00000001
 
//if it is win2k/2k3/xp system, just invoke the .exe installer
if {(name of it contains "Win2000" or name of it contains "WinXP" or name of it contains "Win2003") of operating system}
waithidden __Download\jre-7u80-windows-i586.exe /s  
 
else
// Remove any existing directory junction point
dos %windir%\syswow64\cmd.exe /C fsutil reparsepoint delete "%windir%\syswow64\config\systemprofile\appdata\locallow\sun\java"
// delete java directory in 32bit version of system32, if any
dos rmdir /q /s "%windir%\syswow64\config\systemprofile\appdata\locallow\sun\java"
//create a java folder under system32 folder if not exists
if {not exist folder (system folder as string &"\config\systemprofile\appdata\locallow\sun\java")}
action uses wow64 redirection false
dos mkdir "%windir%\system32\config\systemprofile\appdata\locallow\sun\java"
endif
// create ntfs junction point from 32bit version of system32 java files to sysnative version
// (NOTE: mklink argument seems to be in native path perspective, so system32 is correct here, not sysnative)
action uses wow64 redirection false
dos mklink /J "%windir%\syswow64\config\systemprofile\appdata\locallow\sun\java" "%windir%\system32\config\systemprofile\appdata\locallow\sun\java" 
 
 
// Finally, try to install java...
action uses wow64 redirection false
dos %windir%\syswow64\cmd.exe /C __Download\jre-7u80-windows-i586.exe /s
 
endif

action may require restart "305c1493fca53ab63ba1686c9afdfb65142e59d3"

continue if {((exists value "DisplayVersion" whose ((it >= "7.0.800") of (it as string as version)) of keys whose (value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase contains "runtimeenvironment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase starts with "java 7") of it) AND (exists key whose (((it contains "java" OR it contains "j2se") AND (it contains "runtime environment" OR it contains "update")) of (value "DisplayName" of it as string as lowercase)) of it)) of key "HKLM\Software\Microsoft\Windows\CurrentVersion\Uninstall" of x32 registry}

regdelete "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation]" "InstallingJava7_32"]]></ActionScript>
					<SuccessCriteria Option="OriginalRelevance"></SuccessCriteria>
					<Relevance><![CDATA[((((((((((if( name of operating system starts with "Win" ) then platform id of operating system != 3 else false) AND (if exists property "in proxy agent context" then ( not in proxy agent context ) else true )) AND (name of operating system as lowercase starts with "win")) AND (version of client >= "6.0")) AND (x64 of operating system)) AND (not exists values "PROCESSOR_ARCHITECTURE" whose (it as string as lowercase = "ia64") of keys "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment" of registry)) AND (exists value "DisplayVersion" whose ((it < "7") of (it as string as version)) of keys whose ((value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase contains "runtimeenvironment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase starts with "java ") AND (not (value "DisplayName" of it as string as lowercase contains "development kit" or value "DisplayName" of it as string as lowercase contains "auto updater" or value "DisplayName" of it as string as lowercase contains "javafx"))) of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of x32 registry)) AND (exists key whose (((it contains "java" OR it contains "j2se") AND (it contains "runtime environment" OR it contains "update" OR it starts with "java(tm)")) of (value "DisplayName" of it as string as lowercase)) of key "HKLM\Software\Microsoft\Windows\CurrentVersion\Uninstall" of x32 registry)) AND (exists file "msiexec.exe" whose (version of it >= "3.0") of system folder)) AND (if (exists key "HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation" of registry) then (not exists value "InstallingJava7_32" whose (it = 1) of key "HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation" of registry) else true)) AND (NOT exists value "DisplayVersion" whose ((it>"7.0."& ((80-1) as string) &"0") of (it as string as version)) of keys whose ((value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase contains "runtimeenvironment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase starts with "java ")) of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of x32 registry)]]></Relevance>
				</BaselineComponent>
				<BaselineComponent Name="Java Runtime Environment 7 update 80 (32-bit) Available (JRE 7 32-bit version Installed) (x64)" IncludeInRelevance="true" SourceSiteURL="http://sync.bigfix.com/cgi-bin/bfgather/updateswindowsapps" SourceID="7056350" ActionName="Action1">
					<ActionScript MIMEType="application/x-Fixlet-Windows-Shell"><![CDATA[begin prefetch block	
add prefetch item name = jre-7u80-windows-i586.exe sha1=305c1493fca53ab63ba1686c9afdfb65142e59d3 size=29509544 url={value of setting "_BESClient_AllowCustomRepoDownloads" of client | "http://download.oracle.com/MANUAL_BES_CACHING_REQUIRED/"}jre-7u80-windows-i586.exe sha256=a87adf22064e2f7fa6ef64b2513533bf02aa0bf5265670e95b301a79d7ca89d9
end prefetch block

continue if {not exists running application whose ((it = "java.exe" OR it = "javaw.exe" OR it = "javaws.exe" OR it = "iexplore.exe" OR it = "firefox.exe") of (name of it as lowercase))}

// Note: update .exe will restart service automatically
if{exists running service "JavaQuickStarterService"}
delete __appendfile
delete stop_javaquickstarter.bat
appendfile net stop JavaQuickStarterService
move __appendfile stop_javaquickstarter.bat
waithidden stop_javaquickstarter.bat
endif

regset "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation]" "InstallingJava7_32"=dword:00000001
 
//if it is win2k/2k3/xp system, just invoke the .exe installer
if {(name of it contains "Win2000" or name of it contains "WinXP" or name of it contains "Win2003") of operating system}
waithidden __Download\jre-7u80-windows-i586.exe /s
 
 
else
// Remove any existing directory junction point
dos %windir%\syswow64\cmd.exe /C fsutil reparsepoint delete "%windir%\syswow64\config\systemprofile\appdata\locallow\sun\java"
// delete java directory in 32bit version of system32, if any
dos rmdir /q /s "%windir%\syswow64\config\systemprofile\appdata\locallow\sun\java"
//create a java folder under system32 folder if not exists
if {not exist folder (system folder as string &"\config\systemprofile\appdata\locallow\sun\java")}
action uses wow64 redirection false
dos mkdir "%windir%\system32\config\systemprofile\appdata\locallow\sun\java"
endif
// create ntfs junction point from 32bit version of system32 java files to sysnative version
// (NOTE: mklink argument seems to be in native path perspective, so system32 is correct here, not sysnative)
action uses wow64 redirection false
dos mklink /J "%windir%\syswow64\config\systemprofile\appdata\locallow\sun\java" "%windir%\system32\config\systemprofile\appdata\locallow\sun\java" 
 
 
// Finally, try to install java...
action uses wow64 redirection false
dos %windir%\syswow64\cmd.exe /C __Download\jre-7u80-windows-i586.exe /s
 
endif

action may require restart "305c1493fca53ab63ba1686c9afdfb65142e59d3"

continue if {((exists value "DisplayVersion" whose ((it >= "7.0.800") of (it as string as version)) of keys whose (value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase contains "runtimeenvironment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase starts with "java 7") of it) AND (exists key whose (((it contains "java" OR it contains "j2se") AND (it contains "runtime environment" OR it contains "update")) of (value "DisplayName" of it as string as lowercase)) of it)) of key "HKLM\Software\Microsoft\Windows\CurrentVersion\Uninstall" of x32 registry}

regdelete "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation]" "InstallingJava7_32"]]></ActionScript>
					<SuccessCriteria Option="OriginalRelevance"></SuccessCriteria>
					<Relevance><![CDATA[(((((((((if( name of operating system starts with "Win" ) then platform id of operating system != 3 else false) AND (if exists property "in proxy agent context" then ( not in proxy agent context ) else true )) AND (name of operating system as lowercase starts with "win")) AND (version of client >= "6.0")) AND (x64 of operating system)) AND (not exists values "PROCESSOR_ARCHITECTURE" whose (it as string as lowercase = "ia64") of keys "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment" of registry)) AND ((exists value "DisplayVersion" whose ((it = "7" and it < "7.0.800") of (it as string as version)) of keys whose (value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase contains "runtimeenvironment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase starts with "java 7") of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of x32 registry) and (not exists value "DisplayVersion" whose ((it = "7" and it >= "7.0.800") of (it as string as version)) of keys whose (value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase contains "runtimeenvironment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase starts with "java 7") of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of x32 registry))) AND (exists key whose (value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase starts with "java 7") of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of x32 registry)) AND (exists file "msiexec.exe" whose (version of it >= "3.0") of system folder)) AND (if (exists key "HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation" of registry) then (not exists value "InstallingJava7_32" whose (it = 1) of key "HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation" of registry) else true)]]></Relevance>
				</BaselineComponent>
				<BaselineComponent Name="Java Runtime Environment 7 update 80 Available (x64) (JRE &lt; 7 Installed)" IncludeInRelevance="true" SourceSiteURL="http://sync.bigfix.com/cgi-bin/bfgather/updateswindowsapps" SourceID="7056354" ActionName="Action1">
					<ActionScript MIMEType="application/x-Fixlet-Windows-Shell"><![CDATA[begin prefetch block	
add prefetch item name = jre-7u80-windows-x64.exe sha1=63bef6fda793a47223b423b84687ee645c787e08 size=31239592 url={value of setting "_BESClient_AllowCustomRepoDownloads" of client | "http://download.oracle.com/MANUAL_BES_CACHING_REQUIRED/"}jre-7u80-windows-x64.exe sha256=d39b520370fe9d201d402928461e04e7453ebd474878d7fe4df30c5813fdcfbc
end prefetch block

continue if {not exists running application whose ((it = "java.exe" OR it = "javaw.exe" OR it = "javaws.exe" OR it = "iexplore.exe" OR it = "firefox.exe") of (name of it as lowercase))}

// Note: update .exe will restart service automatically
if{exists running service "JavaQuickStarterService"}
delete __appendfile
delete stop_javaquickstarter.bat
appendfile net stop JavaQuickStarterService
move __appendfile stop_javaquickstarter.bat
waithidden stop_javaquickstarter.bat
endif

regset "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation]" "InstallingJava7_64"=dword:00000001

waithidden __Download\jre-7u80-windows-x64.exe /s

action may require restart "63bef6fda793a47223b423b84687ee645c787e08"

continue if {((exists value "DisplayVersion" whose ((it = "7" and it >= "7.0.800") of (it as string as version)) of keys whose ((value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase contains "runtimeenvironment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase starts with "java 7") AND (value "DisplayName" of it as string as lowercase contains "64-bit")) of it) AND (exists key whose (((it contains "java" OR it contains "j2se") AND ((it contains "runtime environment" OR it contains "update")) AND (it contains "64-bit")) of (value "DisplayName" of it as string as lowercase)) of it)) of key "HKLM\Software\Microsoft\Windows\CurrentVersion\Uninstall" of x64 registry}

regdelete "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation]" "InstallingJava7_64"]]></ActionScript>
					<SuccessCriteria Option="OriginalRelevance"></SuccessCriteria>
					<Relevance><![CDATA[(((((((((if( name of operating system starts with "Win" ) then platform id of operating system != 3 else false) AND (if exists property "in proxy agent context" then ( not in proxy agent context ) else true )) AND (name of operating system as lowercase starts with "win")) AND (version of client >= "6.0")) AND (x64 of operating system)) AND (not exists values "PROCESSOR_ARCHITECTURE" whose (it as string as lowercase = "ia64") of keys "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment" of registry)) AND (NOT exists value "DisplayVersion" whose ((it>"7.0."& ((80-1) as string) &"0") of (it as string as version)) of keys whose ((value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase contains "runtimeenvironment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase starts with "java ") AND (value "DisplayName" of it as string as lowercase contains "64-bit")) of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of x64 registry)) AND (exists key whose (((it contains "java" OR it contains "j2se") AND ((it contains "runtime environment" OR it contains "update" OR it starts with "java(tm)")) AND (it contains "64-bit")) of (value "DisplayName" of it as string as lowercase)) of key "HKLM\Software\Microsoft\Windows\CurrentVersion\Uninstall" of x64 registry)) AND (if (exists key "HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation" of registry) then (not exists value "InstallingJava7_64" whose (it = 1) of key "HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation" of registry) else true)) AND (exists value "DisplayVersion" whose ((it < "7") of (it as string as version)) of keys whose ((value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase contains "runtimeenvironment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase starts with "java ") AND (value "DisplayName" of it as string as lowercase contains "64-bit") AND (not (value "DisplayName" of it as string as lowercase contains "development kit" or value "DisplayName" of it as string as lowercase contains "auto updater" or value "DisplayName" of it as string as lowercase contains "javafx"))) of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of x64 registry)]]></Relevance>
				</BaselineComponent>
				<BaselineComponent Name="Java Runtime Environment 8 update 112 Available (x64) (JRE 8 Installed)" IncludeInRelevance="true" SourceSiteURL="http://sync.bigfix.com/cgi-bin/bfgather/updateswindowsapps" SourceID="7056559" ActionName="Action1">
					<ActionScript MIMEType="application/x-Fixlet-Windows-Shell"><![CDATA[begin prefetch block	
add prefetch item name = jre-8u112-windows-x64.exe sha1=7ae0979c78346ae74576fd516c7daaeab50dbf53 size=63821376 url={value of setting "_BESClient_AllowCustomRepoDownloads" of client | "http://download.oracle.com/MANUAL_BES_CACHING_REQUIRED/"}jre-8u112-windows-x64.exe sha256=7c9f97efb024debead9f4e94ee96a9429c2c17d5a9cf377689df532f613e46ef
end prefetch block

continue if {not exists running application whose ((it = "java.exe" OR it = "javaw.exe" OR it = "javaws.exe" OR it = "iexplore.exe" OR it = "firefox.exe") of (name of it as lowercase))}

// Note: update .exe will restart service automatically
if{exists running service "JavaQuickStarterService"}
delete __appendfile
delete stop_javaquickstarter.bat
appendfile net stop JavaQuickStarterService
move __appendfile stop_javaquickstarter.bat
waithidden stop_javaquickstarter.bat
endif

regset "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation]" "InstallingJava8_64"=dword:00000001

waithidden __Download\jre-8u112-windows-x64.exe /s

action may require restart "7ae0979c78346ae74576fd516c7daaeab50dbf53"

continue if {((exists value "DisplayVersion" whose ((it = "8" and it >= "8.0.1120") of (it as string as version)) of keys whose ((value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase contains "runtimeenvironment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase starts with "java 8") AND (value "DisplayName" of it as string as lowercase contains "64-bit")) of it) AND (exists key whose (((it contains "java" OR it contains "j2se") AND ((it contains "runtime environment" OR it contains "update")) AND (it contains "64-bit")) of (value "DisplayName" of it as string as lowercase)) of it)) of key "HKLM\Software\Microsoft\Windows\CurrentVersion\Uninstall" of x64 registry}

regdelete "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation]" "InstallingJava8_64"]]></ActionScript>
					<SuccessCriteria Option="OriginalRelevance"></SuccessCriteria>
					<Relevance><![CDATA[(((((((((if( name of operating system starts with "Win" ) then platform id of operating system != 3 else false) AND (if exists property "in proxy agent context" then ( not in proxy agent context ) else true )) AND (name of operating system as lowercase starts with "win")) AND (version of client >= "6.0")) AND (x64 of operating system)) AND (not exists values "PROCESSOR_ARCHITECTURE" whose (it as string as lowercase = "ia64") of keys "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment" of registry)) AND (exists value "DisplayVersion" whose ((it = "8" and it < "8.0.1120") of (it as string as version)) of keys whose ((value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase contains "runtimeenvironment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase starts with "java 8") AND (value "DisplayName" of it as string as lowercase contains "64-bit")) of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of x64 registry)) AND (if (exists key "HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation" of registry) then (not exists value "InstallingJava8_64" whose (it = 1) of key "HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation" of registry) else true)) AND (not exists value "DisplayVersion" whose ((it >= "8.0.1120") of (it as string as version)) of keys whose ((value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase contains "runtimeenvironment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase starts with "java 8") AND (value "DisplayName" of it as string as lowercase contains "64-bit")) of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of x64 registry)) AND (NOT (it contains "Win2000" OR it contains "WinXP" OR it contains "Win2003") of name of operating system)]]></Relevance>
				</BaselineComponent>
				<BaselineComponent Name="Java Runtime Environment 8 update 112 Available (x64) (JRE &lt; 8 Installed)" IncludeInRelevance="true" SourceSiteURL="http://sync.bigfix.com/cgi-bin/bfgather/updateswindowsapps" SourceID="7056561" ActionName="Action1">
					<ActionScript MIMEType="application/x-Fixlet-Windows-Shell"><![CDATA[begin prefetch block	
add prefetch item name = jre-8u112-windows-x64.exe sha1=7ae0979c78346ae74576fd516c7daaeab50dbf53 size=63821376 url={value of setting "_BESClient_AllowCustomRepoDownloads" of client | "http://download.oracle.com/MANUAL_BES_CACHING_REQUIRED/"}jre-8u112-windows-x64.exe sha256=7c9f97efb024debead9f4e94ee96a9429c2c17d5a9cf377689df532f613e46ef
end prefetch block

continue if {not exists running application whose ((it = "java.exe" OR it = "javaw.exe" OR it = "javaws.exe" OR it = "iexplore.exe" OR it = "firefox.exe") of (name of it as lowercase))}

// Note: update .exe will restart service automatically
if{exists running service "JavaQuickStarterService"}
delete __appendfile
delete stop_javaquickstarter.bat
appendfile net stop JavaQuickStarterService
move __appendfile stop_javaquickstarter.bat
waithidden stop_javaquickstarter.bat
endif

regset "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation]" "InstallingJava8_64"=dword:00000001

waithidden __Download\jre-8u112-windows-x64.exe /s

action may require restart "7ae0979c78346ae74576fd516c7daaeab50dbf53"

continue if {((exists value "DisplayVersion" whose ((it = "8" and it >= "8.0.1120") of (it as string as version)) of keys whose ((value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase contains "runtimeenvironment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase starts with "java 8") AND (value "DisplayName" of it as string as lowercase contains "64-bit")) of it) AND (exists key whose (((it contains "java" OR it contains "j2se") AND ((it contains "runtime environment" OR it contains "update")) AND (it contains "64-bit")) of (value "DisplayName" of it as string as lowercase)) of it)) of key "HKLM\Software\Microsoft\Windows\CurrentVersion\Uninstall" of x64 registry}

regdelete "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation]" "InstallingJava8_64"]]></ActionScript>
					<SuccessCriteria Option="OriginalRelevance"></SuccessCriteria>
					<Relevance><![CDATA[(((((((((if( name of operating system starts with "Win" ) then platform id of operating system != 3 else false) AND (if exists property "in proxy agent context" then ( not in proxy agent context ) else true )) AND (name of operating system as lowercase starts with "win")) AND (version of client >= "6.0")) AND (x64 of operating system)) AND (not exists values "PROCESSOR_ARCHITECTURE" whose (it as string as lowercase = "ia64") of keys "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment" of registry)) AND (NOT exists value "DisplayVersion" whose ((it = "8" and it>="8.0.1120") of (it as string as version)) of keys whose ((value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase contains "runtimeenvironment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase starts with "java 8") AND (value "DisplayName" of it as string as lowercase contains "64-bit")) of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of x64 registry)) AND (if (exists key "HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation" of registry) then (not exists value "InstallingJava8_64" whose (it = 1) of key "HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation" of registry) else true)) AND (exists value "DisplayVersion" whose ((it < "8") of (it as string as version)) of keys whose ((value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase contains "runtimeenvironment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase starts with "java " & ((8-1) as string)) AND (value "DisplayName" of it as string as lowercase contains "64-bit") AND (not (value "DisplayName" of it as string as lowercase contains "development kit" or value "DisplayName" of it as string as lowercase contains "auto updater" or value "DisplayName" of it as string as lowercase contains "javafx"))) of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of x64 registry)) AND (NOT (it contains "Win2000" OR it contains "WinXP" OR it contains "Win2003") of name of operating system)]]></Relevance>
				</BaselineComponent>
				<BaselineComponent Name="Java Runtime Environment 8 update 112 (32-bit) Available (JRE &lt; 8 32-bit version Installed) (x64)" IncludeInRelevance="true" SourceSiteURL="http://sync.bigfix.com/cgi-bin/bfgather/updateswindowsapps" SourceID="7056567" ActionName="Action1">
					<ActionScript MIMEType="application/x-Fixlet-Windows-Shell"><![CDATA[begin prefetch block	
add prefetch item name = jre-8u112-windows-i586.exe sha1=68892986b43312b1956fdc6500b587aaec01bd81 size=56090176 url={value of setting "_BESClient_AllowCustomRepoDownloads" of client | "http://download.oracle.com/MANUAL_BES_CACHING_REQUIRED/"}jre-8u112-windows-i586.exe sha256=69bbbf9ef8a8878547f7002ec472eecec393216529fc376b2c2dbd3984976709
end prefetch block

continue if {not exists running application whose ((it = "java.exe" OR it = "javaw.exe" OR it = "javaws.exe" OR it = "iexplore.exe" OR it = "firefox.exe") of (name of it as lowercase))}

// Note: update .exe will restart service automatically
if{exists running service "JavaQuickStarterService"}
delete __appendfile
delete stop_javaquickstarter.bat
appendfile net stop JavaQuickStarterService
move __appendfile stop_javaquickstarter.bat
waithidden stop_javaquickstarter.bat
endif
 
//if it is win2k/2k3/xp system, just invoke the .exe installer
if {(name of it contains "Win2000" or name of it contains "WinXP" or name of it contains "Win2003") of operating system}
waithidden __Download\jre-8u112-windows-i586.exe /s
 
else
// Remove any existing directory junction point
dos %windir%\syswow64\cmd.exe /C fsutil reparsepoint delete "%windir%\syswow64\config\systemprofile\appdata\locallow\sun\java"
dos %windir%\syswow64\cmd.exe /C fsutil reparsepoint delete "%windir%\syswow64\config\systemprofile\appdata\locallow\oracle\java"
// delete java directory in 32bit version of system32, if any
dos rmdir /q /s "%windir%\syswow64\config\systemprofile\appdata\locallow\sun\java"
dos rmdir /q /s "%windir%\syswow64\config\systemprofile\appdata\locallow\oracle\java"
//create a java folder under system32 folder if not exists
if {not exist folder (system folder as string &"\config\systemprofile\appdata\locallow\oracle\java")}
action uses wow64 redirection false
dos mkdir "%windir%\syswow64\config\systemprofile\appdata\locallow\oracle"
dos mkdir "%windir%\system32\config\systemprofile\appdata\locallow\oracle\java"
endif

// create ntfs junction point from 32bit version of system32 java files to sysnative version
// (NOTE: mklink argument seems to be in native path perspective, so system32 is correct here, not sysnative)
action uses wow64 redirection false
dos mklink /J "%windir%\syswow64\config\systemprofile\appdata\locallow\oracle\java" "%windir%\system32\config\systemprofile\appdata\locallow\oracle\java" 
 
 
// Finally, try to install java...
action uses wow64 redirection false
dos %windir%\syswow64\cmd.exe /C __Download\jre-8u112-windows-i586.exe /s
 
endif

action may require restart "68892986b43312b1956fdc6500b587aaec01bd81"

continue if {((exists value "DisplayVersion" whose ((it >= "8.0.1120") of (it as string as version)) of keys whose (value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase contains "runtimeenvironment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase starts with "java 8") of it) AND (exists key whose (((it contains "java" OR it contains "j2se") AND (it contains "runtime environment" OR it contains "update")) of (value "DisplayName" of it as string as lowercase)) of it)) of key "HKLM\Software\Microsoft\Windows\CurrentVersion\Uninstall" of x32 registry}]]></ActionScript>
					<SuccessCriteria Option="OriginalRelevance"></SuccessCriteria>
					<Relevance><![CDATA[((((((((((if( name of operating system starts with "Win" ) then platform id of operating system != 3 else false) AND (if exists property "in proxy agent context" then ( not in proxy agent context ) else true )) AND (name of operating system as lowercase starts with "win")) AND (version of client >= "6.0")) AND (x64 of operating system)) AND (not exists values "PROCESSOR_ARCHITECTURE" whose (it as string as lowercase = "ia64") of keys "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment" of registry)) AND (exists value "DisplayVersion" whose ((it < "8") of (it as string as version)) of keys whose (value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase contains "runtimeenvironment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase starts with "java " & ((8 - 1) as string)) of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of x32 registry)) AND (exists file "msiexec.exe" whose (version of it >= "3.0") of system folder)) AND (if (exists key "HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation" of registry) then (not exists value "InstallingJava8_32" whose (it = 1) of key "HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation" of registry) else true)) AND (NOT exists value "DisplayVersion" whose ((it = "8" and it>="8.0.1120") of (it as string as version)) of keys whose ((value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase contains "runtimeenvironment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase starts with "java 8")) of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of x32 registry)) AND (NOT (it contains "Win2000" OR it contains "WinXP" OR it contains "Win2003") of name of operating system)]]></Relevance>
				</BaselineComponent>
				<BaselineComponent Name="Java Runtime Environment 8 update 112 (32-bit) Available (JRE 8 32-bit version Installed) (x64)" IncludeInRelevance="true" SourceSiteURL="http://sync.bigfix.com/cgi-bin/bfgather/updateswindowsapps" SourceID="7056569" ActionName="Action1">
					<ActionScript MIMEType="application/x-Fixlet-Windows-Shell"><![CDATA[begin prefetch block	
add prefetch item name = jre-8u112-windows-i586.exe sha1=68892986b43312b1956fdc6500b587aaec01bd81 size=56090176 url={value of setting "_BESClient_AllowCustomRepoDownloads" of client | "http://download.oracle.com/MANUAL_BES_CACHING_REQUIRED/"}jre-8u112-windows-i586.exe sha256=69bbbf9ef8a8878547f7002ec472eecec393216529fc376b2c2dbd3984976709
end prefetch block

continue if {not exists running application whose ((it = "java.exe" OR it = "javaw.exe" OR it = "javaws.exe" OR it = "iexplore.exe" OR it = "firefox.exe") of (name of it as lowercase))}

// Note: update .exe will restart service automatically
if{exists running service "JavaQuickStarterService"}
delete __appendfile
delete stop_javaquickstarter.bat
appendfile net stop JavaQuickStarterService
move __appendfile stop_javaquickstarter.bat
waithidden stop_javaquickstarter.bat
endif
 
//if it is win2k/2k3/xp system, just invoke the .exe installer
if {(name of it contains "Win2000" or name of it contains "WinXP" or name of it contains "Win2003") of operating system}
waithidden __Download\jre-8u112-windows-i586.exe /s
 
else
// Remove any existing directory junction point
dos %windir%\syswow64\cmd.exe /C fsutil reparsepoint delete "%windir%\syswow64\config\systemprofile\appdata\locallow\sun\java"
dos %windir%\syswow64\cmd.exe /C fsutil reparsepoint delete "%windir%\syswow64\config\systemprofile\appdata\locallow\oracle\java"
// delete java directory in 32bit version of system32, if any
dos rmdir /q /s "%windir%\syswow64\config\systemprofile\appdata\locallow\sun\java"
dos rmdir /q /s "%windir%\syswow64\config\systemprofile\appdata\locallow\oracle\java"
//create a java folder under system32 folder if not exists
if {not exist folder (system folder as string &"\config\systemprofile\appdata\locallow\oracle\java")}
action uses wow64 redirection false
dos mkdir "%windir%\syswow64\config\systemprofile\appdata\locallow\oracle"
dos mkdir "%windir%\system32\config\systemprofile\appdata\locallow\oracle\java"
endif

// create ntfs junction point from 32bit version of system32 java files to sysnative version
// (NOTE: mklink argument seems to be in native path perspective, so system32 is correct here, not sysnative)
action uses wow64 redirection false
dos mklink /J "%windir%\syswow64\config\systemprofile\appdata\locallow\oracle\java" "%windir%\system32\config\systemprofile\appdata\locallow\oracle\java" 
 
 
// Finally, try to install java...
action uses wow64 redirection false
dos %windir%\syswow64\cmd.exe /C __Download\jre-8u112-windows-i586.exe /s
 
endif

action may require restart "68892986b43312b1956fdc6500b587aaec01bd81"

continue if {((exists value "DisplayVersion" whose ((it >= "8.0.1120") of (it as string as version)) of keys whose (value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase contains "runtimeenvironment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase starts with "java 8") of it) AND (exists key whose (((it contains "java" OR it contains "j2se") AND (it contains "runtime environment" OR it contains "update")) of (value "DisplayName" of it as string as lowercase)) of it)) of key "HKLM\Software\Microsoft\Windows\CurrentVersion\Uninstall" of x32 registry}]]></ActionScript>
					<SuccessCriteria Option="OriginalRelevance"></SuccessCriteria>
					<Relevance><![CDATA[(((((((((if( name of operating system starts with "Win" ) then platform id of operating system != 3 else false) AND (if exists property "in proxy agent context" then ( not in proxy agent context ) else true )) AND (name of operating system as lowercase starts with "win")) AND (version of client >= "6.0")) AND (x64 of operating system)) AND (not exists values "PROCESSOR_ARCHITECTURE" whose (it as string as lowercase = "ia64") of keys "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment" of registry)) AND ((exists value "DisplayVersion" whose ((it = "8" and it < "8.0.1120") of (it as string as version)) of keys whose (value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase contains "runtimeenvironment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase starts with "java 8") of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of x32 registry) and (not exists value "DisplayVersion" whose ((it = "8" and it  >= "8.0.1120") of (it as string as version)) of keys whose (value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase contains "runtimeenvironment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase starts with "java 8") of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of x32 registry))) AND (exists file "msiexec.exe" whose (version of it >= "3.0") of system folder)) AND (if (exists key "HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation" of registry) then (not exists value "InstallingJava8_32" whose (it = 1) of key "HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation" of registry) else true)) AND (NOT (it contains "Win2000" OR it contains "WinXP" OR it contains "Win2003") of name of operating system)]]></Relevance>
				</BaselineComponent>
				<BaselineComponent Name="Java Runtime Environment 8 update 111 Available (x64) (JRE 8 Installed)" IncludeInRelevance="true" SourceSiteURL="http://sync.bigfix.com/cgi-bin/bfgather/updateswindowsapps" SourceID="7056571" ActionName="Action1">
					<ActionScript MIMEType="application/x-Fixlet-Windows-Shell"><![CDATA[begin prefetch block	
add prefetch item name = jre-8u111-windows-x64.exe sha1=12e9492f2f2066f5b9187ed00995ede95491c445 size=63235648 url={value of setting "_BESClient_AllowCustomRepoDownloads" of client | "http://download.oracle.com/MANUAL_BES_CACHING_REQUIRED/"}jre-8u111-windows-x64.exe sha256=932dec1bf86b6361ebcc4dfe3b097c9a76d7ea2c109fc9a3241c69fabb5c12cb
end prefetch block

continue if {not exists running application whose ((it = "java.exe" OR it = "javaw.exe" OR it = "javaws.exe" OR it = "iexplore.exe" OR it = "firefox.exe") of (name of it as lowercase))}

// Note: update .exe will restart service automatically
if{exists running service "JavaQuickStarterService"}
delete __appendfile
delete stop_javaquickstarter.bat
appendfile net stop JavaQuickStarterService
move __appendfile stop_javaquickstarter.bat
waithidden stop_javaquickstarter.bat
endif

regset "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation]" "InstallingJava8_64"=dword:00000001

waithidden __Download\jre-8u111-windows-x64.exe /s

action may require restart "12e9492f2f2066f5b9187ed00995ede95491c445"

continue if {((exists value "DisplayVersion" whose ((it = "8" and it >= "8.0.1110") of (it as string as version)) of keys whose ((value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase contains "runtimeenvironment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase starts with "java 8") AND (value "DisplayName" of it as string as lowercase contains "64-bit")) of it) AND (exists key whose (((it contains "java" OR it contains "j2se") AND ((it contains "runtime environment" OR it contains "update")) AND (it contains "64-bit")) of (value "DisplayName" of it as string as lowercase)) of it)) of key "HKLM\Software\Microsoft\Windows\CurrentVersion\Uninstall" of x64 registry}

regdelete "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation]" "InstallingJava8_64"]]></ActionScript>
					<SuccessCriteria Option="OriginalRelevance"></SuccessCriteria>
					<Relevance><![CDATA[(((((((((if( name of operating system starts with "Win" ) then platform id of operating system != 3 else false) AND (if exists property "in proxy agent context" then ( not in proxy agent context ) else true )) AND (name of operating system as lowercase starts with "win")) AND (version of client >= "6.0")) AND (x64 of operating system)) AND (not exists values "PROCESSOR_ARCHITECTURE" whose (it as string as lowercase = "ia64") of keys "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment" of registry)) AND (exists value "DisplayVersion" whose ((it = "8" and it < "8.0.1110") of (it as string as version)) of keys whose ((value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase contains "runtimeenvironment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase starts with "java 8") AND (value "DisplayName" of it as string as lowercase contains "64-bit")) of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of x64 registry)) AND (if (exists key "HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation" of registry) then (not exists value "InstallingJava8_64" whose (it = 1) of key "HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation" of registry) else true)) AND (not exists value "DisplayVersion" whose ((it >= "8.0.1110") of (it as string as version)) of keys whose ((value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase contains "runtimeenvironment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase starts with "java 8") AND (value "DisplayName" of it as string as lowercase contains "64-bit")) of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of x64 registry)) AND (NOT (it contains "Win2000" OR it contains "WinXP" OR it contains "Win2003") of name of operating system)]]></Relevance>
				</BaselineComponent>
				<BaselineComponent Name="Java Runtime Environment 8 update 111 Available (x64) (JRE &lt; 8 Installed)" IncludeInRelevance="true" SourceSiteURL="http://sync.bigfix.com/cgi-bin/bfgather/updateswindowsapps" SourceID="7056573" ActionName="Action1">
					<ActionScript MIMEType="application/x-Fixlet-Windows-Shell"><![CDATA[begin prefetch block	
add prefetch item name = jre-8u111-windows-x64.exe sha1=12e9492f2f2066f5b9187ed00995ede95491c445 size=63235648 url={value of setting "_BESClient_AllowCustomRepoDownloads" of client | "http://download.oracle.com/MANUAL_BES_CACHING_REQUIRED/"}jre-8u111-windows-x64.exe sha256=932dec1bf86b6361ebcc4dfe3b097c9a76d7ea2c109fc9a3241c69fabb5c12cb
end prefetch block

continue if {not exists running application whose ((it = "java.exe" OR it = "javaw.exe" OR it = "javaws.exe" OR it = "iexplore.exe" OR it = "firefox.exe") of (name of it as lowercase))}

// Note: update .exe will restart service automatically
if{exists running service "JavaQuickStarterService"}
delete __appendfile
delete stop_javaquickstarter.bat
appendfile net stop JavaQuickStarterService
move __appendfile stop_javaquickstarter.bat
waithidden stop_javaquickstarter.bat
endif

regset "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation]" "InstallingJava8_64"=dword:00000001

waithidden __Download\jre-8u111-windows-x64.exe /s

action may require restart "12e9492f2f2066f5b9187ed00995ede95491c445"

continue if {((exists value "DisplayVersion" whose ((it = "8" and it >= "8.0.1110") of (it as string as version)) of keys whose ((value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase contains "runtimeenvironment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase starts with "java 8") AND (value "DisplayName" of it as string as lowercase contains "64-bit")) of it) AND (exists key whose (((it contains "java" OR it contains "j2se") AND ((it contains "runtime environment" OR it contains "update")) AND (it contains "64-bit")) of (value "DisplayName" of it as string as lowercase)) of it)) of key "HKLM\Software\Microsoft\Windows\CurrentVersion\Uninstall" of x64 registry}

regdelete "[HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation]" "InstallingJava8_64"]]></ActionScript>
					<SuccessCriteria Option="OriginalRelevance"></SuccessCriteria>
					<Relevance><![CDATA[(((((((((if( name of operating system starts with "Win" ) then platform id of operating system != 3 else false) AND (if exists property "in proxy agent context" then ( not in proxy agent context ) else true )) AND (name of operating system as lowercase starts with "win")) AND (version of client >= "6.0")) AND (x64 of operating system)) AND (not exists values "PROCESSOR_ARCHITECTURE" whose (it as string as lowercase = "ia64") of keys "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment" of registry)) AND (NOT exists value "DisplayVersion" whose ((it = "8" and it>="8.0.1110") of (it as string as version)) of keys whose ((value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase contains "runtimeenvironment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase starts with "java 8") AND (value "DisplayName" of it as string as lowercase contains "64-bit")) of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of x64 registry)) AND (if (exists key "HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation" of registry) then (not exists value "InstallingJava8_64" whose (it = 1) of key "HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation" of registry) else true)) AND (exists value "DisplayVersion" whose ((it < "8") of (it as string as version)) of keys whose ((value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase contains "runtimeenvironment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase starts with "java " & ((8-1) as string)) AND (value "DisplayName" of it as string as lowercase contains "64-bit") AND (not (value "DisplayName" of it as string as lowercase contains "development kit" or value "DisplayName" of it as string as lowercase contains "auto updater" or value "DisplayName" of it as string as lowercase contains "javafx"))) of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of x64 registry)) AND (NOT (it contains "Win2000" OR it contains "WinXP" OR it contains "Win2003") of name of operating system)]]></Relevance>
				</BaselineComponent>
				<BaselineComponent Name="Java Runtime Environment 8 update 111 (32-bit) Available (JRE &lt; 8 32-bit version Installed) (x64)" IncludeInRelevance="true" SourceSiteURL="http://sync.bigfix.com/cgi-bin/bfgather/updateswindowsapps" SourceID="7056579" ActionName="Action1">
					<ActionScript MIMEType="application/x-Fixlet-Windows-Shell"><![CDATA[begin prefetch block	
add prefetch item name = jre-8u111-windows-i586.exe sha1=11d6a333a6d1b939a4d40082a4acab737071a7b8 size=56134208 url={value of setting "_BESClient_AllowCustomRepoDownloads" of client | "http://download.oracle.com/MANUAL_BES_CACHING_REQUIRED/"}jre-8u111-windows-i586.exe sha256=03a2463dde28e2db03c64723d75a1a3b55a3454449fc2411a749e16b1d9f80ae
end prefetch block

continue if {not exists running application whose ((it = "java.exe" OR it = "javaw.exe" OR it = "javaws.exe" OR it = "iexplore.exe" OR it = "firefox.exe") of (name of it as lowercase))}

// Note: update .exe will restart service automatically
if{exists running service "JavaQuickStarterService"}
delete __appendfile
delete stop_javaquickstarter.bat
appendfile net stop JavaQuickStarterService
move __appendfile stop_javaquickstarter.bat
waithidden stop_javaquickstarter.bat
endif
 
//if it is win2k/2k3/xp system, just invoke the .exe installer
if {(name of it contains "Win2000" or name of it contains "WinXP" or name of it contains "Win2003") of operating system}
waithidden __Download\jre-8u111-windows-i586.exe /s
 
else
// Remove any existing directory junction point
dos %windir%\syswow64\cmd.exe /C fsutil reparsepoint delete "%windir%\syswow64\config\systemprofile\appdata\locallow\sun\java"
dos %windir%\syswow64\cmd.exe /C fsutil reparsepoint delete "%windir%\syswow64\config\systemprofile\appdata\locallow\oracle\java"
// delete java directory in 32bit version of system32, if any
dos rmdir /q /s "%windir%\syswow64\config\systemprofile\appdata\locallow\sun\java"
dos rmdir /q /s "%windir%\syswow64\config\systemprofile\appdata\locallow\oracle\java"
//create a java folder under system32 folder if not exists
if {not exist folder (system folder as string &"\config\systemprofile\appdata\locallow\oracle\java")}
action uses wow64 redirection false
dos mkdir "%windir%\syswow64\config\systemprofile\appdata\locallow\oracle"
dos mkdir "%windir%\system32\config\systemprofile\appdata\locallow\oracle\java"
endif

// create ntfs junction point from 32bit version of system32 java files to sysnative version
// (NOTE: mklink argument seems to be in native path perspective, so system32 is correct here, not sysnative)
action uses wow64 redirection false
dos mklink /J "%windir%\syswow64\config\systemprofile\appdata\locallow\oracle\java" "%windir%\system32\config\systemprofile\appdata\locallow\oracle\java" 
 
 
// Finally, try to install java...
action uses wow64 redirection false
dos %windir%\syswow64\cmd.exe /C __Download\jre-8u111-windows-i586.exe /s
 
endif

action may require restart "11d6a333a6d1b939a4d40082a4acab737071a7b8"

continue if {((exists value "DisplayVersion" whose ((it >= "8.0.1110") of (it as string as version)) of keys whose (value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase contains "runtimeenvironment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase starts with "java 8") of it) AND (exists key whose (((it contains "java" OR it contains "j2se") AND (it contains "runtime environment" OR it contains "update")) of (value "DisplayName" of it as string as lowercase)) of it)) of key "HKLM\Software\Microsoft\Windows\CurrentVersion\Uninstall" of x32 registry}]]></ActionScript>
					<SuccessCriteria Option="OriginalRelevance"></SuccessCriteria>
					<Relevance><![CDATA[((((((((((if( name of operating system starts with "Win" ) then platform id of operating system != 3 else false) AND (if exists property "in proxy agent context" then ( not in proxy agent context ) else true )) AND (name of operating system as lowercase starts with "win")) AND (version of client >= "6.0")) AND (x64 of operating system)) AND (not exists values "PROCESSOR_ARCHITECTURE" whose (it as string as lowercase = "ia64") of keys "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment" of registry)) AND (exists value "DisplayVersion" whose ((it < "8") of (it as string as version)) of keys whose (value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase contains "runtimeenvironment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase starts with "java " & ((8 - 1) as string)) of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of x32 registry)) AND (exists file "msiexec.exe" whose (version of it >= "3.0") of system folder)) AND (if (exists key "HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation" of registry) then (not exists value "InstallingJava8_32" whose (it = 1) of key "HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation" of registry) else true)) AND (NOT exists value "DisplayVersion" whose ((it = "8" and it>="8.0.1110") of (it as string as version)) of keys whose ((value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase contains "runtimeenvironment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase starts with "java 8")) of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of x32 registry)) AND (NOT (it contains "Win2000" OR it contains "WinXP" OR it contains "Win2003") of name of operating system)]]></Relevance>
				</BaselineComponent>
				<BaselineComponent Name="Java Runtime Environment 8 update 111 (32-bit) Available (JRE 8 32-bit version Installed) (x64)" IncludeInRelevance="true" SourceSiteURL="http://sync.bigfix.com/cgi-bin/bfgather/updateswindowsapps" SourceID="7056581" ActionName="Action1">
					<ActionScript MIMEType="application/x-Fixlet-Windows-Shell"><![CDATA[begin prefetch block	
add prefetch item name = jre-8u111-windows-i586.exe sha1=11d6a333a6d1b939a4d40082a4acab737071a7b8 size=56134208 url={value of setting "_BESClient_AllowCustomRepoDownloads" of client | "http://download.oracle.com/MANUAL_BES_CACHING_REQUIRED/"}jre-8u111-windows-i586.exe sha256=03a2463dde28e2db03c64723d75a1a3b55a3454449fc2411a749e16b1d9f80ae
end prefetch block

continue if {not exists running application whose ((it = "java.exe" OR it = "javaw.exe" OR it = "javaws.exe" OR it = "iexplore.exe" OR it = "firefox.exe") of (name of it as lowercase))}

// Note: update .exe will restart service automatically
if{exists running service "JavaQuickStarterService"}
delete __appendfile
delete stop_javaquickstarter.bat
appendfile net stop JavaQuickStarterService
move __appendfile stop_javaquickstarter.bat
waithidden stop_javaquickstarter.bat
endif
 
//if it is win2k/2k3/xp system, just invoke the .exe installer
if {(name of it contains "Win2000" or name of it contains "WinXP" or name of it contains "Win2003") of operating system}
waithidden __Download\jre-8u111-windows-i586.exe /s
 
else
// Remove any existing directory junction point
dos %windir%\syswow64\cmd.exe /C fsutil reparsepoint delete "%windir%\syswow64\config\systemprofile\appdata\locallow\sun\java"
dos %windir%\syswow64\cmd.exe /C fsutil reparsepoint delete "%windir%\syswow64\config\systemprofile\appdata\locallow\oracle\java"
// delete java directory in 32bit version of system32, if any
dos rmdir /q /s "%windir%\syswow64\config\systemprofile\appdata\locallow\sun\java"
dos rmdir /q /s "%windir%\syswow64\config\systemprofile\appdata\locallow\oracle\java"
//create a java folder under system32 folder if not exists
if {not exist folder (system folder as string &"\config\systemprofile\appdata\locallow\oracle\java")}
action uses wow64 redirection false
dos mkdir "%windir%\syswow64\config\systemprofile\appdata\locallow\oracle"
dos mkdir "%windir%\system32\config\systemprofile\appdata\locallow\oracle\java"
endif

// create ntfs junction point from 32bit version of system32 java files to sysnative version
// (NOTE: mklink argument seems to be in native path perspective, so system32 is correct here, not sysnative)
action uses wow64 redirection false
dos mklink /J "%windir%\syswow64\config\systemprofile\appdata\locallow\oracle\java" "%windir%\system32\config\systemprofile\appdata\locallow\oracle\java" 
 
 
// Finally, try to install java...
action uses wow64 redirection false
dos %windir%\syswow64\cmd.exe /C __Download\jre-8u111-windows-i586.exe /s
 
endif

action may require restart "11d6a333a6d1b939a4d40082a4acab737071a7b8"

continue if {((exists value "DisplayVersion" whose ((it >= "8.0.1110") of (it as string as version)) of keys whose (value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase contains "runtimeenvironment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase starts with "java 8") of it) AND (exists key whose (((it contains "java" OR it contains "j2se") AND (it contains "runtime environment" OR it contains "update")) of (value "DisplayName" of it as string as lowercase)) of it)) of key "HKLM\Software\Microsoft\Windows\CurrentVersion\Uninstall" of x32 registry}]]></ActionScript>
					<SuccessCriteria Option="OriginalRelevance"></SuccessCriteria>
					<Relevance><![CDATA[(((((((((if( name of operating system starts with "Win" ) then platform id of operating system != 3 else false) AND (if exists property "in proxy agent context" then ( not in proxy agent context ) else true )) AND (name of operating system as lowercase starts with "win")) AND (version of client >= "6.0")) AND (x64 of operating system)) AND (not exists values "PROCESSOR_ARCHITECTURE" whose (it as string as lowercase = "ia64") of keys "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment" of registry)) AND ((exists value "DisplayVersion" whose ((it = "8" and it < "8.0.1110") of (it as string as version)) of keys whose (value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase contains "runtimeenvironment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase starts with "java 8") of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of x32 registry) and (not exists value "DisplayVersion" whose ((it = "8" and it  >= "8.0.1110") of (it as string as version)) of keys whose (value "DisplayName" of it as string as lowercase contains "j2se runtime environment" OR value "DisplayName" of it as string as lowercase contains "runtimeenvironment" OR value "DisplayName" of it as string as lowercase starts with "java(tm)" OR value "DisplayName" of it as string as lowercase starts with "java 8") of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of x32 registry))) AND (exists file "msiexec.exe" whose (version of it >= "3.0") of system folder)) AND (if (exists key "HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation" of registry) then (not exists value "InstallingJava8_32" whose (it = 1) of key "HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\JavaInstallation" of registry) else true)) AND (NOT (it contains "Win2000" OR it contains "WinXP" OR it contains "Win2003") of name of operating system)]]></Relevance>
				</BaselineComponent>
				<BaselineComponent Name="Adobe Reader 9.5 Available" IncludeInRelevance="true" SourceSiteURL="http://sync.bigfix.com/cgi-bin/bfgather/updateswindowsapps" SourceID="8091138" ActionName="Action1">
					<ActionScript MIMEType="application/x-Fixlet-Windows-Shell">if {exists key whose (value "UI" of it = "ENU") of keys of key "HKEY_LOCAL_MACHINE\SOFTWARE\Adobe\Acrobat Reader" of registry}
prefetch AdbeRdr950_en_US.msi sha1:556e7b8b95486c2c54d7c41aea900707a2967f63 size:43544576 http://ardownload.adobe.com/pub/adobe/reader/win/9.x/9.5.0/en_US/AdbeRdr950_en_US.msi sha256:9bfe8c7de38bb4e1b5328733908cb5f971de37884566d36078c0b7f5f3f34416
waithidden msiexec.exe /qn /i "__Download\AdbeRdr950_en_US.msi"

elseif {exists key whose (value "UI" of it = "FRA") of keys of key "HKEY_LOCAL_MACHINE\SOFTWARE\Adobe\Acrobat Reader" of registry}
prefetch AdbeRdr950_fr_FR.msi sha1:f39c998f85bd683c4b175f4c9cb64d4a385569bb size:48378368 http://ardownload.adobe.com/pub/adobe/reader/win/9.x/9.5.0/fr_FR/AdbeRdr950_fr_FR.msi sha256:8fdf4295e16270b105499cbe02a859a220efc5716795cc18bad5584b2813fa40
waithidden msiexec.exe /qn /i "__Download\AdbeRdr950_fr_FR.msi"

elseif {exists key whose (value "UI" of it = "ITA") of keys of key "HKEY_LOCAL_MACHINE\SOFTWARE\Adobe\Acrobat Reader" of registry}
prefetch AdbeRdr950_it_IT.msi sha1:a246577f02587ef6addece15a3711298b81c784a size:47366656 http://ardownload.adobe.com/pub/adobe/reader/win/9.x/9.5.0/it_IT/AdbeRdr950_it_IT.msi sha256:3037a26e48107b4c769898f34441fda61b56bb0ca0c94f5c3f8feee6ca303b15
waithidden msiexec.exe /qn /i "__Download\AdbeRdr950_it_IT.msi"


elseif {exists key whose (value "UI" of it = "DEU") of keys of key "HKEY_LOCAL_MACHINE\SOFTWARE\Adobe\Acrobat Reader" of registry}
prefetch AdbeRdr950_de_DE.msi sha1:8692a205c8f80f73a207ac365dfdf724bc48dfc4 size:49529344 http://ardownload.adobe.com/pub/adobe/reader/win/9.x/9.5.0/de_DE/AdbeRdr950_de_DE.msi sha256:e34b5856e6fabd4a99eb4cfa756a42424a16eaa3078774743a3ac142c9665ced
waithidden msiexec.exe /qn /i "__Download\AdbeRdr950_de_DE.msi"

elseif {exists key whose (value "UI" of it = "ESP") of keys of key "HKEY_LOCAL_MACHINE\SOFTWARE\Adobe\Acrobat Reader" of registry}
prefetch AdbeRdr950_es_ES.msi sha1:144a833f43c76b20f07b33dc97d5ec2cd0b4f717 size:47924224 http://ardownload.adobe.com/pub/adobe/reader/win/9.x/9.5.0/es_ES/AdbeRdr950_es_ES.msi sha256:c7030636edc01448a95d719a20b7598b446dbbde4ee49c848aef472b3a5fa47a
waithidden msiexec.exe /qn /i "__Download\AdbeRdr950_es_ES.msi"

elseif {exists key whose (value "UI" of it = "CHS") of keys of key "HKEY_LOCAL_MACHINE\SOFTWARE\Adobe\Acrobat Reader" of registry}
prefetch AdbeRdr950_zh_CN.msi sha1:33f6203e8fac83b090252343f224dc83573d350a size:68887040 http://ardownload.adobe.com/pub/adobe/reader/win/9.x/9.5.0/zh_CN/AdbeRdr950_zh_CN.msi sha256:11dd56313e07f2326fdc41ef9e7d986e2c8d8d3f211077cbccb5923f649c4948
waithidden msiexec.exe /qn /i "__Download\AdbeRdr950_zh_CN.msi"

elseif {exists key whose (value "UI" of it = "JPN") of keys of key "HKEY_LOCAL_MACHINE\SOFTWARE\Adobe\Acrobat Reader" of registry}
prefetch AdbeRdr950_ja_JP.msi sha1:d34e2191fccca4c2fb8ea07615a6fe11af4a596a size:57870848 http://ardownload.adobe.com/pub/adobe/reader/win/9.x/9.5.0/ja_JP/AdbeRdr950_ja_JP.msi sha256:de883fa088d11056b341fedf8a3ae05e48a5f8b498cfb7969da902074ea06b52
waithidden msiexec.exe /qn /i "__Download\AdbeRdr950_ja_JP.msi"

elseif {exists key whose (value "UI" of it = "KOR") of keys of key "HKEY_LOCAL_MACHINE\SOFTWARE\Adobe\Acrobat Reader" of registry}
prefetch AdbeRdr950_ko_KR.msi sha1:debc7d4521f53444426e2f09150fae32ce51c88d size:51882496 http://ardownload.adobe.com/pub/adobe/reader/win/9.x/9.5.0/ko_KR/AdbeRdr950_ko_KR.msi sha256:c8b9f9b5b196718d5c4b19b6dc4fd34a5848b4370bbb5872e77be43d7e2cd87a
waithidden msiexec.exe /qn /i "__Download\AdbeRdr950_ko_KR.msi"

elseif {exists key whose (value "UI" of it = "CHT") of keys of key "HKEY_LOCAL_MACHINE\SOFTWARE\Adobe\Acrobat Reader" of registry}
prefetch AdbeRdr950_zh_TW.msi sha1:e6dc8b31623ea660229bcb0cd235de87dc3101f8 size:54321664 http://ardownload.adobe.com/pub/adobe/reader/win/9.x/9.5.0/zh_TW/AdbeRdr950_zh_TW.msi sha256:0d775d3d1f7c670ce94c07e0a2269ec78fe19ecdfd2391b5acc2a1ef11c59b35
waithidden msiexec.exe /qn /i "__Download\AdbeRdr950_zh_TW.msi"

elseif {exists key whose (value "UI" of it = "PTB") of keys of key "HKEY_LOCAL_MACHINE\SOFTWARE\Adobe\Acrobat Reader" of registry}
prefetch AdbeRdr950_pt_BR.msi sha1:f24c7c6761800022b70c52ffbb3cab2869410244 size:45677056 http://ardownload.adobe.com/pub/adobe/reader/win/9.x/9.5.0/pt_BR/AdbeRdr950_pt_BR.msi sha256:61419c157a8e5e7dc5bbdacc25c4e6540924076c6527e05525becaa3376b0a2a
waithidden msiexec.exe /qn /i "__Download\AdbeRdr950_pt_BR.msi"

elseif {exists key whose (value "UI" of it = "CZE") of keys of key "HKEY_LOCAL_MACHINE\SOFTWARE\Adobe\Acrobat Reader" of registry}
prefetch AdbeRdr950_cs_CZ.msi sha1:6eff29874cb897c5d0e9fc00ada8835af2f13645 size:46826496 http://ardownload.adobe.com/pub/adobe/reader/win/9.x/9.5.0/cs_CZ/AdbeRdr950_cs_CZ.msi sha256:e6a5c5902d3e36e4e5286166bf5d270f33640f7013ed6ea718c49e5ba2ebc813
waithidden msiexec.exe /qn /i "__Download\AdbeRdr950_cs_CZ.msi"

elseif {exists key whose (value "UI" of it = "HUN") of keys of key "HKEY_LOCAL_MACHINE\SOFTWARE\Adobe\Acrobat Reader" of registry}
prefetch AdbeRdr950_hu_HU.msi sha1:1b2b72c71eb4870814b0346c60e3b61b5c86cea5 size:46355968 http://ardownload.adobe.com/pub/adobe/reader/win/9.x/9.5.0/hu_HU/AdbeRdr950_hu_HU.msi sha256:cc929806f712f2278b61c53dd97e8127ace0fcc0a82be1114e47805592d9a897
waithidden msiexec.exe /qn /i "__Download\AdbeRdr950_hu_HU.msi"

elseif {exists key whose (value "UI" of it = "POL") of keys of key "HKEY_LOCAL_MACHINE\SOFTWARE\Adobe\Acrobat Reader" of registry}
prefetch AdbeRdr950_pl_PL.msi sha1:136e7b0ee556780b9d9d8f9c23fa71be471d4adc size:46412288 http://ardownload.adobe.com/pub/adobe/reader/win/9.x/9.5.0/pl_PL/AdbeRdr950_pl_PL.msi sha256:82c1d5556f726d9b7dacb1c496a63a6aa89f8eb13f97f39e93639bc5046a438a
waithidden msiexec.exe /qn /i "__Download\AdbeRdr950_pl_PL.msi"

elseif {exists key whose (value "UI" of it = "RUS") of keys of key "HKEY_LOCAL_MACHINE\SOFTWARE\Adobe\Acrobat Reader" of registry}
prefetch AdbeRdr950_ru_RU.msi sha1:f612e5d70baa786bf8664efa1ed01120ec5781ff size:46259200 http://ardownload.adobe.com/pub/adobe/reader/win/9.x/9.5.0/ru_RU/AdbeRdr950_ru_RU.msi sha256:a8a6fc6dc29f93959de3dc07b01b8eb98c812a6fe45f4fbecbe4260be10fcf48
waithidden msiexec.exe /qn /i "__Download\AdbeRdr950_ru_RU.msi"

elseif {exists key whose (value "UI" of it = "BGR") of keys of key "HKEY_LOCAL_MACHINE\SOFTWARE\Adobe\Acrobat Reader" of registry}
prefetch AdbeRdr950_bg_BG.msi sha1:9d527fa25068370af30405279f5f47d95a0a31d2 size:46198784 http://ardownload.adobe.com/pub/adobe/reader/win/9.x/9.5.0/bg_BG/AdbeRdr950_bg_BG.msi sha256:ef731f6003bd4878e8495861e60ead266d6fea51f172769f3d32338cb5f1b5d9
waithidden msiexec.exe /qn /i "__Download\AdbeRdr950_bg_BG.msi"

elseif {exists key whose (value "UI" of it = "CAT") of keys of key "HKEY_LOCAL_MACHINE\SOFTWARE\Adobe\Acrobat Reader" of registry}
prefetch AdbeRdr950_ca_ES.msi sha1:e6ea2a637eb078f53c4998f84a75f6bb11669c9b size:46121984 http://ardownload.adobe.com/pub/adobe/reader/win/9.x/9.5.0/ca_ES/AdbeRdr950_ca_ES.msi sha256:fc988b4fd17a12862ac780b39d18e1ed2f8a945fb1603d2d29ac42671fd326b2
waithidden msiexec.exe /qn /i "__Download\AdbeRdr950_ca_ES.msi"

elseif {exists key whose (value "UI" of it = "DAN") of keys of key "HKEY_LOCAL_MACHINE\SOFTWARE\Adobe\Acrobat Reader" of registry}
prefetch AdbeRdr950_da_DK.msi sha1:c15946e62e255dba372d80713afc54325dfb7aa2 size:46310400 http://ardownload.adobe.com/pub/adobe/reader/win/9.x/9.5.0/da_DK/AdbeRdr950_da_DK.msi sha256:90e0bbee1574e6b65cf6fb1c0c415303a3fda35c916a590684f4b183c3c54c01
waithidden msiexec.exe /qn /i "__Download\AdbeRdr950_da_DK.msi"

elseif {exists key whose (value "UI" of it = "ETI") of keys of key "HKEY_LOCAL_MACHINE\SOFTWARE\Adobe\Acrobat Reader" of registry}
prefetch AdbeRdr950_et_EE.msi sha1:dac3dcc563b8450ff9fce6fdcf9b5ed9e34a8cc7 size:46083072 http://ardownload.adobe.com/pub/adobe/reader/win/9.x/9.5.0/et_EE/AdbeRdr950_et_EE.msi sha256:efe98ce4d1e362fb8c6f6371706b4c1f44514b7c59a78e5192d3ab0338cc3368
waithidden msiexec.exe /qn /i "__Download\AdbeRdr950_et_EE.msi"

elseif {exists key whose (value "UI" of it = "EUS") of keys of key "HKEY_LOCAL_MACHINE\SOFTWARE\Adobe\Acrobat Reader" of registry}
prefetch AdbeRdr950_eu_ES.msi sha1:8aa9a5d195d35727fe66bb793110a76db72736b2 size:45770752 http://ardownload.adobe.com/pub/adobe/reader/win/9.x/9.5.0/eu_ES/AdbeRdr950_eu_ES.msi sha256:798aa171b96c48bfd00c7ba7e2243a3eead1f89676716c7659bc5593616db27a
waithidden msiexec.exe /qn /i "__Download\AdbeRdr950_eu_ES.msi"

elseif {exists key whose (value "UI" of it = "HRV") of keys of key "HKEY_LOCAL_MACHINE\SOFTWARE\Adobe\Acrobat Reader" of registry}
prefetch AdbeRdr950_hr_HR.msi sha1:68e3bcafafeccdb9192541b5db797fe817f483df size:45977600 http://ardownload.adobe.com/pub/adobe/reader/win/9.x/9.5.0/hr_HR/AdbeRdr950_hr_HR.msi sha256:f3846a375ff9680ca13a6989b81a3db87803773f4dc138726e10db21d1cd8188
waithidden msiexec.exe /qn /i "__Download\AdbeRdr950_hr_HR.msi"

elseif {exists key whose (value "UI" of it = "LTH") of keys of key "HKEY_LOCAL_MACHINE\SOFTWARE\Adobe\Acrobat Reader" of registry}
prefetch AdbeRdr950_lt_LT.msi sha1:86f8e663ad6dd45f5a491798b9ecf3204534ffac size:46032896 http://ardownload.adobe.com/pub/adobe/reader/win/9.x/9.5.0/lt_LT/AdbeRdr950_lt_LT.msi sha256:f17bbcb8b6df93d2aa189018186bf99cd295f3f8d0020283bd9d668364a8d719
waithidden msiexec.exe /qn /i "__Download\AdbeRdr950_lt_LT.msi"

elseif {exists key whose (value "UI" of it = "NLD") of keys of key "HKEY_LOCAL_MACHINE\SOFTWARE\Adobe\Acrobat Reader" of registry}
prefetch AdbeRdr950_nl_NL.msi sha1:7cc82c70be4d5d63de0c43b161bd5abccb2f3b3c size:48128000 http://ardownload.adobe.com/pub/adobe/reader/win/9.x/9.5.0/nl_NL/AdbeRdr950_nl_NL.msi sha256:49a0ada1fba69e9a1aa978eca37c16a47d40d47a16292ba62fa3706758f30ad2
waithidden msiexec.exe /qn /i "__Download\AdbeRdr950_nl_NL.msi"

elseif {exists key whose (value "UI" of it = "NOR") of keys of key "HKEY_LOCAL_MACHINE\SOFTWARE\Adobe\Acrobat Reader" of registry}
prefetch AdbeRdr950_nb_NO.msi sha1:d56773b3b316900864623b7295a65112ccb3f05b size:46342144 http://ardownload.adobe.com/pub/adobe/reader/win/9.x/9.5.0/nb_NO/AdbeRdr950_nb_NO.msi sha256:f2e98a3c6f9df434cecee58d5971d94264df27130cdb28824f9df9082f985a9e
waithidden msiexec.exe /qn /i "__Download\AdbeRdr950_nb_NO.msi"

elseif {exists key whose (value "UI" of it = "LVI") of keys of key "HKEY_LOCAL_MACHINE\SOFTWARE\Adobe\Acrobat Reader" of registry}
prefetch AdbeRdr950_lv_LV.msi sha1:0e0fbc46333465e13453f3b251f24e1879b6b3d5 size:45912576 http://ardownload.adobe.com/pub/adobe/reader/win/9.x/9.5.0/lv_LV/AdbeRdr950_lv_LV.msi sha256:b80974a7e53050a7b6837361971470869ef023009a8d7ccf55a1f8404056dbfb
waithidden msiexec.exe /qn /i "__Download\AdbeRdr950_lv_LV.msi"

elseif {exists key whose (value "UI" of it = "SUO") of keys of key "HKEY_LOCAL_MACHINE\SOFTWARE\Adobe\Acrobat Reader" of registry}
prefetch AdbeRdr950_fi_FI.msi sha1:b794b44a799944fef6fa7f9aeee5320e7a84e038 size:45995520 http://ardownload.adobe.com/pub/adobe/reader/win/9.x/9.5.0/fi_FI/AdbeRdr950_fi_FI.msi sha256:db163ae2f832b204fbe9d04362c968f127da78ba9dfa55dc9185e4bb7bf3eab4
waithidden msiexec.exe /qn /i "__Download\AdbeRdr950_fi_FI.msi"

elseif {exists key whose (value "UI" of it = "SKY") of keys of key "HKEY_LOCAL_MACHINE\SOFTWARE\Adobe\Acrobat Reader" of registry}
prefetch AdbeRdr950_sk_SK.msi sha1:d6e54ea7c632572a27062442774e3c93fd9f6dd4 size:45956096 http://ardownload.adobe.com/pub/adobe/reader/win/9.x/9.5.0/sk_SK/AdbeRdr950_sk_SK.msi sha256:dff47062021e08db69c62ede0b37580dfe18c81bf9e1dd4e5d063f056c186812
waithidden msiexec.exe /qn /i "__Download\AdbeRdr950_sk_SK.msi"

elseif {exists key whose (value "UI" of it = "RUM") of keys of key "HKEY_LOCAL_MACHINE\SOFTWARE\Adobe\Acrobat Reader" of registry}
prefetch AdbeRdr950_ro_RO.msi sha1:551dd8edab71d9252e8961d5c71b43db60d59b1f size:46004736 http://ardownload.adobe.com/pub/adobe/reader/win/9.x/9.5.0/ro_RO/AdbeRdr950_ro_RO.msi sha256:7f7b685590401cb63b84d91244471ae3ba348b56aaf9be2966c93c308f0eef7d
waithidden msiexec.exe /qn /i "__Download\AdbeRdr950_ro_RO.msi"

elseif {exists key whose (value "UI" of it = "SLV") of keys of key "HKEY_LOCAL_MACHINE\SOFTWARE\Adobe\Acrobat Reader" of registry}
prefetch AdbeRdr950_sl_SI.msi sha1:fc2ed3a74b35e724010bf8c1141ffd0482f313c2 size:45935104 http://ardownload.adobe.com/pub/adobe/reader/win/9.x/9.5.0/sl_SI/AdbeRdr950_sl_SI.msi sha256:99d01f0a620e9e9e82020afd9ef79f15d63a35277092414531805435fe68af45
waithidden msiexec.exe /qn /i "__Download\AdbeRdr950_sl_SI.msi"

elseif {exists key whose (value "UI" of it = "TUR") of keys of key "HKEY_LOCAL_MACHINE\SOFTWARE\Adobe\Acrobat Reader" of registry}
prefetch AdbeRdr950_tr_TR.msi sha1:df02cd59922b1aea73e4b560998d44df0264f837 size:46567424 http://ardownload.adobe.com/pub/adobe/reader/win/9.x/9.5.0/tr_TR/AdbeRdr950_tr_TR.msi sha256:cc20fe71a60b669c8c933b45b124eff7466de33fcf7481172c68416a84faef72
waithidden msiexec.exe /qn /i "__Download\AdbeRdr950_tr_TR.msi"

elseif {exists key whose (value "UI" of it = "UKR") of keys of key "HKEY_LOCAL_MACHINE\SOFTWARE\Adobe\Acrobat Reader" of registry}
prefetch AdbeRdr950_uk_UA.msi sha1:74310506f64520783f4b840c75b43ac728251527 size:46024192 http://ardownload.adobe.com/pub/adobe/reader/win/9.x/9.5.0/uk_UA/AdbeRdr950_uk_UA.msi sha256:5bfd8f6aaebe9ad72386e9a3c3cd9ae7f0b7ba1fb7947f6d67dc1a5fd268a94b
waithidden msiexec.exe /qn /i "__Download\AdbeRdr950_uk_UA.msi"

elseif {exists key whose (value "UI" of it = "SVE") of keys of key "HKEY_LOCAL_MACHINE\SOFTWARE\Adobe\Acrobat Reader" of registry}
prefetch AdbeRdr950_sv_SE.msi sha1:14c9db21a1cee6d9d690e8a558f3d9a9c9368ccd size:48453120 http://ardownload.adobe.com/pub/adobe/reader/win/9.x/9.5.0/sv_SE/AdbeRdr950_sv_SE.msi sha256:55d355fd54ad23eb7fec7263a7c5c7219be43d855fcc5b097fc6796b2fb5d3a7
waithidden msiexec.exe /qn /i "__Download\AdbeRdr950_sv_SE.msi"

endif

delete __appendfile
appendfile REGEDIT4
appendfile [HKEY_LOCAL_MACHINE\SOFTWARE\Adobe\Acrobat Reader\9.0\AdobeViewer]
appendfile "EULA"=dword:00000001
appendfile "Launched"=dword:00000001
appendfile
// Disable the updater
appendfile [HKEY_LOCAL_MACHINE\SOFTWARE\Adobe\Adobe ARM\1.0\ARM]
appendfile "iCheck"=dword:00000000
appendfile
appendfile [HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run]
appendfile "Adobe ARM"=-
appendfile
delete temp.reg
move __appendfile temp.reg
wait regedit -s temp.reg
action may require restart</ActionScript>
					<SuccessCriteria Option="OriginalRelevance"></SuccessCriteria>
					<Relevance><![CDATA[(((((((((if( name of operating system starts with "Win" ) then platform id of operating system != 3 else false) AND (if exists property "in proxy agent context" then ( not in proxy agent context ) else true )) AND (name of operating system as lowercase starts with "win")) AND (exists regapp "acrord32.exe")) AND ((exists key "DC" of it OR exists key "2015" of it OR exists key "11.0" of it OR exists key "10.0" of it OR exists key "9.0" of it OR exists key "8.0" of it OR exists key "7.0" of it OR exists key "6.0" of it OR exists key "5.0" of it) of key "HKLM\Software\Adobe\Acrobat Reader\" of registry)) AND (not exists values "PROCESSOR_ARCHITECTURE" whose (it as string as lowercase = "ia64") of keys "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment" of registry)) AND (((name of it = "Win2000" and service pack major version of it = 4) or (name of it = "WinXP" and ((it = 2 OR it = 3) of service pack major version of it)) or (name of it = "WinXPe" and ((it = 2 OR it = 3) of service pack major version of it)) or (name of it = "Win2003") or (name of it = "WinXP-2003") or (name of it = "WinVista" AND product type of it = nt workstation product type) or (name of it = "Win7") or (((name of it = "WinVista" AND product type of it != nt workstation product type) OR (name of it = "Win2008")) AND (service pack major version of it = 1 OR service pack major version of it = 2)) or ((name of it = "Win2008R2") AND (service pack major version of it = 0 OR service pack major version of it = 1))) of operating system)) AND (exists regapp "acrord32.exe" whose (version of it < "9.5.0.270"))) AND (exists regapp "iexplore.exe" whose (version of it >= "6"))) AND (not (exists key whose (value whose (name of it contains "DisplayName") of it as string contains "Adobe Acrobat 5.0" AND exists value "UninstallString" of it) of key "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of registry AND not exists regapp "acrobat.exe" whose (version of it = "5")) AND (not (exists key whose ((it as lowercase contains "adobe reader" and it as lowercase contains "mui") of (value "DisplayName" of it as string )) of it) of  key "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of registry))]]></Relevance>
				</BaselineComponent>
				<BaselineComponent Name="Adobe Reader X (10.1.16) Available - Adobe Reader X (10.x)" IncludeInRelevance="true" SourceSiteURL="http://sync.bigfix.com/cgi-bin/bfgather/updateswindowsapps" SourceID="8101094" ActionName="Action1">
					<ActionScript MIMEType="application/x-Fixlet-Windows-Shell">prefetch AdbeRdrUpd10116.msp sha1:e91810f918ea72f617614eb5adeea03c148a4cf4 size:20824064 http://ardownload.adobe.com/pub/adobe/reader/win/10.x/10.1.16/misc/AdbeRdrUpd10116.msp sha256:b99759b5820e97f11534fa0c2ba5644322005e6c09e2a7299aa6e2c13c353f39

waithidden msiexec.exe /p "__Download\AdbeRdrUpd10116.msp" REINSTALL=ALL REINSTALLMODE=omu /qn

delete __appendfile
appendfile REGEDIT4
appendfile [HKEY_LOCAL_MACHINE\SOFTWARE\Adobe\Acrobat Reader\10.0\AdobeViewer]
appendfile "EULA"=dword:00000001
appendfile "Launched"=dword:00000001
appendfile

// Disable the updater
appendfile [HKEY_LOCAL_MACHINE\SOFTWARE\Adobe\Adobe ARM\1.0\ARM]
appendfile "iCheck"=dword:00000000
appendfile
appendfile [HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run]
appendfile "Adobe ARM"=-
appendfile

delete temp.reg

move __appendfile temp.reg

wait regedit -s temp.reg

action may require restart "e91810f918ea72f617614eb5adeea03c148a4cf4"</ActionScript>
					<SuccessCriteria Option="OriginalRelevance"></SuccessCriteria>
					<Relevance><![CDATA[(((((((((if( name of operating system starts with "Win" ) then platform id of operating system != 3 else false) AND (if exists property "in proxy agent context" then ( not in proxy agent context ) else true )) AND (name of operating system as lowercase starts with "win")) AND (exists regapp "acrord32.exe")) AND ((exists key "DC" of it OR exists key "2015" of it OR exists key "11.0" of it OR exists key "10.0" of it OR exists key "9.0" of it OR exists key "8.0" of it OR exists key "7.0" of it OR exists key "6.0" of it OR exists key "5.0" of it) of key "HKLM\Software\Adobe\Acrobat Reader\" of registry)) AND (not exists values "PROCESSOR_ARCHITECTURE" whose (it as string as lowercase = "ia64") of keys "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment" of registry)) AND ((((name of it = "WinXP" OR name of it = "WinXPe") AND NOT x64 of it AND (service pack major version of it = 3)) or ((name of it = "WinXPe") AND x64 of it AND (service pack major version of it = 2)) or (name of it = "Win2003" AND NOT x64 of it) or (name of it = "WinXP-2003" AND x64 of it AND service pack major version of it = 2 AND exists key "hklm\software\microsoft\updates\windows xp version 2003\sp3\kb930627" of x64 registry) OR (name of it = "Win2003" AND x64 of it AND service pack major version of it = 2 AND (if (value "ProductName" of it = "Microsoft Windows Server 2003 R2") of key "HKLM\Software\Microsoft\Windows NT\CurrentVersion\" of registry then exists key "HKLM\SOFTWARE\Microsoft\Updates\Windows Server 2003\SP3\KB930627" of x64 registry else true)) or (name of it = "WinVista" AND product type of it = nt workstation product type AND (service pack major version of it = 2)) or (name of it = "Win7") OR (name of it = "Win2008") or (name of it = "Win2008R2") or (name of it = "Win8") or (name of it = "Win8.1")) of operating system)) AND ((exists key whose (((preceding text of first "(" of it = "Adobe Reader X ") AND (it does not contain "MUI")) of (value "DisplayName" of it as string) AND (it >= "10.0.0" AND it < "10.1.16") of (value "DisplayVersion" of it as string as version)) of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of registry))) AND (exists regapp "iexplore.exe" whose (version of it >= "7"))) AND (not (exists key whose (value whose (name of it contains "DisplayName") of it as string contains "Adobe Acrobat 5.0" AND exists value "UninstallString" of it) of key "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of registry AND not exists regapp "acrobat.exe" whose (version of it = "5")))]]></Relevance>
				</BaselineComponent>
				<BaselineComponent Name="Adobe Reader 11.0.18 Available - Adobe Reader 11.x" IncludeInRelevance="true" SourceSiteURL="http://sync.bigfix.com/cgi-bin/bfgather/updateswindowsapps" SourceID="8101108" ActionName="Action1">
					<ActionScript MIMEType="application/x-Fixlet-Windows-Shell">prefetch AdbeRdrUpd11018.msp sha1:420d64c064cd9904836a60066a222c64b0ea060e size:48435200 http://ardownload.adobe.com/pub/adobe/reader/win/11.x/11.0.18/misc/AdbeRdrUpd11018.msp sha256:a97d87f1ae0c24f5a2b488b759be9e78ab01cda0f4d72dabaa31b72c08aff001

waithidden msiexec.exe /p "__Download\AdbeRdrUpd11018.msp" REINSTALL=ALL REINSTALLMODE=omu /qn

delete __appendfile
appendfile REGEDIT4
appendfile [HKEY_LOCAL_MACHINE\SOFTWARE\Adobe\Acrobat Reader\11.0\AdobeViewer]
appendfile "EULA"=dword:00000001
appendfile "Launched"=dword:00000001
appendfile

// Disable the updater
appendfile [HKEY_LOCAL_MACHINE\SOFTWARE\Adobe\Adobe ARM\1.0\ARM]
appendfile "iCheck"=dword:00000000
appendfile
appendfile [HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run]
appendfile "Adobe ARM"=-
appendfile

delete temp.reg

move __appendfile temp.reg

wait regedit -s temp.reg

action may require restart "420d64c064cd9904836a60066a222c64b0ea060e"</ActionScript>
					<SuccessCriteria Option="OriginalRelevance"></SuccessCriteria>
					<Relevance><![CDATA[(((((((((if( name of operating system starts with "Win" ) then platform id of operating system != 3 else false) AND (if exists property "in proxy agent context" then ( not in proxy agent context ) else true )) AND (name of operating system as lowercase starts with "win")) AND (exists regapp "acrord32.exe")) AND ((exists key "DC" of it OR exists key "2015" of it OR exists key "11.0" of it OR exists key "10.0" of it OR exists key "9.0" of it OR exists key "8.0" of it OR exists key "7.0" of it OR exists key "6.0" of it OR exists key "5.0" of it) of key "HKLM\Software\Adobe\Acrobat Reader\" of registry)) AND (not exists values "PROCESSOR_ARCHITECTURE" whose (it as string as lowercase = "ia64") of keys "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment" of registry)) AND (((NOT x64 of operating system AND (((name of it = "WinXP") AND service pack major version of it = 3) OR (value "ProductName" of it = "Microsoft Windows Server 2003 R2") of key "HKLM\Software\Microsoft\Windows NT\CurrentVersion\" of registry)) OR ((x64 of it AND service pack major version of it = 2) of operating system AND ((name of it = "WinXP-2003" AND exists key "HKLM\SOFTWARE\Microsoft\Updates\Windows XP Version 2003\SP3\KB930627" of x64 registry) OR ((value "ProductName" of it = "Microsoft Windows Server 2003 R2") of key "HKLM\Software\Microsoft\Windows NT\CurrentVersion\" of registry AND exists key "HKLM\SOFTWARE\Microsoft\Updates\Windows Server 2003\SP3\KB930627" of x64 registry))) OR name of it = "Win2008" OR name of it = "Win2008R2" OR name of it = "Win7" OR name of it = "Win8" OR name of it = "Win2012" OR name of it = "Win8.1" OR name of it = "Win2012R2") of operating system OR ((it starts with "Win" AND it does not start with "Win20") of name of operating system AND (exists value "CurrentMajorVersionNumber" of it AND value "CurrentMajorVersionNumber" of it as integer = 10) of key "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion" of native registry))) AND ((exists key whose ((((it = "Adobe Reader XI" OR it starts with "Adobe Reader XI (" OR it starts with "Adobe Reader XI -" OR it starts with "Adobe Reader 11") AND (it does not contain "MUI")) of (value "DisplayName" of it as string)) AND (it >= "11.0.0" AND it < "11.0.18") of (value "DisplayVersion" of it as string as version)) of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of registry))) AND (exists regapp "iexplore.exe" whose (version of it >= "7"))) AND (not (exists key whose (value whose (name of it contains "DisplayName") of it as string contains "Adobe Acrobat 5.0" AND exists value "UninstallString" of it) of key "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of registry AND not exists regapp "acrobat.exe" whose (version of it = "5")))]]></Relevance>
				</BaselineComponent>
				<BaselineComponent Name="Adobe Acrobat Reader DC 2015.020.20039 Available - Adobe Acrobat Reader DC - Continuous Track" IncludeInRelevance="true" SourceSiteURL="http://sync.bigfix.com/cgi-bin/bfgather/updateswindowsapps" SourceID="8101129" ActionName="Action1">
					<ActionScript MIMEType="application/x-Fixlet-Windows-Shell">prefetch AcroRdrDCUpd1502020039.msp sha1:aaf7aee672c835ad75b49c9b07360365c9d61cac size:75145216 http://ardownload.adobe.com/pub/adobe/reader/win/AcrobatDC/1502020039/AcroRdrDCUpd1502020039.msp sha256:b1eac0b8e4a42088f0f548dea70d946dd0cdd65521c8d450e28c0a7203f532a3

waithidden msiexec.exe /p "__Download\AcroRdrDCUpd1502020039.msp" REINSTALL=ALL REINSTALLMODE=omu /qn

action may require restart "aaf7aee672c835ad75b49c9b07360365c9d61cac"</ActionScript>
					<SuccessCriteria Option="OriginalRelevance"></SuccessCriteria>
					<Relevance><![CDATA[(((((((((if( name of operating system starts with "Win" ) then platform id of operating system != 3 else false) AND (if exists property "in proxy agent context" then ( not in proxy agent context ) else true )) AND (name of operating system as lowercase starts with "win")) AND (exists regapp "acrord32.exe")) AND ((exists key "DC" of it OR exists key "2015" of it OR exists key "11.0" of it OR exists key "10.0" of it OR exists key "9.0" of it OR exists key "8.0" of it OR exists key "7.0" of it OR exists key "6.0" of it OR exists key "5.0" of it) of key "HKLM\Software\Adobe\Acrobat Reader\" of registry)) AND (not exists values "PROCESSOR_ARCHITECTURE" whose (it as string as lowercase = "ia64") of keys "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment" of registry)) AND ((name of it = "Win7" OR name of it = "Win8" OR name of it = "Win8.1" OR name of it = "Win10" OR name of it = "Win2008R2" OR name of it = "Win2012" OR name of it = "Win2012R2") of operating system)) AND ((exists key whose ((((it = "Adobe Acrobat Reader DC" OR it starts with "Adobe Acrobat Reader DC") AND (it does not contain "MUI")) of (value "DisplayName" of it as string)) AND (it = "15" AND it < "15.020.20039") of (value "DisplayVersion" of it as string as version)) of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of registry))) AND (exists regapp "iexplore.exe" whose (version of it >= "8"))) AND (not (exists key whose (value whose (name of it contains "DisplayName") of it as string contains "Adobe Acrobat 5.0" AND exists value "UninstallString" of it) of key "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of registry AND not exists regapp "acrobat.exe" whose (version of it = "5")))]]></Relevance>
				</BaselineComponent>
				<BaselineComponent Name="Adobe Reader X (10.1.16) Available (MUI Installer) - Adobe Reader X (10.x)" IncludeInRelevance="true" SourceSiteURL="http://sync.bigfix.com/cgi-bin/bfgather/updateswindowsapps" SourceID="8200018" ActionName="Action1">
					<ActionScript MIMEType="application/x-Fixlet-Windows-Shell">prefetch AdbeRdrUpd10116_MUI.msp sha1:59e989377ed826c4f198a9e84715c201a4457aff size:17420288 http://ardownload.adobe.com/pub/adobe/reader/win/10.x/10.1.16/misc/AdbeRdrUpd10116_MUI.msp sha256:234a22088752bcfc06eebf096e73b0e069a5d239a000bf42ace3efbb3559128b

waithidden msiexec.exe /p "__Download\AdbeRdrUpd10116_MUI.msp" REINSTALL=ALL REINSTALLMODE=omu /qn

delete __appendfile
appendfile REGEDIT4
appendfile [HKEY_LOCAL_MACHINE\SOFTWARE\Adobe\Acrobat Reader\10.0\AdobeViewer]
appendfile "EULA"=dword:00000001
appendfile "Launched"=dword:00000001
appendfile

// Disable the updater
appendfile [HKEY_LOCAL_MACHINE\SOFTWARE\Adobe\Adobe ARM\1.0\ARM]
appendfile "iCheck"=dword:00000000
appendfile
appendfile [HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run]
appendfile "Adobe ARM"=-
appendfile

delete temp.reg

move __appendfile temp.reg

wait regedit -s temp.reg

action may require restart "59e989377ed826c4f198a9e84715c201a4457aff"</ActionScript>
					<SuccessCriteria Option="OriginalRelevance"></SuccessCriteria>
					<Relevance><![CDATA[(((((((((if( name of operating system starts with "Win" ) then platform id of operating system != 3 else false) AND (if exists property "in proxy agent context" then ( not in proxy agent context ) else true )) AND (name of operating system as lowercase starts with "win")) AND (exists regapp "acrord32.exe")) AND ((exists key "DC" of it OR exists key "2015" of it OR exists key "11.0" of it OR exists key "10.0" of it OR exists key "9.0" of it OR exists key "8.0" of it OR exists key "7.0" of it OR exists key "6.0" of it OR exists key "5.0" of it) of key "HKLM\Software\Adobe\Acrobat Reader\" of registry)) AND (not exists values "PROCESSOR_ARCHITECTURE" whose (it as string as lowercase = "ia64") of keys "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment" of registry)) AND ((((name of it = "WinXP" OR name of it = "WinXPe") AND NOT x64 of it AND (service pack major version of it = 3)) or ((name of it = "WinXPe") AND x64 of it AND (service pack major version of it = 2)) or (name of it = "Win2003" AND NOT x64 of it) or (name of it = "WinXP-2003" AND x64 of it AND service pack major version of it = 2 AND exists key "hklm\software\microsoft\updates\windows xp version 2003\sp3\kb930627" of x64 registry) OR (name of it = "Win2003" AND x64 of it AND service pack major version of it = 2 AND (if (value "ProductName" of it = "Microsoft Windows Server 2003 R2") of key "HKLM\Software\Microsoft\Windows NT\CurrentVersion\" of registry then exists key "HKLM\SOFTWARE\Microsoft\Updates\Windows Server 2003\SP3\KB930627" of x64 registry else true)) or (name of it = "WinVista" AND product type of it = nt workstation product type AND (service pack major version of it = 2)) or (name of it = "Win7") OR (name of it = "Win2008") or (name of it = "Win2008R2") or (name of it = "Win8") or (name of it = "Win8.1")) of operating system)) AND ((exists key whose ((it starts with "Adobe Reader X" and it contains "MUI") of (value "DisplayName" of it as string)  AND (it >= "10.0.0" AND it < "10.1.16") of (value "DisplayVersion" of it as string as version)) of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of registry))) AND (exists regapp "iexplore.exe" whose (version of it >= "7"))) AND (not (exists key whose (value whose (name of it contains "DisplayName") of it as string contains "Adobe Acrobat 5.0" AND exists value "UninstallString" of it) of key "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of registry AND not exists regapp "acrobat.exe" whose (version of it = "5")))]]></Relevance>
				</BaselineComponent>
				<BaselineComponent Name="Adobe Reader 11.0.18 Available (MUI Installer) - Adobe Reader 11.x" IncludeInRelevance="true" SourceSiteURL="http://sync.bigfix.com/cgi-bin/bfgather/updateswindowsapps" SourceID="8200029" ActionName="Action1">
					<ActionScript MIMEType="application/x-Fixlet-Windows-Shell">prefetch AdbeRdrUpd11018_MUI.msp sha1:b04b35aec3cdb12a6bf2aeb49057383f1915679b size:40038400 http://ardownload.adobe.com/pub/adobe/reader/win/11.x/11.0.18/misc/AdbeRdrUpd11018_MUI.msp sha256:0d1d6d64c618dce89e8e6d0a79278e5325c62a4fb31695bed6bf799bfdad8a5e

waithidden msiexec.exe /p "__Download\AdbeRdrUpd11018_MUI.msp" REINSTALL=ALL REINSTALLMODE=omu /qn

delete __appendfile
appendfile REGEDIT4
appendfile [HKEY_LOCAL_MACHINE\SOFTWARE\Adobe\Acrobat Reader\11.0\AdobeViewer]
appendfile "EULA"=dword:00000001
appendfile "Launched"=dword:00000001
appendfile

// Disable the updater
appendfile [HKEY_LOCAL_MACHINE\SOFTWARE\Adobe\Adobe ARM\1.0\ARM]
appendfile "iCheck"=dword:00000000
appendfile
appendfile [HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run]
appendfile "Adobe ARM"=-
appendfile

delete temp.reg

move __appendfile temp.reg

wait regedit -s temp.reg

action may require restart "b04b35aec3cdb12a6bf2aeb49057383f1915679b"</ActionScript>
					<SuccessCriteria Option="OriginalRelevance"></SuccessCriteria>
					<Relevance><![CDATA[((((((((if( name of operating system starts with "Win" ) then platform id of operating system != 3 else false) AND (if exists property "in proxy agent context" then ( not in proxy agent context ) else true )) AND (name of operating system as lowercase starts with "win")) AND (exists regapp "acrord32.exe")) AND ((exists key "DC" of it OR exists key "2015" of it OR exists key "11.0" of it OR exists key "10.0" of it OR exists key "9.0" of it OR exists key "8.0" of it OR exists key "7.0" of it OR exists key "6.0" of it OR exists key "5.0" of it) of key "HKLM\Software\Adobe\Acrobat Reader\" of registry)) AND (not exists values "PROCESSOR_ARCHITECTURE" whose (it as string as lowercase = "ia64") of keys "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment" of registry)) AND (((NOT x64 of operating system AND (((name of it = "WinXP") AND service pack major version of it = 3) OR (value "ProductName" of it = "Microsoft Windows Server 2003 R2") of key "HKLM\Software\Microsoft\Windows NT\CurrentVersion\" of registry)) OR ((x64 of it AND service pack major version of it = 2) of operating system AND ((name of it = "WinXP-2003" AND exists key "HKLM\SOFTWARE\Microsoft\Updates\Windows XP Version 2003\SP3\KB930627" of x64 registry) OR ((value "ProductName" of it = "Microsoft Windows Server 2003 R2") of key "HKLM\Software\Microsoft\Windows NT\CurrentVersion\" of registry AND exists key "HKLM\SOFTWARE\Microsoft\Updates\Windows Server 2003\SP3\KB930627" of x64 registry))) OR name of it = "Win2008" OR name of it = "Win2008R2" OR name of it = "Win7" OR name of it = "Win8" OR name of it = "Win2012" OR name of it = "Win8.1" OR name of it = "Win2012R2") of operating system OR ((it starts with "Win" AND it does not start with "Win20") of name of operating system AND (exists value "CurrentMajorVersionNumber" of it AND value "CurrentMajorVersionNumber" of it as integer = 10) of key "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion" of native registry))) AND ((exists key whose ((it starts with "Adobe Reader XI" and it contains "MUI") of (value "DisplayName" of it as string)  AND (it >= "11.0.0" AND it < "11.0.18") of (value "DisplayVersion" of it as string as version)) of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of registry))) AND (exists regapp "iexplore.exe" whose (version of it >= "7"))]]></Relevance>
				</BaselineComponent>
				<BaselineComponent Name="Adobe Acrobat 9.1.1 Available - Adobe Acrobat 9.1" IncludeInRelevance="true" SourceSiteURL="http://sync.bigfix.com/cgi-bin/bfgather/updateswindowsapps" SourceID="9091003" ActionName="Action1">
					<ActionScript MIMEType="application/x-Fixlet-Windows-Shell">prefetch AcrobatUpd911_all_incr.msp sha1:8e67116bc20ebcae83646ff79049173f84e3fb73 size:10181120 http://ardownload.adobe.com/pub/adobe/acrobat/win/9.x/9.1.1/misc/AcrobatUpd911_all_incr.msp sha256:e6ed3e28317527c1879e0ac21daba02f17b730da9315c32a7cf768dc0a253d25

wait msiexec.exe /p "__Download\AcrobatUpd911_all_incr.msp" REINSTALL=ALL REINSTALLMODE=omu /qn

action may require restart "8e67116bc20ebcae83646ff79049173f84e3fb73"</ActionScript>
					<SuccessCriteria Option="OriginalRelevance"></SuccessCriteria>
					<Relevance><![CDATA[(((((((((if( name of operating system starts with "Win" ) then platform id of operating system != 3 else false) AND (if exists property "in proxy agent context" then ( not in proxy agent context ) else true )) AND (name of operating system as lowercase starts with "win")) AND (exists regapp "acrobat.exe")) AND ((exists key "HKLM\Software\Adobe\Adobe Acrobat\6.0\" of it OR exists key "HKLM\Software\Adobe\Adobe Acrobat\7.0\" of it OR exists key "HKLM\Software\Adobe\Adobe Acrobat\8.0\" of it OR exists key "HKLM\Software\Adobe\Adobe Acrobat\9.0\" of it OR exists key "HKLM\Software\Adobe\Adobe Acrobat\10.0\" of it OR exists key "HKLM\Software\Adobe\Adobe Acrobat\11.0\" of it OR exists key "HKLM\Software\Adobe\Adobe Acrobat\2015\" of it OR exists key "HKLM\Software\Adobe\Adobe Acrobat\DC\" of it) of registry)) AND (not exists values "PROCESSOR_ARCHITECTURE" whose (it as string as lowercase = "ia64") of keys "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment" of registry)) AND (((name of it = "Win2000" and service pack major version of it = 4) or (name of it = "WinXP" and ((it = 2 OR it = 3) of service pack major version of it)) or (name of it = "Win2003") or (name of it = "WinXP-2003") or (name of it = "WinVista" AND product type of it = nt workstation product type) or (name of it = "Win7")) of operating system)) AND (exists regapp "iexplore.exe" whose (version of it >= "6"))) AND ((exists key whose (value "DisplayName" of it as string contains "Adobe Acrobat" AND (value "DisplayName" of it as string does not contain "Security Update") AND value "DisplayVersion" of it as string as version = "9.1.0") of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of registry))) AND (exists regapp "acrobat.exe" whose (version of it = "9.1.0.163"))]]></Relevance>
				</BaselineComponent>
				<BaselineComponent Name="Adobe Acrobat 9.1.2 Available - Adobe Acrobat 9.1.0/9.1.1" IncludeInRelevance="true" SourceSiteURL="http://sync.bigfix.com/cgi-bin/bfgather/updateswindowsapps" SourceID="9091005" ActionName="Action1">
					<ActionScript MIMEType="application/x-Fixlet-Windows-Shell">prefetch AcrobatUpd912_all_incr.msp sha1:edabaa3c2b110937eba8ff2844b69a16bb12e083 size:37180928 http://ardownload.adobe.com/pub/adobe/acrobat/win/9.x/9.1.2/misc/AcrobatUpd912_all_incr.msp sha256:9e257f6678bb10558692c6b4897af8eefe71e66562e99811a31663a10889e7f4

wait msiexec.exe /p "__Download\AcrobatUpd912_all_incr.msp" REINSTALL=ALL REINSTALLMODE=omu /qn

action may require restart "edabaa3c2b110937eba8ff2844b69a16bb12e083"</ActionScript>
					<SuccessCriteria Option="OriginalRelevance"></SuccessCriteria>
					<Relevance><![CDATA[(((((((((if( name of operating system starts with "Win" ) then platform id of operating system != 3 else false) AND (if exists property "in proxy agent context" then ( not in proxy agent context ) else true )) AND (name of operating system as lowercase starts with "win")) AND (exists regapp "acrobat.exe")) AND ((exists key "HKLM\Software\Adobe\Adobe Acrobat\6.0\" of it OR exists key "HKLM\Software\Adobe\Adobe Acrobat\7.0\" of it OR exists key "HKLM\Software\Adobe\Adobe Acrobat\8.0\" of it OR exists key "HKLM\Software\Adobe\Adobe Acrobat\9.0\" of it OR exists key "HKLM\Software\Adobe\Adobe Acrobat\10.0\" of it OR exists key "HKLM\Software\Adobe\Adobe Acrobat\11.0\" of it OR exists key "HKLM\Software\Adobe\Adobe Acrobat\2015\" of it OR exists key "HKLM\Software\Adobe\Adobe Acrobat\DC\" of it) of registry)) AND (not exists values "PROCESSOR_ARCHITECTURE" whose (it as string as lowercase = "ia64") of keys "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment" of registry)) AND (((name of it = "Win2000" and service pack major version of it = 4) or (name of it = "WinXP" and ((it = 2 OR it = 3) of service pack major version of it)) or (name of it = "Win2003") or (name of it = "WinXP-2003") or (name of it = "WinVista" AND product type of it = nt workstation product type) or (name of it = "Win7")) of operating system)) AND (exists regapp "iexplore.exe" whose (version of it >= "6"))) AND ((exists key whose (value "DisplayName" of it as string contains "Adobe Acrobat" AND (value "DisplayName" of it as string does not contain "Security Update") AND (it = "9.1.0" OR it = "9.1.1") of (value "DisplayVersion" of it as string as version)) of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of registry))) AND (exists regapp "acrobat.exe" whose (version of it = "9.1.0.163"))]]></Relevance>
				</BaselineComponent>
				<BaselineComponent Name="Adobe Acrobat X (10.1.16) Available - Adobe Acrobat X (10.x)" IncludeInRelevance="true" SourceSiteURL="http://sync.bigfix.com/cgi-bin/bfgather/updateswindowsapps" SourceID="9101084" ActionName="Action1">
					<ActionScript MIMEType="application/x-Fixlet-Windows-Shell">prefetch AcrobatUpd10116.msp sha1:e32e4de89ba4ccaa30aa331324a3932bf666dfd7 size:111349760 http://ardownload.adobe.com/pub/adobe/acrobat/win/10.x/10.1.16/misc/AcrobatUpd10116.msp sha256:51df97bf4bae0729e86edd9e80d00c0d8de109bcd6af9ef83e67ec14ce9f1068

wait msiexec.exe /p "__Download\AcrobatUpd10116.msp" REINSTALL=ALL REINSTALLMODE=omu /qn

action may require restart "e32e4de89ba4ccaa30aa331324a3932bf666dfd7"</ActionScript>
					<SuccessCriteria Option="OriginalRelevance"></SuccessCriteria>
					<Relevance><![CDATA[((((((((if( name of operating system starts with "Win" ) then platform id of operating system != 3 else false) AND (if exists property "in proxy agent context" then ( not in proxy agent context ) else true )) AND (name of operating system as lowercase starts with "win")) AND (exists regapp "acrobat.exe")) AND ((exists key "HKLM\Software\Adobe\Adobe Acrobat\6.0\" of it OR exists key "HKLM\Software\Adobe\Adobe Acrobat\7.0\" of it OR exists key "HKLM\Software\Adobe\Adobe Acrobat\8.0\" of it OR exists key "HKLM\Software\Adobe\Adobe Acrobat\9.0\" of it OR exists key "HKLM\Software\Adobe\Adobe Acrobat\10.0\" of it OR exists key "HKLM\Software\Adobe\Adobe Acrobat\11.0\" of it OR exists key "HKLM\Software\Adobe\Adobe Acrobat\2015\" of it OR exists key "HKLM\Software\Adobe\Adobe Acrobat\DC\" of it) of registry)) AND (not exists values "PROCESSOR_ARCHITECTURE" whose (it as string as lowercase = "ia64") of keys "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment" of registry)) AND ((((name of it = "WinXP" OR name of it = "WinXPe") AND NOT x64 of it AND (service pack major version of it = 3)) or ((name of it = "WinXPe") AND x64 of it AND (service pack major version of it = 2)) or (name of it = "Win2003" AND NOT x64 of it) or (name of it = "WinXP-2003" AND x64 of it AND service pack major version of it = 2 AND exists key "hklm\software\microsoft\updates\windows xp version 2003\sp3\kb930627" of x64 registry) OR (name of it = "Win2003" AND x64 of it AND service pack major version of it = 2 AND (if (value "ProductName" of it = "Microsoft Windows Server 2003 R2") of key "HKLM\Software\Microsoft\Windows NT\CurrentVersion\" of registry then exists key "HKLM\SOFTWARE\Microsoft\Updates\Windows Server 2003\SP3\KB930627" of x64 registry else true)) or (name of it = "WinVista" AND product type of it = nt workstation product type AND (service pack major version of it = 2)) or (name of it = "Win7") OR (name of it = "Win2008") or (name of it = "Win2008R2") or (name of it = "Win8") or (name of it = "Win8.1")) of operating system)) AND (exists regapp "iexplore.exe" whose (version of it >= "7"))) AND ((exists key whose (value "DisplayName" of it as string contains "Adobe Acrobat" AND (it >= "10.0.0" AND it < "10.1.16") of (value "DisplayVersion" of it as string as version)) of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of registry))]]></Relevance>
				</BaselineComponent>
				<BaselineComponent Name="Adobe Acrobat 11.0.18 Available - Adobe Acrobat 11.x" IncludeInRelevance="true" SourceSiteURL="http://sync.bigfix.com/cgi-bin/bfgather/updateswindowsapps" SourceID="9101112" ActionName="Action1">
					<ActionScript MIMEType="application/x-Fixlet-Windows-Shell">prefetch AcrobatUpd11018.msp sha1:a64c54b391acd1b49baede11880ba3704bc8fca8 size:257490944 http://ardownload.adobe.com/pub/adobe/acrobat/win/11.x/11.0.18/misc/AcrobatUpd11018.msp sha256:a4e71b5dbec10788d5f4c205b90f9b4c4eab023b61e3aadf803aaf31e2c9e806

wait msiexec.exe /p "__Download\AcrobatUpd11018.msp" REINSTALL=ALL REINSTALLMODE=omu /qn

action may require restart "a64c54b391acd1b49baede11880ba3704bc8fca8"</ActionScript>
					<SuccessCriteria Option="OriginalRelevance"></SuccessCriteria>
					<Relevance><![CDATA[((((((((if( name of operating system starts with "Win" ) then platform id of operating system != 3 else false) AND (if exists property "in proxy agent context" then ( not in proxy agent context ) else true )) AND (name of operating system as lowercase starts with "win")) AND (exists regapp "acrobat.exe")) AND ((exists key "HKLM\Software\Adobe\Adobe Acrobat\6.0\" of it OR exists key "HKLM\Software\Adobe\Adobe Acrobat\7.0\" of it OR exists key "HKLM\Software\Adobe\Adobe Acrobat\8.0\" of it OR exists key "HKLM\Software\Adobe\Adobe Acrobat\9.0\" of it OR exists key "HKLM\Software\Adobe\Adobe Acrobat\10.0\" of it OR exists key "HKLM\Software\Adobe\Adobe Acrobat\11.0\" of it OR exists key "HKLM\Software\Adobe\Adobe Acrobat\2015\" of it OR exists key "HKLM\Software\Adobe\Adobe Acrobat\DC\" of it) of registry)) AND (not exists values "PROCESSOR_ARCHITECTURE" whose (it as string as lowercase = "ia64") of keys "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment" of registry)) AND (((NOT x64 of operating system AND (((name of it = "WinXP") AND service pack major version of it = 3) OR (value "ProductName" of it = "Microsoft Windows Server 2003 R2") of key "HKLM\Software\Microsoft\Windows NT\CurrentVersion\" of registry)) OR ((x64 of it AND service pack major version of it = 2) of operating system AND ((name of it = "WinXP-2003" AND exists key "HKLM\SOFTWARE\Microsoft\Updates\Windows XP Version 2003\SP3\KB930627" of x64 registry) OR ((value "ProductName" of it = "Microsoft Windows Server 2003 R2") of key "HKLM\Software\Microsoft\Windows NT\CurrentVersion\" of registry AND exists key "HKLM\SOFTWARE\Microsoft\Updates\Windows Server 2003\SP3\KB930627" of x64 registry))) OR name of it = "Win2008" OR name of it = "Win2008R2" OR name of it = "Win7" OR name of it = "Win8" OR name of it = "Win2012" OR name of it = "Win8.1" OR name of it = "Win2012R2") of operating system OR ((it starts with "Win" AND it does not start with "Win20") of name of operating system AND (exists value "CurrentMajorVersionNumber" of it AND value "CurrentMajorVersionNumber" of it as integer = 10) of key "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion" of native registry))) AND (exists regapp "iexplore.exe" whose (version of it >= "7"))) AND ((exists key whose (value "DisplayName" of it as string contains "Adobe Acrobat" AND (it >= "11.0.0" AND it < "11.0.18") of (value "DisplayVersion" of it as string as version)) of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of registry))]]></Relevance>
				</BaselineComponent>
				<BaselineComponent Name="Adobe Acrobat DC 2015.020.20039 Available - Adobe Acrobat DC - Continuous Track" IncludeInRelevance="true" SourceSiteURL="http://sync.bigfix.com/cgi-bin/bfgather/updateswindowsapps" SourceID="9101114" ActionName="Action1">
					<ActionScript MIMEType="application/x-Fixlet-Windows-Shell">prefetch AcrobatDCUpd1502020039.msp sha1:53477cd6704f7df72db23ec4d44d576dc572e643 size:207593472 http://ardownload.adobe.com/pub/adobe/acrobat/win/AcrobatDC/1502020039/AcrobatDCUpd1502020039.msp sha256:b41a7840383b8af72d1b9320d26f0fe3ba488285df9134554c5ddc00794d1ec3

wait msiexec.exe /p "__Download\AcrobatDCUpd1502020039.msp" REINSTALL=ALL REINSTALLMODE=omu /qn

action may require restart "53477cd6704f7df72db23ec4d44d576dc572e643"</ActionScript>
					<SuccessCriteria Option="OriginalRelevance"></SuccessCriteria>
					<Relevance><![CDATA[(((((((((if( name of operating system starts with "Win" ) then platform id of operating system != 3 else false) AND (if exists property "in proxy agent context" then ( not in proxy agent context ) else true )) AND (name of operating system as lowercase starts with "win")) AND (exists regapp "acrobat.exe")) AND ((exists key "HKLM\Software\Adobe\Adobe Acrobat\6.0\" of it OR exists key "HKLM\Software\Adobe\Adobe Acrobat\7.0\" of it OR exists key "HKLM\Software\Adobe\Adobe Acrobat\8.0\" of it OR exists key "HKLM\Software\Adobe\Adobe Acrobat\9.0\" of it OR exists key "HKLM\Software\Adobe\Adobe Acrobat\10.0\" of it OR exists key "HKLM\Software\Adobe\Adobe Acrobat\11.0\" of it OR exists key "HKLM\Software\Adobe\Adobe Acrobat\2015\" of it OR exists key "HKLM\Software\Adobe\Adobe Acrobat\DC\" of it) of registry)) AND (not exists values "PROCESSOR_ARCHITECTURE" whose (it as string as lowercase = "ia64") of keys "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment" of registry)) AND (version of operating system >= "6.1")) AND (exists regapp "iexplore.exe" whose (version of it >= "8"))) AND ((exists key whose (value "DisplayName" of it as string contains "Adobe Acrobat DC" AND (it>"15.0.0" and it < "15.020.20039") of (value "DisplayVersion" of it as string as version)) of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of registry))) AND (exists matches (regex "\d*\.\d*\.20\d*") of (value "DisplayVersion" of it as string) of keys whose (value "DisplayName" of it as string contains "Adobe Acrobat DC") of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of registry)]]></Relevance>
				</BaselineComponent>
				<BaselineComponent Name="Google Chrome 55.0.2883.87 Available" IncludeInRelevance="true" SourceSiteURL="http://sync.bigfix.com/cgi-bin/bfgather/updateswindowsapps" SourceID="14011137" ActionName="Action1">
					<ActionScript MIMEType="application/x-Fixlet-Windows-Shell">// Check 64bit Chrome
if {exists it whose(it as lowercase contains "-chrome" AND it as lowercase contains "x64") of unique values of (it as string) of values "ap" of keys of keys "HKEY_LOCAL_MACHINE\SOFTWARE\Google\Update\ClientState" of (x64 registries; x32 registries)}
prefetch googlechromestandaloneenterprise64.msi sha1:0668f66827e3e9c11e5a823c8d1aae7b7f79d52b size:50970624  https://dl.google.com/tag/s/appguid%3D%7B8A69D345-D564-463C-AFF1-A69D9E530F96%7D%26iid%3D%7B03FE9563-80F9-119F-DA3D-72FBBB94BC26%7D%26lang%3Den%26browser%3D4%26usagestats%3D0%26appname%3DGoogle%2520Chrome%26needsadmin%3Dprefers%26ap%3Dx64-stable/dl/chrome/install/googlechromestandaloneenterprise64.msi sha256:e87064ecdb9583b2ce3b61dad2248952d15ecb031ee5ab70587c29ed6baf8bd1

wait msiexec.exe /q /I "__Download\googlechromestandaloneenterprise64.msi"

action may require restart "0668f66827e3e9c11e5a823c8d1aae7b7f79d52b"

// Otherwise should be 32bit
else
prefetch googlechromestandaloneenterprise.msi sha1:5edfd86ad1fd3fde47ba0c460817067b05783fb9 size:46665728 https://dl.google.com/tag/s/appguid%3D%7B8A69D345-D564-463C-AFF1-A69D9E530F96%7D%26iid%3D%7B90A30E55-AB4E-423E-9EBA-99A4BFC32BD3%7D%26lang%3Den%26browser%3D4%26usagestats%3D0%26appname%3DGoogle%2520Chrome%26needsadmin%3Dprefers/dl/chrome/install/googlechromestandaloneenterprise.msi sha256:f30e97b8bd48f9e0b9706f24461db6718a3b9bfc3ddb110cea5b952643c617c8

wait msiexec.exe /q /I "__Download\googlechromestandaloneenterprise.msi"

action may require restart "5edfd86ad1fd3fde47ba0c460817067b05783fb9"
endif</ActionScript>
					<SuccessCriteria Option="OriginalRelevance"></SuccessCriteria>
					<Relevance><![CDATA[(((((((if( name of operating system starts with "Win" ) then platform id of operating system != 3 else false) AND (if exists property "in proxy agent context" then ( not in proxy agent context ) else true )) AND (name of operating system as lowercase starts with "win")) AND (not exists values "PROCESSOR_ARCHITECTURE" whose (it as string as lowercase = "ia64") of keys "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment" of registry)) AND (exists regapp "chrome.exe")) AND (version of client >= "7")) AND (((name of it = "Win7") OR (name of it = "Win8") OR (name of it = "Win8.1") OR (name of it = "Win10")) of operating system)) AND ((exists key whose ((value "name" of it as string = "Google %c5%a9%b7%d2" or value "name" of it as string = "Google Chrome") and value "pv" of it as string as version < "55.0.2883.87") of keys "HKEY_LOCAL_MACHINE\Software\Google\Update\Clients" of registry) OR (exists key whose ((value "name" of it as string = "Google %c5%a9%b7%d2" or value "name" of it as string = "Google Chrome") and value "pv" of it as string as version < "55.0.2883.87") of keys "Software\Google\Update\Clients" of current user keys (logged on users) of registry))]]></Relevance>
				</BaselineComponent>
			</BaselineComponentGroup>
		</BaselineComponentCollection>
	</Baseline>
</BES>
